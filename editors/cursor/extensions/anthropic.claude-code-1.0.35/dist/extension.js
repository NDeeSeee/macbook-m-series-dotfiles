"use strict";var nh=Object.create;var $s=Object.defineProperty;var ih=Object.getOwnPropertyDescriptor;var oh=Object.getOwnPropertyNames;var lh=Object.getPrototypeOf,ch=Object.prototype.hasOwnProperty;var z=(s,e)=>()=>(e||s((e={exports:{}}).exports,e),e.exports),uh=(s,e)=>{for(var r in e)$s(s,r,{get:e[r],enumerable:!0})},ji=(s,e,r,a)=>{if(e&&typeof e=="object"||typeof e=="function")for(let t of oh(e))!ch.call(s,t)&&t!==r&&$s(s,t,{get:()=>e[t],enumerable:!(a=ih(e,t))||a.enumerable});return s};var de=(s,e,r)=>(r=s!=null?nh(lh(s)):{},ji(e||!s||!s.__esModule?$s(r,"default",{value:s,enumerable:!0}):r,s)),dh=s=>ji($s({},"__esModule",{value:!0}),s);var zi=z((vy,Vi)=>{"use strict";Vi.exports=function(e){return e.map(function(r){return r===""?"''":r&&typeof r=="object"?r.op.replace(/(.)/g,"\\$1"):/["\s\\]/.test(r)&&!/'/.test(r)?"'"+r.replace(/(['])/g,"\\$1")+"'":/["'\s]/.test(r)?'"'+r.replace(/(["\\$`!])/g,"\\$1")+'"':String(r).replace(/([A-Za-z]:)?([#!"$&'()*,:;<=>?@[\\\]^`{|}])/g,"$1\\$2")}).join(" ")}});var Ji=z((gy,Qi)=>{"use strict";var Bi="(?:"+["\\|\\|","\\&\\&",";;","\\|\\&","\\<\\(","\\<\\<\\<",">>",">\\&","<\\&","[&;()|<>]"].join("|")+")",Hi=new RegExp("^"+Bi+"$"),Zi="|&;()<> \\t",vh='"((\\\\"|[^"])*?)"',gh="'((\\\\'|[^'])*?)'",yh=/^#$/,Wi="'",Gi='"',Xa="$",yr="",_h=4294967296;for(en=0;en<4;en++)yr+=(_h*Math.random()).toString(16);var bh=new RegExp("^"+yr);function xh(s,e){for(var r=e.lastIndex,a=[],t;t=e.exec(s);)a.push(t),e.lastIndex===t.index&&(e.lastIndex+=1);return e.lastIndex=r,a}function Eh(s,e,r){var a=typeof s=="function"?s(r):s[r];return typeof a>"u"&&r!=""?a="":typeof a>"u"&&(a="$"),typeof a=="object"?e+yr+JSON.stringify(a)+yr:e+a}function Sh(s,e,r){r||(r={});var a=r.escape||"\\",t="(\\"+a+`['"`+Zi+`]|[^\\s'"`+Zi+"])+",n=new RegExp(["("+Bi+")","("+t+"|"+vh+"|"+gh+")+"].join("|"),"g"),o=xh(s,n);if(o.length===0)return[];e||(e={});var i=!1;return o.map(function(l){var c=l[0];if(!c||i)return;if(Hi.test(c))return{op:c};var d=!1,h=!1,v="",f=!1,p;function y(){p+=1;var S,w,T=c.charAt(p);if(T==="{"){if(p+=1,c.charAt(p)==="}")throw new Error("Bad substitution: "+c.slice(p-2,p+1));if(S=c.indexOf("}",p),S<0)throw new Error("Bad substitution: "+c.slice(p));w=c.slice(p,S),p=S}else if(/[*@#?$!_-]/.test(T))w=T,p+=1;else{var C=c.slice(p);S=C.match(/[^\w\d_]/),S?(w=C.slice(0,S.index),p+=S.index-1):(w=C,p=c.length)}return Eh(e,"",w)}for(p=0;p<c.length;p++){var g=c.charAt(p);if(f=f||!d&&(g==="*"||g==="?"),h)v+=g,h=!1;else if(d)g===d?d=!1:d==Wi?v+=g:g===a?(p+=1,g=c.charAt(p),g===Gi||g===a||g===Xa?v+=g:v+=a+g):g===Xa?v+=y():v+=g;else if(g===Gi||g===Wi)d=g;else{if(Hi.test(g))return{op:c};if(yh.test(g)){i=!0;var x={comment:s.slice(l.index+p+1)};return v.length?[v,x]:[x]}else g===a?h=!0:g===Xa?v+=y():v+=g}}return f?{op:"glob",pattern:v}:v}).reduce(function(l,c){return typeof c>"u"?l:l.concat(c)},[])}Qi.exports=function(e,r,a){var t=Sh(e,r,a);return typeof r!="function"?t:t.reduce(function(n,o){if(typeof o=="object")return n.concat(o);var i=o.split(RegExp("("+yr+".*?"+yr+")","g"));return i.length===1?n.concat(i[0]):n.concat(i.filter(Boolean).map(function(l){return bh.test(l)?JSON.parse(l.split(yr)[1]):l}))},[])};var en});var Ki=z(tn=>{"use strict";tn.quote=zi(),tn.parse=Ji()});var xl=z((aa,bl)=>{(function(s,e){typeof aa=="object"&&typeof bl<"u"?e(aa):typeof define=="function"&&define.amd?define(["exports"],e):e(s.URI=s.URI||{})})(aa,function(s){"use strict";function e(){for(var _=arguments.length,m=Array(_),b=0;b<_;b++)m[b]=arguments[b];if(m.length>1){m[0]=m[0].slice(0,-1);for(var E=m.length-1,P=1;P<E;++P)m[P]=m[P].slice(1,-1);return m[E]=m[E].slice(1),m.join("")}else return m[0]}function r(_){return"(?:"+_+")"}function a(_){return _===void 0?"undefined":_===null?"null":Object.prototype.toString.call(_).split(" ").pop().split("]").shift().toLowerCase()}function t(_){return _.toUpperCase()}function n(_){return _!=null?_ instanceof Array?_:typeof _.length!="number"||_.split||_.setInterval||_.call?[_]:Array.prototype.slice.call(_):[]}function o(_,m){var b=_;if(m)for(var E in m)b[E]=m[E];return b}function i(_){var m="[A-Za-z]",b="[\\x0D]",E="[0-9]",P="[\\x22]",M=e(E,"[A-Fa-f]"),K="[\\x0A]",ne="[\\x20]",ce=r(r("%[EFef]"+M+"%"+M+M+"%"+M+M)+"|"+r("%[89A-Fa-f]"+M+"%"+M+M)+"|"+r("%"+M+M)),Ce="[\\:\\/\\?\\#\\[\\]\\@]",ae="[\\!\\$\\&\\'\\(\\)\\*\\+\\,\\;\\=]",ye=e(Ce,ae),Re=_?"[\\xA0-\\u200D\\u2010-\\u2029\\u202F-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]":"[]",ve=_?"[\\uE000-\\uF8FF]":"[]",oe=e(m,E,"[\\-\\.\\_\\~]",Re),_e=r(m+e(m,E,"[\\+\\-\\.]")+"*"),fe=r(r(ce+"|"+e(oe,ae,"[\\:]"))+"*"),pr=r(r("25[0-5]")+"|"+r("2[0-4]"+E)+"|"+r("1"+E+E)+"|"+r("[1-9]"+E)+"|"+E),Qe=r(r("25[0-5]")+"|"+r("2[0-4]"+E)+"|"+r("1"+E+E)+"|"+r("0?[1-9]"+E)+"|0?0?"+E),Xe=r(Qe+"\\."+Qe+"\\."+Qe+"\\."+Qe),he=r(M+"{1,4}"),Je=r(r(he+"\\:"+he)+"|"+Xe),et=r(r(he+"\\:")+"{6}"+Je),gt=r("\\:\\:"+r(he+"\\:")+"{5}"+Je),mr=r(r(he)+"?\\:\\:"+r(he+"\\:")+"{4}"+Je),Tt=r(r(r(he+"\\:")+"{0,1}"+he)+"?\\:\\:"+r(he+"\\:")+"{3}"+Je),ts=r(r(r(he+"\\:")+"{0,2}"+he)+"?\\:\\:"+r(he+"\\:")+"{2}"+Je),ks=r(r(r(he+"\\:")+"{0,3}"+he)+"?\\:\\:"+he+"\\:"+Je),Os=r(r(r(he+"\\:")+"{0,4}"+he)+"?\\:\\:"+Je),Nr=r(r(r(he+"\\:")+"{0,5}"+he)+"?\\:\\:"+he),Lr=r(r(r(he+"\\:")+"{0,6}"+he)+"?\\:\\:"),Ct=r([et,gt,mr,Tt,ts,ks,Os,Nr,Lr].join("|")),Fr=r(r(oe+"|"+ce)+"+"),Ja=r(Ct+"\\%25"+Fr),vr=r(Ct+r("\\%25|\\%(?!"+M+"{2})")+Fr),Yf=r("[vV]"+M+"+\\."+e(oe,ae,"[\\:]")+"+"),Xf=r("\\["+r(vr+"|"+Ct+"|"+Yf)+"\\]"),Ai=r(r(ce+"|"+e(oe,ae))+"*"),rs=r(Xf+"|"+Xe+"(?!"+Ai+")|"+Ai),ss=r(E+"*"),Ni=r(r(fe+"@")+"?"+rs+r("\\:"+ss)+"?"),as=r(ce+"|"+e(oe,ae,"[\\:\\@]")),eh=r(as+"*"),Li=r(as+"+"),th=r(r(ce+"|"+e(oe,ae,"[\\@]"))+"+"),Rt=r(r("\\/"+eh)+"*"),jr=r("\\/"+r(Li+Rt)+"?"),Ka=r(th+Rt),Ds=r(Li+Rt),Mr="(?!"+as+")",ny=r(Rt+"|"+jr+"|"+Ka+"|"+Ds+"|"+Mr),Ur=r(r(as+"|"+e("[\\/\\?]",ve))+"*"),ns=r(r(as+"|[\\/\\?]")+"*"),Fi=r(r("\\/\\/"+Ni+Rt)+"|"+jr+"|"+Ds+"|"+Mr),rh=r(_e+"\\:"+Fi+r("\\?"+Ur)+"?"+r("\\#"+ns)+"?"),sh=r(r("\\/\\/"+Ni+Rt)+"|"+jr+"|"+Ka+"|"+Mr),ah=r(sh+r("\\?"+Ur)+"?"+r("\\#"+ns)+"?"),iy=r(rh+"|"+ah),oy=r(_e+"\\:"+Fi+r("\\?"+Ur)+"?"),ly="^("+_e+")\\:"+r(r("\\/\\/("+r("("+fe+")@")+"?("+rs+")"+r("\\:("+ss+")")+"?)")+"?("+Rt+"|"+jr+"|"+Ds+"|"+Mr+")")+r("\\?("+Ur+")")+"?"+r("\\#("+ns+")")+"?$",cy="^(){0}"+r(r("\\/\\/("+r("("+fe+")@")+"?("+rs+")"+r("\\:("+ss+")")+"?)")+"?("+Rt+"|"+jr+"|"+Ka+"|"+Mr+")")+r("\\?("+Ur+")")+"?"+r("\\#("+ns+")")+"?$",uy="^("+_e+")\\:"+r(r("\\/\\/("+r("("+fe+")@")+"?("+rs+")"+r("\\:("+ss+")")+"?)")+"?("+Rt+"|"+jr+"|"+Ds+"|"+Mr+")")+r("\\?("+Ur+")")+"?$",dy="^"+r("\\#("+ns+")")+"?$",fy="^"+r("("+fe+")@")+"?("+rs+")"+r("\\:("+ss+")")+"?$";return{NOT_SCHEME:new RegExp(e("[^]",m,E,"[\\+\\-\\.]"),"g"),NOT_USERINFO:new RegExp(e("[^\\%\\:]",oe,ae),"g"),NOT_HOST:new RegExp(e("[^\\%\\[\\]\\:]",oe,ae),"g"),NOT_PATH:new RegExp(e("[^\\%\\/\\:\\@]",oe,ae),"g"),NOT_PATH_NOSCHEME:new RegExp(e("[^\\%\\/\\@]",oe,ae),"g"),NOT_QUERY:new RegExp(e("[^\\%]",oe,ae,"[\\:\\@\\/\\?]",ve),"g"),NOT_FRAGMENT:new RegExp(e("[^\\%]",oe,ae,"[\\:\\@\\/\\?]"),"g"),ESCAPE:new RegExp(e("[^]",oe,ae),"g"),UNRESERVED:new RegExp(oe,"g"),OTHER_CHARS:new RegExp(e("[^\\%]",oe,ye),"g"),PCT_ENCODED:new RegExp(ce,"g"),IPV4ADDRESS:new RegExp("^("+Xe+")$"),IPV6ADDRESS:new RegExp("^\\[?("+Ct+")"+r(r("\\%25|\\%(?!"+M+"{2})")+"("+Fr+")")+"?\\]?$")}}var l=i(!1),c=i(!0),d=function(){function _(m,b){var E=[],P=!0,M=!1,K=void 0;try{for(var ne=m[Symbol.iterator](),ce;!(P=(ce=ne.next()).done)&&(E.push(ce.value),!(b&&E.length===b));P=!0);}catch(Ce){M=!0,K=Ce}finally{try{!P&&ne.return&&ne.return()}finally{if(M)throw K}}return E}return function(m,b){if(Array.isArray(m))return m;if(Symbol.iterator in Object(m))return _(m,b);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),h=function(_){if(Array.isArray(_)){for(var m=0,b=Array(_.length);m<_.length;m++)b[m]=_[m];return b}else return Array.from(_)},v=2147483647,f=36,p=1,y=26,g=38,x=700,S=72,w=128,T="-",C=/^xn--/,R=/[^\0-\x7E]/,L=/[\x2E\u3002\uFF0E\uFF61]/g,U={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},$=f-p,D=Math.floor,F=String.fromCharCode;function q(_){throw new RangeError(U[_])}function I(_,m){for(var b=[],E=_.length;E--;)b[E]=m(_[E]);return b}function A(_,m){var b=_.split("@"),E="";b.length>1&&(E=b[0]+"@",_=b[1]),_=_.replace(L,".");var P=_.split("."),M=I(P,m).join(".");return E+M}function V(_){for(var m=[],b=0,E=_.length;b<E;){var P=_.charCodeAt(b++);if(P>=55296&&P<=56319&&b<E){var M=_.charCodeAt(b++);(M&64512)==56320?m.push(((P&1023)<<10)+(M&1023)+65536):(m.push(P),b--)}else m.push(P)}return m}var ue=function(m){return String.fromCodePoint.apply(String,h(m))},ee=function(m){return m-48<10?m-22:m-65<26?m-65:m-97<26?m-97:f},se=function(m,b){return m+22+75*(m<26)-((b!=0)<<5)},X=function(m,b,E){var P=0;for(m=E?D(m/x):m>>1,m+=D(m/b);m>$*y>>1;P+=f)m=D(m/$);return D(P+($+1)*m/(m+g))},H=function(m){var b=[],E=m.length,P=0,M=w,K=S,ne=m.lastIndexOf(T);ne<0&&(ne=0);for(var ce=0;ce<ne;++ce)m.charCodeAt(ce)>=128&&q("not-basic"),b.push(m.charCodeAt(ce));for(var Ce=ne>0?ne+1:0;Ce<E;){for(var ae=P,ye=1,Re=f;;Re+=f){Ce>=E&&q("invalid-input");var ve=ee(m.charCodeAt(Ce++));(ve>=f||ve>D((v-P)/ye))&&q("overflow"),P+=ve*ye;var oe=Re<=K?p:Re>=K+y?y:Re-K;if(ve<oe)break;var _e=f-oe;ye>D(v/_e)&&q("overflow"),ye*=_e}var fe=b.length+1;K=X(P-ae,fe,ae==0),D(P/fe)>v-M&&q("overflow"),M+=D(P/fe),P%=fe,b.splice(P++,0,M)}return String.fromCodePoint.apply(String,b)},xe=function(m){var b=[];m=V(m);var E=m.length,P=w,M=0,K=S,ne=!0,ce=!1,Ce=void 0;try{for(var ae=m[Symbol.iterator](),ye;!(ne=(ye=ae.next()).done);ne=!0){var Re=ye.value;Re<128&&b.push(F(Re))}}catch(vr){ce=!0,Ce=vr}finally{try{!ne&&ae.return&&ae.return()}finally{if(ce)throw Ce}}var ve=b.length,oe=ve;for(ve&&b.push(T);oe<E;){var _e=v,fe=!0,pr=!1,Qe=void 0;try{for(var Xe=m[Symbol.iterator](),he;!(fe=(he=Xe.next()).done);fe=!0){var Je=he.value;Je>=P&&Je<_e&&(_e=Je)}}catch(vr){pr=!0,Qe=vr}finally{try{!fe&&Xe.return&&Xe.return()}finally{if(pr)throw Qe}}var et=oe+1;_e-P>D((v-M)/et)&&q("overflow"),M+=(_e-P)*et,P=_e;var gt=!0,mr=!1,Tt=void 0;try{for(var ts=m[Symbol.iterator](),ks;!(gt=(ks=ts.next()).done);gt=!0){var Os=ks.value;if(Os<P&&++M>v&&q("overflow"),Os==P){for(var Nr=M,Lr=f;;Lr+=f){var Ct=Lr<=K?p:Lr>=K+y?y:Lr-K;if(Nr<Ct)break;var Fr=Nr-Ct,Ja=f-Ct;b.push(F(se(Ct+Fr%Ja,0))),Nr=D(Fr/Ja)}b.push(F(se(Nr,0))),K=X(M,et,oe==ve),M=0,++oe}}}catch(vr){mr=!0,Tt=vr}finally{try{!gt&&ts.return&&ts.return()}finally{if(mr)throw Tt}}++M,++P}return b.join("")},Ae=function(m){return A(m,function(b){return C.test(b)?H(b.slice(4).toLowerCase()):b})},Fe=function(m){return A(m,function(b){return R.test(b)?"xn--"+xe(b):b})},ie={version:"2.1.0",ucs2:{decode:V,encode:ue},decode:H,encode:xe,toASCII:Fe,toUnicode:Ae},we={};function ke(_){var m=_.charCodeAt(0),b=void 0;return m<16?b="%0"+m.toString(16).toUpperCase():m<128?b="%"+m.toString(16).toUpperCase():m<2048?b="%"+(m>>6|192).toString(16).toUpperCase()+"%"+(m&63|128).toString(16).toUpperCase():b="%"+(m>>12|224).toString(16).toUpperCase()+"%"+(m>>6&63|128).toString(16).toUpperCase()+"%"+(m&63|128).toString(16).toUpperCase(),b}function je(_){for(var m="",b=0,E=_.length;b<E;){var P=parseInt(_.substr(b+1,2),16);if(P<128)m+=String.fromCharCode(P),b+=3;else if(P>=194&&P<224){if(E-b>=6){var M=parseInt(_.substr(b+4,2),16);m+=String.fromCharCode((P&31)<<6|M&63)}else m+=_.substr(b,6);b+=6}else if(P>=224){if(E-b>=9){var K=parseInt(_.substr(b+4,2),16),ne=parseInt(_.substr(b+7,2),16);m+=String.fromCharCode((P&15)<<12|(K&63)<<6|ne&63)}else m+=_.substr(b,9);b+=9}else m+=_.substr(b,3),b+=3}return m}function Mt(_,m){function b(E){var P=je(E);return P.match(m.UNRESERVED)?P:E}return _.scheme&&(_.scheme=String(_.scheme).replace(m.PCT_ENCODED,b).toLowerCase().replace(m.NOT_SCHEME,"")),_.userinfo!==void 0&&(_.userinfo=String(_.userinfo).replace(m.PCT_ENCODED,b).replace(m.NOT_USERINFO,ke).replace(m.PCT_ENCODED,t)),_.host!==void 0&&(_.host=String(_.host).replace(m.PCT_ENCODED,b).toLowerCase().replace(m.NOT_HOST,ke).replace(m.PCT_ENCODED,t)),_.path!==void 0&&(_.path=String(_.path).replace(m.PCT_ENCODED,b).replace(_.scheme?m.NOT_PATH:m.NOT_PATH_NOSCHEME,ke).replace(m.PCT_ENCODED,t)),_.query!==void 0&&(_.query=String(_.query).replace(m.PCT_ENCODED,b).replace(m.NOT_QUERY,ke).replace(m.PCT_ENCODED,t)),_.fragment!==void 0&&(_.fragment=String(_.fragment).replace(m.PCT_ENCODED,b).replace(m.NOT_FRAGMENT,ke).replace(m.PCT_ENCODED,t)),_}function Pt(_){return _.replace(/^0*(.*)/,"$1")||"0"}function Te(_,m){var b=_.match(m.IPV4ADDRESS)||[],E=d(b,2),P=E[1];return P?P.split(".").map(Pt).join("."):_}function Ee(_,m){var b=_.match(m.IPV6ADDRESS)||[],E=d(b,3),P=E[1],M=E[2];if(P){for(var K=P.toLowerCase().split("::").reverse(),ne=d(K,2),ce=ne[0],Ce=ne[1],ae=Ce?Ce.split(":").map(Pt):[],ye=ce.split(":").map(Pt),Re=m.IPV4ADDRESS.test(ye[ye.length-1]),ve=Re?7:8,oe=ye.length-ve,_e=Array(ve),fe=0;fe<ve;++fe)_e[fe]=ae[fe]||ye[oe+fe]||"";Re&&(_e[ve-1]=Te(_e[ve-1],m));var pr=_e.reduce(function(et,gt,mr){if(!gt||gt==="0"){var Tt=et[et.length-1];Tt&&Tt.index+Tt.length===mr?Tt.length++:et.push({index:mr,length:1})}return et},[]),Qe=pr.sort(function(et,gt){return gt.length-et.length})[0],Xe=void 0;if(Qe&&Qe.length>1){var he=_e.slice(0,Qe.index),Je=_e.slice(Qe.index+Qe.length);Xe=he.join(":")+"::"+Je.join(":")}else Xe=_e.join(":");return M&&(Xe+="%"+M),Xe}else return _}var dr=/^(?:([^:\/?#]+):)?(?:\/\/((?:([^\/?#@]*)@)?(\[[^\/?#\]]+\]|[^\/?#:]*)(?:\:(\d*))?))?([^?#]*)(?:\?([^#]*))?(?:#((?:.|\n|\r)*))?/i,Ne="".match(/(){0}/)[1]===void 0;function le(_){var m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},b={},E=m.iri!==!1?c:l;m.reference==="suffix"&&(_=(m.scheme?m.scheme+":":"")+"//"+_);var P=_.match(dr);if(P){Ne?(b.scheme=P[1],b.userinfo=P[3],b.host=P[4],b.port=parseInt(P[5],10),b.path=P[6]||"",b.query=P[7],b.fragment=P[8],isNaN(b.port)&&(b.port=P[5])):(b.scheme=P[1]||void 0,b.userinfo=_.indexOf("@")!==-1?P[3]:void 0,b.host=_.indexOf("//")!==-1?P[4]:void 0,b.port=parseInt(P[5],10),b.path=P[6]||"",b.query=_.indexOf("?")!==-1?P[7]:void 0,b.fragment=_.indexOf("#")!==-1?P[8]:void 0,isNaN(b.port)&&(b.port=_.match(/\/\/(?:.|\n)*\:(?:\/|\?|\#|$)/)?P[4]:void 0)),b.host&&(b.host=Ee(Te(b.host,E),E)),b.scheme===void 0&&b.userinfo===void 0&&b.host===void 0&&b.port===void 0&&!b.path&&b.query===void 0?b.reference="same-document":b.scheme===void 0?b.reference="relative":b.fragment===void 0?b.reference="absolute":b.reference="uri",m.reference&&m.reference!=="suffix"&&m.reference!==b.reference&&(b.error=b.error||"URI is not a "+m.reference+" reference.");var M=we[(m.scheme||b.scheme||"").toLowerCase()];if(!m.unicodeSupport&&(!M||!M.unicodeSupport)){if(b.host&&(m.domainHost||M&&M.domainHost))try{b.host=ie.toASCII(b.host.replace(E.PCT_ENCODED,je).toLowerCase())}catch(K){b.error=b.error||"Host's domain name can not be converted to ASCII via punycode: "+K}Mt(b,l)}else Mt(b,E);M&&M.parse&&M.parse(b,m)}else b.error=b.error||"URI can not be parsed.";return b}function Ut(_,m){var b=m.iri!==!1?c:l,E=[];return _.userinfo!==void 0&&(E.push(_.userinfo),E.push("@")),_.host!==void 0&&E.push(Ee(Te(String(_.host),b),b).replace(b.IPV6ADDRESS,function(P,M,K){return"["+M+(K?"%25"+K:"")+"]"})),(typeof _.port=="number"||typeof _.port=="string")&&(E.push(":"),E.push(String(_.port))),E.length?E.join(""):void 0}var wt=/^\.\.?\//,fr=/^\/\.(\/|$)/,hr=/^\/\.\.(\/|$)/,$e=/^\/?(?:.|\n)*?(?=\/|$)/;function Ye(_){for(var m=[];_.length;)if(_.match(wt))_=_.replace(wt,"");else if(_.match(fr))_=_.replace(fr,"/");else if(_.match(hr))_=_.replace(hr,"/"),m.pop();else if(_==="."||_==="..")_="";else{var b=_.match($e);if(b){var E=b[0];_=_.slice(E.length),m.push(E)}else throw new Error("Unexpected dot segment condition")}return m.join("")}function Be(_){var m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},b=m.iri?c:l,E=[],P=we[(m.scheme||_.scheme||"").toLowerCase()];if(P&&P.serialize&&P.serialize(_,m),_.host&&!b.IPV6ADDRESS.test(_.host)){if(m.domainHost||P&&P.domainHost)try{_.host=m.iri?ie.toUnicode(_.host):ie.toASCII(_.host.replace(b.PCT_ENCODED,je).toLowerCase())}catch(ne){_.error=_.error||"Host's domain name can not be converted to "+(m.iri?"Unicode":"ASCII")+" via punycode: "+ne}}Mt(_,b),m.reference!=="suffix"&&_.scheme&&(E.push(_.scheme),E.push(":"));var M=Ut(_,m);if(M!==void 0&&(m.reference!=="suffix"&&E.push("//"),E.push(M),_.path&&_.path.charAt(0)!=="/"&&E.push("/")),_.path!==void 0){var K=_.path;!m.absolutePath&&(!P||!P.absolutePath)&&(K=Ye(K)),M===void 0&&(K=K.replace(/^\/\//,"/%2F")),E.push(K)}return _.query!==void 0&&(E.push("?"),E.push(_.query)),_.fragment!==void 0&&(E.push("#"),E.push(_.fragment)),E.join("")}function Me(_,m){var b=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},E=arguments[3],P={};return E||(_=le(Be(_,b),b),m=le(Be(m,b),b)),b=b||{},!b.tolerant&&m.scheme?(P.scheme=m.scheme,P.userinfo=m.userinfo,P.host=m.host,P.port=m.port,P.path=Ye(m.path||""),P.query=m.query):(m.userinfo!==void 0||m.host!==void 0||m.port!==void 0?(P.userinfo=m.userinfo,P.host=m.host,P.port=m.port,P.path=Ye(m.path||""),P.query=m.query):(m.path?(m.path.charAt(0)==="/"?P.path=Ye(m.path):((_.userinfo!==void 0||_.host!==void 0||_.port!==void 0)&&!_.path?P.path="/"+m.path:_.path?P.path=_.path.slice(0,_.path.lastIndexOf("/")+1)+m.path:P.path=m.path,P.path=Ye(P.path)),P.query=m.query):(P.path=_.path,m.query!==void 0?P.query=m.query:P.query=_.query),P.userinfo=_.userinfo,P.host=_.host,P.port=_.port),P.scheme=_.scheme),P.fragment=m.fragment,P}function mt(_,m,b){var E=o({scheme:"null"},b);return Be(Me(le(_,E),le(m,E),E,!0),E)}function Ge(_,m){return typeof _=="string"?_=Be(le(_,m),m):a(_)==="object"&&(_=le(Be(_,m),m)),_}function Rs(_,m,b){return typeof _=="string"?_=Be(le(_,b),b):a(_)==="object"&&(_=Be(_,b)),typeof m=="string"?m=Be(le(m,b),b):a(m)==="object"&&(m=Be(m,b)),_===m}function Ga(_,m){return _&&_.toString().replace(!m||!m.iri?l.ESCAPE:c.ESCAPE,ke)}function ot(_,m){return _&&_.toString().replace(!m||!m.iri?l.PCT_ENCODED:c.PCT_ENCODED,je)}var Xr={scheme:"http",domainHost:!0,parse:function(m,b){return m.host||(m.error=m.error||"HTTP URIs must have a host."),m},serialize:function(m,b){var E=String(m.scheme).toLowerCase()==="https";return(m.port===(E?443:80)||m.port==="")&&(m.port=void 0),m.path||(m.path="/"),m}},Ti={scheme:"https",domainHost:Xr.domainHost,parse:Xr.parse,serialize:Xr.serialize};function Ci(_){return typeof _.secure=="boolean"?_.secure:String(_.scheme).toLowerCase()==="wss"}var es={scheme:"ws",domainHost:!0,parse:function(m,b){var E=m;return E.secure=Ci(E),E.resourceName=(E.path||"/")+(E.query?"?"+E.query:""),E.path=void 0,E.query=void 0,E},serialize:function(m,b){if((m.port===(Ci(m)?443:80)||m.port==="")&&(m.port=void 0),typeof m.secure=="boolean"&&(m.scheme=m.secure?"wss":"ws",m.secure=void 0),m.resourceName){var E=m.resourceName.split("?"),P=d(E,2),M=P[0],K=P[1];m.path=M&&M!=="/"?M:void 0,m.query=K,m.resourceName=void 0}return m.fragment=void 0,m}},Ri={scheme:"wss",domainHost:es.domainHost,parse:es.parse,serialize:es.serialize},Uf={},qf=!0,ki="[A-Za-z0-9\\-\\.\\_\\~"+(qf?"\\xA0-\\u200D\\u2010-\\u2029\\u202F-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF":"")+"]",vt="[0-9A-Fa-f]",Vf=r(r("%[EFef]"+vt+"%"+vt+vt+"%"+vt+vt)+"|"+r("%[89A-Fa-f]"+vt+"%"+vt+vt)+"|"+r("%"+vt+vt)),zf="[A-Za-z0-9\\!\\$\\%\\'\\*\\+\\-\\^\\_\\`\\{\\|\\}\\~]",Bf="[\\!\\$\\%\\'\\(\\)\\*\\+\\,\\-\\.0-9\\<\\>A-Z\\x5E-\\x7E]",Hf=e(Bf,'[\\"\\\\]'),Zf="[\\!\\$\\'\\(\\)\\*\\+\\,\\;\\:\\@]",Wf=new RegExp(ki,"g"),Ar=new RegExp(Vf,"g"),Gf=new RegExp(e("[^]",zf,"[\\.]",'[\\"]',Hf),"g"),Oi=new RegExp(e("[^]",ki,Zf),"g"),Qf=Oi;function Qa(_){var m=je(_);return m.match(Wf)?m:_}var Di={scheme:"mailto",parse:function(m,b){var E=m,P=E.to=E.path?E.path.split(","):[];if(E.path=void 0,E.query){for(var M=!1,K={},ne=E.query.split("&"),ce=0,Ce=ne.length;ce<Ce;++ce){var ae=ne[ce].split("=");switch(ae[0]){case"to":for(var ye=ae[1].split(","),Re=0,ve=ye.length;Re<ve;++Re)P.push(ye[Re]);break;case"subject":E.subject=ot(ae[1],b);break;case"body":E.body=ot(ae[1],b);break;default:M=!0,K[ot(ae[0],b)]=ot(ae[1],b);break}}M&&(E.headers=K)}E.query=void 0;for(var oe=0,_e=P.length;oe<_e;++oe){var fe=P[oe].split("@");if(fe[0]=ot(fe[0]),b.unicodeSupport)fe[1]=ot(fe[1],b).toLowerCase();else try{fe[1]=ie.toASCII(ot(fe[1],b).toLowerCase())}catch(pr){E.error=E.error||"Email address's domain name can not be converted to ASCII via punycode: "+pr}P[oe]=fe.join("@")}return E},serialize:function(m,b){var E=m,P=n(m.to);if(P){for(var M=0,K=P.length;M<K;++M){var ne=String(P[M]),ce=ne.lastIndexOf("@"),Ce=ne.slice(0,ce).replace(Ar,Qa).replace(Ar,t).replace(Gf,ke),ae=ne.slice(ce+1);try{ae=b.iri?ie.toUnicode(ae):ie.toASCII(ot(ae,b).toLowerCase())}catch(oe){E.error=E.error||"Email address's domain name can not be converted to "+(b.iri?"Unicode":"ASCII")+" via punycode: "+oe}P[M]=Ce+"@"+ae}E.path=P.join(",")}var ye=m.headers=m.headers||{};m.subject&&(ye.subject=m.subject),m.body&&(ye.body=m.body);var Re=[];for(var ve in ye)ye[ve]!==Uf[ve]&&Re.push(ve.replace(Ar,Qa).replace(Ar,t).replace(Oi,ke)+"="+ye[ve].replace(Ar,Qa).replace(Ar,t).replace(Qf,ke));return Re.length&&(E.query=Re.join("&")),E}},Jf=/^([^\:]+)\:(.*)/,$i={scheme:"urn",parse:function(m,b){var E=m.path&&m.path.match(Jf),P=m;if(E){var M=b.scheme||P.scheme||"urn",K=E[1].toLowerCase(),ne=E[2],ce=M+":"+(b.nid||K),Ce=we[ce];P.nid=K,P.nss=ne,P.path=void 0,Ce&&(P=Ce.parse(P,b))}else P.error=P.error||"URN can not be parsed.";return P},serialize:function(m,b){var E=b.scheme||m.scheme||"urn",P=m.nid,M=E+":"+(b.nid||P),K=we[M];K&&(m=K.serialize(m,b));var ne=m,ce=m.nss;return ne.path=(P||b.nid)+":"+ce,ne}},Kf=/^[0-9A-Fa-f]{8}(?:\-[0-9A-Fa-f]{4}){3}\-[0-9A-Fa-f]{12}$/,Ii={scheme:"urn:uuid",parse:function(m,b){var E=m;return E.uuid=E.nss,E.nss=void 0,!b.tolerant&&(!E.uuid||!E.uuid.match(Kf))&&(E.error=E.error||"UUID is not valid."),E},serialize:function(m,b){var E=m;return E.nss=(m.uuid||"").toLowerCase(),E}};we[Xr.scheme]=Xr,we[Ti.scheme]=Ti,we[es.scheme]=es,we[Ri.scheme]=Ri,we[Di.scheme]=Di,we[$i.scheme]=$i,we[Ii.scheme]=Ii,s.SCHEMES=we,s.pctEncChar=ke,s.pctDecChars=je,s.parse=le,s.removeDotSegments=Ye,s.serialize=Be,s.resolveComponents=Me,s.resolve=mt,s.normalize=Ge,s.equal=Rs,s.escapeComponent=Ga,s.unescapeComponent=ot,Object.defineProperty(s,"__esModule",{value:!0})})});var na=z((Uy,El)=>{"use strict";El.exports=function s(e,r){if(e===r)return!0;if(e&&r&&typeof e=="object"&&typeof r=="object"){if(e.constructor!==r.constructor)return!1;var a,t,n;if(Array.isArray(e)){if(a=e.length,a!=r.length)return!1;for(t=a;t--!==0;)if(!s(e[t],r[t]))return!1;return!0}if(e.constructor===RegExp)return e.source===r.source&&e.flags===r.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===r.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===r.toString();if(n=Object.keys(e),a=n.length,a!==Object.keys(r).length)return!1;for(t=a;t--!==0;)if(!Object.prototype.hasOwnProperty.call(r,n[t]))return!1;for(t=a;t--!==0;){var o=n[t];if(!s(e[o],r[o]))return!1}return!0}return e!==e&&r!==r}});var Pl=z((qy,Sl)=>{"use strict";Sl.exports=function(e){for(var r=0,a=e.length,t=0,n;t<a;)r++,n=e.charCodeAt(t++),n>=55296&&n<=56319&&t<a&&(n=e.charCodeAt(t),(n&64512)==56320&&t++);return r}});var Tr=z((Vy,Cl)=>{"use strict";Cl.exports={copy:Np,checkDataType:_n,checkDataTypes:Lp,coerceToTypes:Fp,toHash:bn,getProperty:xn,escapeQuotes:En,equal:na(),ucs2length:Pl(),varOccurences:Up,varReplace:qp,schemaHasRules:Vp,schemaHasRulesExcept:zp,schemaUnknownRules:Bp,toQuotedString:Sn,getPathExpr:Hp,getPath:Zp,getData:Qp,unescapeFragment:Jp,unescapeJsonPointer:wn,escapeFragment:Kp,escapeJsonPointer:Pn};function Np(s,e){e=e||{};for(var r in s)e[r]=s[r];return e}function _n(s,e,r,a){var t=a?" !== ":" === ",n=a?" || ":" && ",o=a?"!":"",i=a?"":"!";switch(s){case"null":return e+t+"null";case"array":return o+"Array.isArray("+e+")";case"object":return"("+o+e+n+"typeof "+e+t+'"object"'+n+i+"Array.isArray("+e+"))";case"integer":return"(typeof "+e+t+'"number"'+n+i+"("+e+" % 1)"+n+e+t+e+(r?n+o+"isFinite("+e+")":"")+")";case"number":return"(typeof "+e+t+'"'+s+'"'+(r?n+o+"isFinite("+e+")":"")+")";default:return"typeof "+e+t+'"'+s+'"'}}function Lp(s,e,r){switch(s.length){case 1:return _n(s[0],e,r,!0);default:var a="",t=bn(s);t.array&&t.object&&(a=t.null?"(":"(!"+e+" || ",a+="typeof "+e+' !== "object")',delete t.null,delete t.array,delete t.object),t.number&&delete t.integer;for(var n in t)a+=(a?" && ":"")+_n(n,e,r,!0);return a}}var wl=bn(["string","number","integer","boolean","null"]);function Fp(s,e){if(Array.isArray(e)){for(var r=[],a=0;a<e.length;a++){var t=e[a];(wl[t]||s==="array"&&t==="array")&&(r[r.length]=t)}if(r.length)return r}else{if(wl[e])return[e];if(s==="array"&&e==="array")return["array"]}}function bn(s){for(var e={},r=0;r<s.length;r++)e[s[r]]=!0;return e}var jp=/^[a-z$_][a-z$_0-9]*$/i,Mp=/'|\\/g;function xn(s){return typeof s=="number"?"["+s+"]":jp.test(s)?"."+s:"['"+En(s)+"']"}function En(s){return s.replace(Mp,"\\$&").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\f/g,"\\f").replace(/\t/g,"\\t")}function Up(s,e){e+="[^0-9]";var r=s.match(new RegExp(e,"g"));return r?r.length:0}function qp(s,e,r){return e+="([^0-9])",r=r.replace(/\$/g,"$$$$"),s.replace(new RegExp(e,"g"),r+"$1")}function Vp(s,e){if(typeof s=="boolean")return!s;for(var r in s)if(e[r])return!0}function zp(s,e,r){if(typeof s=="boolean")return!s&&r!="not";for(var a in s)if(a!=r&&e[a])return!0}function Bp(s,e){if(typeof s!="boolean"){for(var r in s)if(!e[r])return r}}function Sn(s){return"'"+En(s)+"'"}function Hp(s,e,r,a){var t=r?"'/' + "+e+(a?"":".replace(/~/g, '~0').replace(/\\//g, '~1')"):a?"'[' + "+e+" + ']'":"'[\\'' + "+e+" + '\\']'";return Tl(s,t)}function Zp(s,e,r){var a=Sn(r?"/"+Pn(e):xn(e));return Tl(s,a)}var Wp=/^\/(?:[^~]|~0|~1)*$/,Gp=/^([0-9]+)(#|\/(?:[^~]|~0|~1)*)?$/;function Qp(s,e,r){var a,t,n,o;if(s==="")return"rootData";if(s[0]=="/"){if(!Wp.test(s))throw new Error("Invalid JSON-pointer: "+s);t=s,n="rootData"}else{if(o=s.match(Gp),!o)throw new Error("Invalid JSON-pointer: "+s);if(a=+o[1],t=o[2],t=="#"){if(a>=e)throw new Error("Cannot access property/index "+a+" levels up, current level is "+e);return r[e-a]}if(a>e)throw new Error("Cannot access data "+a+" levels up, current level is "+e);if(n="data"+(e-a||""),!t)return n}for(var i=n,l=t.split("/"),c=0;c<l.length;c++){var d=l[c];d&&(n+=xn(wn(d)),i+=" && "+n)}return i}function Tl(s,e){return s=='""'?e:(s+" + "+e).replace(/([^\\])' \+ '/g,"$1")}function Jp(s){return wn(decodeURIComponent(s))}function Kp(s){return encodeURIComponent(Pn(s))}function Pn(s){return s.replace(/~/g,"~0").replace(/\//g,"~1")}function wn(s){return s.replace(/~1/g,"/").replace(/~0/g,"~")}});var Tn=z((zy,Rl)=>{"use strict";var Yp=Tr();Rl.exports=Xp;function Xp(s){Yp.copy(s,this)}});var Ol=z((By,kl)=>{"use strict";var sr=kl.exports=function(s,e,r){typeof e=="function"&&(r=e,e={}),r=e.cb||r;var a=typeof r=="function"?r:r.pre||function(){},t=r.post||function(){};ia(e,a,t,s,"",s)};sr.keywords={additionalItems:!0,items:!0,contains:!0,additionalProperties:!0,propertyNames:!0,not:!0},sr.arrayKeywords={items:!0,allOf:!0,anyOf:!0,oneOf:!0},sr.propsKeywords={definitions:!0,properties:!0,patternProperties:!0,dependencies:!0},sr.skipKeywords={default:!0,enum:!0,const:!0,required:!0,maximum:!0,minimum:!0,exclusiveMaximum:!0,exclusiveMinimum:!0,multipleOf:!0,maxLength:!0,minLength:!0,pattern:!0,format:!0,maxItems:!0,minItems:!0,uniqueItems:!0,maxProperties:!0,minProperties:!0};function ia(s,e,r,a,t,n,o,i,l,c){if(a&&typeof a=="object"&&!Array.isArray(a)){e(a,t,n,o,i,l,c);for(var d in a){var h=a[d];if(Array.isArray(h)){if(d in sr.arrayKeywords)for(var v=0;v<h.length;v++)ia(s,e,r,h[v],t+"/"+d+"/"+v,n,t,d,a,v)}else if(d in sr.propsKeywords){if(h&&typeof h=="object")for(var f in h)ia(s,e,r,h[f],t+"/"+d+"/"+em(f),n,t,d,a,f)}else(d in sr.keywords||s.allKeys&&!(d in sr.skipKeywords))&&ia(s,e,r,h,t+"/"+d,n,t,d,a)}r(a,t,n,o,i,l,c)}}function em(s){return s.replace(/~/g,"~0").replace(/\//g,"~1")}});var fa=z((Hy,Al)=>{"use strict";var ms=xl(),Dl=na(),oa=Tr(),la=Tn(),tm=Ol();Al.exports=ar,ar.normalizeId=nr,ar.fullPath=ua,ar.url=da,ar.ids=im,ar.inlineRef=Cn,ar.schema=ca;function ar(s,e,r){var a=this._refs[r];if(typeof a=="string")if(this._refs[a])a=this._refs[a];else return ar.call(this,s,e,a);if(a=a||this._schemas[r],a instanceof la)return Cn(a.schema,this._opts.inlineRefs)?a.schema:a.validate||this._compile(a);var t=ca.call(this,e,r),n,o,i;return t&&(n=t.schema,e=t.root,i=t.baseId),n instanceof la?o=n.validate||s.call(this,n.schema,e,void 0,i):n!==void 0&&(o=Cn(n,this._opts.inlineRefs)?n:s.call(this,n,e,void 0,i)),o}function ca(s,e){var r=ms.parse(e),a=Il(r),t=ua(this._getId(s.schema));if(Object.keys(s.schema).length===0||a!==t){var n=nr(a),o=this._refs[n];if(typeof o=="string")return rm.call(this,s,o,r);if(o instanceof la)o.validate||this._compile(o),s=o;else if(o=this._schemas[n],o instanceof la){if(o.validate||this._compile(o),n==nr(e))return{schema:o,root:s,baseId:t};s=o}else return;if(!s.schema)return;t=ua(this._getId(s.schema))}return $l.call(this,r,t,s.schema,s)}function rm(s,e,r){var a=ca.call(this,s,e);if(a){var t=a.schema,n=a.baseId;s=a.root;var o=this._getId(t);return o&&(n=da(n,o)),$l.call(this,r,n,t,s)}}var sm=oa.toHash(["properties","patternProperties","enum","dependencies","definitions"]);function $l(s,e,r,a){if(s.fragment=s.fragment||"",s.fragment.slice(0,1)=="/"){for(var t=s.fragment.split("/"),n=1;n<t.length;n++){var o=t[n];if(o){if(o=oa.unescapeFragment(o),r=r[o],r===void 0)break;var i;if(!sm[o]&&(i=this._getId(r),i&&(e=da(e,i)),r.$ref)){var l=da(e,r.$ref),c=ca.call(this,a,l);c&&(r=c.schema,a=c.root,e=c.baseId)}}}if(r!==void 0&&r!==a.schema)return{schema:r,root:a,baseId:e}}}var am=oa.toHash(["type","format","pattern","maxLength","minLength","maxProperties","minProperties","maxItems","minItems","maximum","minimum","uniqueItems","multipleOf","required","enum"]);function Cn(s,e){if(e===!1)return!1;if(e===void 0||e===!0)return Rn(s);if(e)return kn(s)<=e}function Rn(s){var e;if(Array.isArray(s)){for(var r=0;r<s.length;r++)if(e=s[r],typeof e=="object"&&!Rn(e))return!1}else for(var a in s)if(a=="$ref"||(e=s[a],typeof e=="object"&&!Rn(e)))return!1;return!0}function kn(s){var e=0,r;if(Array.isArray(s)){for(var a=0;a<s.length;a++)if(r=s[a],typeof r=="object"&&(e+=kn(r)),e==1/0)return 1/0}else for(var t in s){if(t=="$ref")return 1/0;if(am[t])e++;else if(r=s[t],typeof r=="object"&&(e+=kn(r)+1),e==1/0)return 1/0}return e}function ua(s,e){e!==!1&&(s=nr(s));var r=ms.parse(s);return Il(r)}function Il(s){return ms.serialize(s).split("#")[0]+"#"}var nm=/#\/?$/;function nr(s){return s?s.replace(nm,""):""}function da(s,e){return e=nr(e),ms.resolve(s,e)}function im(s){var e=nr(this._getId(s)),r={"":e},a={"":ua(e,!1)},t={},n=this;return tm(s,{allKeys:!0},function(o,i,l,c,d,h,v){if(i!==""){var f=n._getId(o),p=r[c],y=a[c]+"/"+d;if(v!==void 0&&(y+="/"+(typeof v=="number"?v:oa.escapeFragment(v))),typeof f=="string"){f=p=nr(p?ms.resolve(p,f):f);var g=n._refs[f];if(typeof g=="string"&&(g=n._refs[g]),g&&g.schema){if(!Dl(o,g.schema))throw new Error('id "'+f+'" resolves to more than one schema')}else if(f!=nr(y))if(f[0]=="#"){if(t[f]&&!Dl(o,t[f]))throw new Error('id "'+f+'" resolves to more than one schema');t[f]=o}else n._refs[f]=y}r[i]=p,a[i]=y}}),t}});var ha=z((Zy,Ll)=>{"use strict";var On=fa();Ll.exports={Validation:Nl(om),MissingRef:Nl(Dn)};function om(s){this.message="validation failed",this.errors=s,this.ajv=this.validation=!0}Dn.message=function(s,e){return"can't resolve reference "+e+" from id "+s};function Dn(s,e,r){this.message=r||Dn.message(s,e),this.missingRef=On.url(s,e),this.missingSchema=On.normalizeId(On.fullPath(this.missingRef))}function Nl(s){return s.prototype=Object.create(Error.prototype),s.prototype.constructor=s,s}});var $n=z((Wy,Fl)=>{"use strict";Fl.exports=function(s,e){e||(e={}),typeof e=="function"&&(e={cmp:e});var r=typeof e.cycles=="boolean"?e.cycles:!1,a=e.cmp&&function(n){return function(o){return function(i,l){var c={key:i,value:o[i]},d={key:l,value:o[l]};return n(c,d)}}}(e.cmp),t=[];return function n(o){if(o&&o.toJSON&&typeof o.toJSON=="function"&&(o=o.toJSON()),o!==void 0){if(typeof o=="number")return isFinite(o)?""+o:"null";if(typeof o!="object")return JSON.stringify(o);var i,l;if(Array.isArray(o)){for(l="[",i=0;i<o.length;i++)i&&(l+=","),l+=n(o[i])||"null";return l+"]"}if(o===null)return"null";if(t.indexOf(o)!==-1){if(r)return JSON.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON")}var c=t.push(o)-1,d=Object.keys(o).sort(a&&a(o));for(l="",i=0;i<d.length;i++){var h=d[i],v=n(o[h]);v&&(l&&(l+=","),l+=JSON.stringify(h)+":"+v)}return t.splice(c,1),"{"+l+"}"}}(s)}});var In=z((Gy,jl)=>{"use strict";jl.exports=function(e,r,a){var t="",n=e.schema.$async===!0,o=e.util.schemaHasRulesExcept(e.schema,e.RULES.all,"$ref"),i=e.self._getId(e.schema);if(e.opts.strictKeywords){var l=e.util.schemaUnknownRules(e.schema,e.RULES.keywords);if(l){var c="unknown keyword: "+l;if(e.opts.strictKeywords==="log")e.logger.warn(c);else throw new Error(c)}}if(e.isTop&&(t+=" var validate = ",n&&(e.async=!0,t+="async "),t+="function(data, dataPath, parentData, parentDataProperty, rootData) { 'use strict'; ",i&&(e.opts.sourceCode||e.opts.processCode)&&(t+=" "+("/*# sourceURL="+i+" */")+" ")),typeof e.schema=="boolean"||!(o||e.schema.$ref)){var r="false schema",d=e.level,h=e.dataLevel,v=e.schema[r],f=e.schemaPath+e.util.getProperty(r),p=e.errSchemaPath+"/"+r,C=!e.opts.allErrors,U,y="data"+(h||""),T="valid"+d;if(e.schema===!1){e.isTop?C=!0:t+=" var "+T+" = false; ";var g=g||[];g.push(t),t="",e.createErrors!==!1?(t+=" { keyword: '"+(U||"false schema")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(p)+" , params: {} ",e.opts.messages!==!1&&(t+=" , message: 'boolean schema is false' "),e.opts.verbose&&(t+=" , schema: false , parentSchema: validate.schema"+e.schemaPath+" , data: "+y+" "),t+=" } "):t+=" {} ";var x=t;t=g.pop(),!e.compositeRule&&C?e.async?t+=" throw new ValidationError(["+x+"]); ":t+=" validate.errors = ["+x+"]; return false; ":t+=" var err = "+x+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; "}else e.isTop?n?t+=" return data; ":t+=" validate.errors = null; return true; ":t+=" var "+T+" = true; ";return e.isTop&&(t+=" }; return validate; "),t}if(e.isTop){var S=e.isTop,d=e.level=0,h=e.dataLevel=0,y="data";if(e.rootId=e.resolve.fullPath(e.self._getId(e.root.schema)),e.baseId=e.baseId||e.rootId,delete e.isTop,e.dataPathArr=[""],e.schema.default!==void 0&&e.opts.useDefaults&&e.opts.strictDefaults){var w="default is ignored in the schema root";if(e.opts.strictDefaults==="log")e.logger.warn(w);else throw new Error(w)}t+=" var vErrors = null; ",t+=" var errors = 0;     ",t+=" if (rootData === undefined) rootData = data; "}else{var d=e.level,h=e.dataLevel,y="data"+(h||"");if(i&&(e.baseId=e.resolve.url(e.baseId,i)),n&&!e.async)throw new Error("async schema in sync schema");t+=" var errs_"+d+" = errors;"}var T="valid"+d,C=!e.opts.allErrors,R="",L="",U,$=e.schema.type,D=Array.isArray($);if($&&e.opts.nullable&&e.schema.nullable===!0&&(D?$.indexOf("null")==-1&&($=$.concat("null")):$!="null"&&($=[$,"null"],D=!0)),D&&$.length==1&&($=$[0],D=!1),e.schema.$ref&&o){if(e.opts.extendRefs=="fail")throw new Error('$ref: validation keywords used in schema at path "'+e.errSchemaPath+'" (see option extendRefs)');e.opts.extendRefs!==!0&&(o=!1,e.logger.warn('$ref: keywords ignored in schema at path "'+e.errSchemaPath+'"'))}if(e.schema.$comment&&e.opts.$comment&&(t+=" "+e.RULES.all.$comment.code(e,"$comment")),$){if(e.opts.coerceTypes)var F=e.util.coerceToTypes(e.opts.coerceTypes,$);var q=e.RULES.types[$];if(F||D||q===!0||q&&!$e(q)){var f=e.schemaPath+".type",p=e.errSchemaPath+"/type",f=e.schemaPath+".type",p=e.errSchemaPath+"/type",I=D?"checkDataTypes":"checkDataType";if(t+=" if ("+e.util[I]($,y,e.opts.strictNumbers,!0)+") { ",F){var A="dataType"+d,V="coerced"+d;t+=" var "+A+" = typeof "+y+"; var "+V+" = undefined; ",e.opts.coerceTypes=="array"&&(t+=" if ("+A+" == 'object' && Array.isArray("+y+") && "+y+".length == 1) { "+y+" = "+y+"[0]; "+A+" = typeof "+y+"; if ("+e.util.checkDataType(e.schema.type,y,e.opts.strictNumbers)+") "+V+" = "+y+"; } "),t+=" if ("+V+" !== undefined) ; ";var ue=F;if(ue)for(var ee,se=-1,X=ue.length-1;se<X;)ee=ue[se+=1],ee=="string"?t+=" else if ("+A+" == 'number' || "+A+" == 'boolean') "+V+" = '' + "+y+"; else if ("+y+" === null) "+V+" = ''; ":ee=="number"||ee=="integer"?(t+=" else if ("+A+" == 'boolean' || "+y+" === null || ("+A+" == 'string' && "+y+" && "+y+" == +"+y+" ",ee=="integer"&&(t+=" && !("+y+" % 1)"),t+=")) "+V+" = +"+y+"; "):ee=="boolean"?t+=" else if ("+y+" === 'false' || "+y+" === 0 || "+y+" === null) "+V+" = false; else if ("+y+" === 'true' || "+y+" === 1) "+V+" = true; ":ee=="null"?t+=" else if ("+y+" === '' || "+y+" === 0 || "+y+" === false) "+V+" = null; ":e.opts.coerceTypes=="array"&&ee=="array"&&(t+=" else if ("+A+" == 'string' || "+A+" == 'number' || "+A+" == 'boolean' || "+y+" == null) "+V+" = ["+y+"]; ");t+=" else {   ";var g=g||[];g.push(t),t="",e.createErrors!==!1?(t+=" { keyword: '"+(U||"type")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(p)+" , params: { type: '",D?t+=""+$.join(","):t+=""+$,t+="' } ",e.opts.messages!==!1&&(t+=" , message: 'should be ",D?t+=""+$.join(","):t+=""+$,t+="' "),e.opts.verbose&&(t+=" , schema: validate.schema"+f+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+y+" "),t+=" } "):t+=" {} ";var x=t;t=g.pop(),!e.compositeRule&&C?e.async?t+=" throw new ValidationError(["+x+"]); ":t+=" validate.errors = ["+x+"]; return false; ":t+=" var err = "+x+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",t+=" } if ("+V+" !== undefined) {  ";var H=h?"data"+(h-1||""):"parentData",xe=h?e.dataPathArr[h]:"parentDataProperty";t+=" "+y+" = "+V+"; ",h||(t+="if ("+H+" !== undefined)"),t+=" "+H+"["+xe+"] = "+V+"; } "}else{var g=g||[];g.push(t),t="",e.createErrors!==!1?(t+=" { keyword: '"+(U||"type")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(p)+" , params: { type: '",D?t+=""+$.join(","):t+=""+$,t+="' } ",e.opts.messages!==!1&&(t+=" , message: 'should be ",D?t+=""+$.join(","):t+=""+$,t+="' "),e.opts.verbose&&(t+=" , schema: validate.schema"+f+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+y+" "),t+=" } "):t+=" {} ";var x=t;t=g.pop(),!e.compositeRule&&C?e.async?t+=" throw new ValidationError(["+x+"]); ":t+=" validate.errors = ["+x+"]; return false; ":t+=" var err = "+x+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; "}t+=" } "}}if(e.schema.$ref&&!o)t+=" "+e.RULES.all.$ref.code(e,"$ref")+" ",C&&(t+=" } if (errors === ",S?t+="0":t+="errs_"+d,t+=") { ",L+="}");else{var Ae=e.RULES;if(Ae){for(var q,Fe=-1,ie=Ae.length-1;Fe<ie;)if(q=Ae[Fe+=1],$e(q)){if(q.type&&(t+=" if ("+e.util.checkDataType(q.type,y,e.opts.strictNumbers)+") { "),e.opts.useDefaults){if(q.type=="object"&&e.schema.properties){var v=e.schema.properties,we=Object.keys(v),ke=we;if(ke)for(var je,Mt=-1,Pt=ke.length-1;Mt<Pt;){je=ke[Mt+=1];var Te=v[je];if(Te.default!==void 0){var Ee=y+e.util.getProperty(je);if(e.compositeRule){if(e.opts.strictDefaults){var w="default is ignored for: "+Ee;if(e.opts.strictDefaults==="log")e.logger.warn(w);else throw new Error(w)}}else t+=" if ("+Ee+" === undefined ",e.opts.useDefaults=="empty"&&(t+=" || "+Ee+" === null || "+Ee+" === '' "),t+=" ) "+Ee+" = ",e.opts.useDefaults=="shared"?t+=" "+e.useDefault(Te.default)+" ":t+=" "+JSON.stringify(Te.default)+" ",t+="; "}}}else if(q.type=="array"&&Array.isArray(e.schema.items)){var dr=e.schema.items;if(dr){for(var Te,se=-1,Ne=dr.length-1;se<Ne;)if(Te=dr[se+=1],Te.default!==void 0){var Ee=y+"["+se+"]";if(e.compositeRule){if(e.opts.strictDefaults){var w="default is ignored for: "+Ee;if(e.opts.strictDefaults==="log")e.logger.warn(w);else throw new Error(w)}}else t+=" if ("+Ee+" === undefined ",e.opts.useDefaults=="empty"&&(t+=" || "+Ee+" === null || "+Ee+" === '' "),t+=" ) "+Ee+" = ",e.opts.useDefaults=="shared"?t+=" "+e.useDefault(Te.default)+" ":t+=" "+JSON.stringify(Te.default)+" ",t+="; "}}}}var le=q.rules;if(le){for(var Ut,wt=-1,fr=le.length-1;wt<fr;)if(Ut=le[wt+=1],Ye(Ut)){var hr=Ut.code(e,Ut.keyword,q.type);hr&&(t+=" "+hr+" ",C&&(R+="}"))}}if(C&&(t+=" "+R+" ",R=""),q.type&&(t+=" } ",$&&$===q.type&&!F)){t+=" else { ";var f=e.schemaPath+".type",p=e.errSchemaPath+"/type",g=g||[];g.push(t),t="",e.createErrors!==!1?(t+=" { keyword: '"+(U||"type")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(p)+" , params: { type: '",D?t+=""+$.join(","):t+=""+$,t+="' } ",e.opts.messages!==!1&&(t+=" , message: 'should be ",D?t+=""+$.join(","):t+=""+$,t+="' "),e.opts.verbose&&(t+=" , schema: validate.schema"+f+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+y+" "),t+=" } "):t+=" {} ";var x=t;t=g.pop(),!e.compositeRule&&C?e.async?t+=" throw new ValidationError(["+x+"]); ":t+=" validate.errors = ["+x+"]; return false; ":t+=" var err = "+x+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",t+=" } "}C&&(t+=" if (errors === ",S?t+="0":t+="errs_"+d,t+=") { ",L+="}")}}}C&&(t+=" "+L+" "),S?(n?(t+=" if (errors === 0) return data;           ",t+=" else throw new ValidationError(vErrors); "):(t+=" validate.errors = vErrors; ",t+=" return errors === 0;       "),t+=" }; return validate;"):t+=" var "+T+" = errors === errs_"+d+";";function $e(Me){for(var mt=Me.rules,Ge=0;Ge<mt.length;Ge++)if(Ye(mt[Ge]))return!0}function Ye(Me){return e.schema[Me.keyword]!==void 0||Me.implements&&Be(Me)}function Be(Me){for(var mt=Me.implements,Ge=0;Ge<mt.length;Ge++)if(e.schema[mt[Ge]]!==void 0)return!0}return t}});var zl=z((Qy,Vl)=>{"use strict";var pa=fa(),ma=Tr(),Ml=ha(),lm=$n(),Ul=In(),cm=ma.ucs2length,um=na(),dm=Ml.Validation;Vl.exports=An;function An(s,e,r,a){var t=this,n=this._opts,o=[void 0],i={},l=[],c={},d=[],h={},v=[];e=e||{schema:s,refVal:o,refs:i};var f=fm.call(this,s,e,a),p=this._compilations[f.index];if(f.compiling)return p.callValidate=w;var y=this._formats,g=this.RULES;try{var x=T(s,e,r,a);p.validate=x;var S=p.callValidate;return S&&(S.schema=x.schema,S.errors=null,S.refs=x.refs,S.refVal=x.refVal,S.root=x.root,S.$async=x.$async,n.sourceCode&&(S.source=x.source)),x}finally{hm.call(this,s,e,a)}function w(){var I=p.validate,A=I.apply(this,arguments);return w.errors=I.errors,A}function T(I,A,V,ue){var ee=!A||A&&A.schema==I;if(A.schema!=e.schema)return An.call(t,I,A,V,ue);var se=I.$async===!0,X=Ul({isTop:!0,schema:I,isRoot:ee,baseId:ue,root:A,schemaPath:"",errSchemaPath:"#",errorPath:'""',MissingRefError:Ml.MissingRef,RULES:g,validate:Ul,util:ma,resolve:pa,resolveRef:C,usePattern:D,useDefault:F,useCustomRule:q,opts:n,formats:y,logger:t.logger,self:t});X=va(o,vm)+va(l,pm)+va(d,mm)+va(v,gm)+X,n.processCode&&(X=n.processCode(X,I));var H;try{var xe=new Function("self","RULES","formats","root","refVal","defaults","customRules","equal","ucs2length","ValidationError",X);H=xe(t,g,y,e,o,d,v,um,cm,dm),o[0]=H}catch(Ae){throw t.logger.error("Error compiling schema, function code:",X),Ae}return H.schema=I,H.errors=null,H.refs=i,H.refVal=o,H.root=ee?H:A,se&&(H.$async=!0),n.sourceCode===!0&&(H.source={code:X,patterns:l,defaults:d}),H}function C(I,A,V){A=pa.url(I,A);var ue=i[A],ee,se;if(ue!==void 0)return ee=o[ue],se="refVal["+ue+"]",$(ee,se);if(!V&&e.refs){var X=e.refs[A];if(X!==void 0)return ee=e.refVal[X],se=R(A,ee),$(ee,se)}se=R(A);var H=pa.call(t,T,e,A);if(H===void 0){var xe=r&&r[A];xe&&(H=pa.inlineRef(xe,n.inlineRefs)?xe:An.call(t,xe,e,r,I))}if(H===void 0)L(A);else return U(A,H),$(H,se)}function R(I,A){var V=o.length;return o[V]=A,i[I]=V,"refVal"+V}function L(I){delete i[I]}function U(I,A){var V=i[I];o[V]=A}function $(I,A){return typeof I=="object"||typeof I=="boolean"?{code:A,schema:I,inline:!0}:{code:A,$async:I&&!!I.$async}}function D(I){var A=c[I];return A===void 0&&(A=c[I]=l.length,l[A]=I),"pattern"+A}function F(I){switch(typeof I){case"boolean":case"number":return""+I;case"string":return ma.toQuotedString(I);case"object":if(I===null)return"null";var A=lm(I),V=h[A];return V===void 0&&(V=h[A]=d.length,d[V]=I),"default"+V}}function q(I,A,V,ue){if(t._opts.validateSchema!==!1){var ee=I.definition.dependencies;if(ee&&!ee.every(function(ke){return Object.prototype.hasOwnProperty.call(V,ke)}))throw new Error("parent schema must have all required keywords: "+ee.join(","));var se=I.definition.validateSchema;if(se){var X=se(A);if(!X){var H="keyword schema is invalid: "+t.errorsText(se.errors);if(t._opts.validateSchema=="log")t.logger.error(H);else throw new Error(H)}}}var xe=I.definition.compile,Ae=I.definition.inline,Fe=I.definition.macro,ie;if(xe)ie=xe.call(t,A,V,ue);else if(Fe)ie=Fe.call(t,A,V,ue),n.validateSchema!==!1&&t.validateSchema(ie,!0);else if(Ae)ie=Ae.call(t,ue,I.keyword,A,V);else if(ie=I.definition.validate,!ie)return;if(ie===void 0)throw new Error('custom keyword "'+I.keyword+'"failed to compile');var we=v.length;return v[we]=ie,{code:"customRule"+we,validate:ie}}}function fm(s,e,r){var a=ql.call(this,s,e,r);return a>=0?{index:a,compiling:!0}:(a=this._compilations.length,this._compilations[a]={schema:s,root:e,baseId:r},{index:a,compiling:!1})}function hm(s,e,r){var a=ql.call(this,s,e,r);a>=0&&this._compilations.splice(a,1)}function ql(s,e,r){for(var a=0;a<this._compilations.length;a++){var t=this._compilations[a];if(t.schema==s&&t.root==e&&t.baseId==r)return a}return-1}function pm(s,e){return"var pattern"+s+" = new RegExp("+ma.toQuotedString(e[s])+");"}function mm(s){return"var default"+s+" = defaults["+s+"];"}function vm(s,e){return e[s]===void 0?"":"var refVal"+s+" = refVal["+s+"];"}function gm(s){return"var customRule"+s+" = customRules["+s+"];"}function va(s,e){if(!s.length)return"";for(var r="",a=0;a<s.length;a++)r+=e(a,s);return r}});var Hl=z((Jy,Bl)=>{"use strict";var ga=Bl.exports=function(){this._cache={}};ga.prototype.put=function(e,r){this._cache[e]=r},ga.prototype.get=function(e){return this._cache[e]},ga.prototype.del=function(e){delete this._cache[e]},ga.prototype.clear=function(){this._cache={}}});var sc=z((Ky,rc)=>{"use strict";var ym=Tr(),_m=/^(\d\d\d\d)-(\d\d)-(\d\d)$/,bm=[0,31,28,31,30,31,30,31,31,30,31,30,31],xm=/^(\d\d):(\d\d):(\d\d)(\.\d+)?(z|[+-]\d\d(?::?\d\d)?)?$/i,Zl=/^(?=.{1,253}\.?$)[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[-0-9a-z]{0,61}[0-9a-z])?)*\.?$/i,Em=/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)(?:\?(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i,Sm=/^(?:[a-z][a-z0-9+\-.]*:)?(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'"()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?(?:\?(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i,Wl=/^(?:(?:[^\x00-\x20"'<>%\\^`{|}]|%[0-9a-f]{2})|\{[+#./;?&=,!@|]?(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?(?:,(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?)*\})*$/i,Gl=/^(?:(?:http[s\u017F]?|ftp):\/\/)(?:(?:[\0-\x08\x0E-\x1F!-\x9F\xA1-\u167F\u1681-\u1FFF\u200B-\u2027\u202A-\u202E\u2030-\u205E\u2060-\u2FFF\u3001-\uD7FF\uE000-\uFEFE\uFF00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+(?::(?:[\0-\x08\x0E-\x1F!-\x9F\xA1-\u167F\u1681-\u1FFF\u200B-\u2027\u202A-\u202E\u2030-\u205E\u2060-\u2FFF\u3001-\uD7FF\uE000-\uFEFE\uFF00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*)?@)?(?:(?!10(?:\.[0-9]{1,3}){3})(?!127(?:\.[0-9]{1,3}){3})(?!169\.254(?:\.[0-9]{1,3}){2})(?!192\.168(?:\.[0-9]{1,3}){2})(?!172\.(?:1[6-9]|2[0-9]|3[01])(?:\.[0-9]{1,3}){2})(?:[1-9][0-9]?|1[0-9][0-9]|2[01][0-9]|22[0-3])(?:\.(?:1?[0-9]{1,2}|2[0-4][0-9]|25[0-5])){2}(?:\.(?:[1-9][0-9]?|1[0-9][0-9]|2[0-4][0-9]|25[0-4]))|(?:(?:(?:[0-9a-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+-)*(?:[0-9a-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+)(?:\.(?:(?:[0-9a-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+-)*(?:[0-9a-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+)*(?:\.(?:(?:[a-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]){2,})))(?::[0-9]{2,5})?(?:\/(?:[\0-\x08\x0E-\x1F!-\x9F\xA1-\u167F\u1681-\u1FFF\u200B-\u2027\u202A-\u202E\u2030-\u205E\u2060-\u2FFF\u3001-\uD7FF\uE000-\uFEFE\uFF00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*)?$/i,Ql=/^(?:urn:uuid:)?[0-9a-f]{8}-(?:[0-9a-f]{4}-){3}[0-9a-f]{12}$/i,Jl=/^(?:\/(?:[^~/]|~0|~1)*)*$/,Kl=/^#(?:\/(?:[a-z0-9_\-.!$&'()*+,;:=@]|%[0-9a-f]{2}|~0|~1)*)*$/i,Yl=/^(?:0|[1-9][0-9]*)(?:#|(?:\/(?:[^~/]|~0|~1)*)*)$/;rc.exports=ya;function ya(s){return s=s=="full"?"full":"fast",ym.copy(ya[s])}ya.fast={date:/^\d\d\d\d-[0-1]\d-[0-3]\d$/,time:/^(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)?$/i,"date-time":/^\d\d\d\d-[0-1]\d-[0-3]\d[t\s](?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)$/i,uri:/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/)?[^\s]*$/i,"uri-reference":/^(?:(?:[a-z][a-z0-9+\-.]*:)?\/?\/)?(?:[^\\\s#][^\s#]*)?(?:#[^\\\s]*)?$/i,"uri-template":Wl,url:Gl,email:/^[a-z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?)*$/i,hostname:Zl,ipv4:/^(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)$/,ipv6:/^\s*(?:(?:(?:[0-9a-f]{1,4}:){7}(?:[0-9a-f]{1,4}|:))|(?:(?:[0-9a-f]{1,4}:){6}(?::[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){5}(?:(?:(?::[0-9a-f]{1,4}){1,2})|:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){4}(?:(?:(?::[0-9a-f]{1,4}){1,3})|(?:(?::[0-9a-f]{1,4})?:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){3}(?:(?:(?::[0-9a-f]{1,4}){1,4})|(?:(?::[0-9a-f]{1,4}){0,2}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){2}(?:(?:(?::[0-9a-f]{1,4}){1,5})|(?:(?::[0-9a-f]{1,4}){0,3}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){1}(?:(?:(?::[0-9a-f]{1,4}){1,6})|(?:(?::[0-9a-f]{1,4}){0,4}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?::(?:(?:(?::[0-9a-f]{1,4}){1,7})|(?:(?::[0-9a-f]{1,4}){0,5}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(?:%.+)?\s*$/i,regex:tc,uuid:Ql,"json-pointer":Jl,"json-pointer-uri-fragment":Kl,"relative-json-pointer":Yl},ya.full={date:Xl,time:ec,"date-time":Tm,uri:Rm,"uri-reference":Sm,"uri-template":Wl,url:Gl,email:/^[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?$/i,hostname:Zl,ipv4:/^(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)$/,ipv6:/^\s*(?:(?:(?:[0-9a-f]{1,4}:){7}(?:[0-9a-f]{1,4}|:))|(?:(?:[0-9a-f]{1,4}:){6}(?::[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){5}(?:(?:(?::[0-9a-f]{1,4}){1,2})|:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){4}(?:(?:(?::[0-9a-f]{1,4}){1,3})|(?:(?::[0-9a-f]{1,4})?:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){3}(?:(?:(?::[0-9a-f]{1,4}){1,4})|(?:(?::[0-9a-f]{1,4}){0,2}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){2}(?:(?:(?::[0-9a-f]{1,4}){1,5})|(?:(?::[0-9a-f]{1,4}){0,3}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){1}(?:(?:(?::[0-9a-f]{1,4}){1,6})|(?:(?::[0-9a-f]{1,4}){0,4}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?::(?:(?:(?::[0-9a-f]{1,4}){1,7})|(?:(?::[0-9a-f]{1,4}){0,5}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(?:%.+)?\s*$/i,regex:tc,uuid:Ql,"json-pointer":Jl,"json-pointer-uri-fragment":Kl,"relative-json-pointer":Yl};function Pm(s){return s%4===0&&(s%100!==0||s%400===0)}function Xl(s){var e=s.match(_m);if(!e)return!1;var r=+e[1],a=+e[2],t=+e[3];return a>=1&&a<=12&&t>=1&&t<=(a==2&&Pm(r)?29:bm[a])}function ec(s,e){var r=s.match(xm);if(!r)return!1;var a=r[1],t=r[2],n=r[3],o=r[5];return(a<=23&&t<=59&&n<=59||a==23&&t==59&&n==60)&&(!e||o)}var wm=/t|\s/i;function Tm(s){var e=s.split(wm);return e.length==2&&Xl(e[0])&&ec(e[1],!0)}var Cm=/\/|:/;function Rm(s){return Cm.test(s)&&Em.test(s)}var km=/[^\\]\\Z/;function tc(s){if(km.test(s))return!1;try{return new RegExp(s),!0}catch{return!1}}});var nc=z((Yy,ac)=>{"use strict";ac.exports=function(e,r,a){var t=" ",n=e.level,o=e.dataLevel,i=e.schema[r],l=e.errSchemaPath+"/"+r,c=!e.opts.allErrors,d="data"+(o||""),h="valid"+n,v,f;if(i=="#"||i=="#/")e.isRoot?(v=e.async,f="validate"):(v=e.root.schema.$async===!0,f="root.refVal[0]");else{var p=e.resolveRef(e.baseId,i,e.isRoot);if(p===void 0){var y=e.MissingRefError.message(e.baseId,i);if(e.opts.missingRefs=="fail"){e.logger.error(y);var g=g||[];g.push(t),t="",e.createErrors!==!1?(t+=" { keyword: '$ref' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { ref: '"+e.util.escapeQuotes(i)+"' } ",e.opts.messages!==!1&&(t+=" , message: 'can\\'t resolve reference "+e.util.escapeQuotes(i)+"' "),e.opts.verbose&&(t+=" , schema: "+e.util.toQuotedString(i)+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+d+" "),t+=" } "):t+=" {} ";var x=t;t=g.pop(),!e.compositeRule&&c?e.async?t+=" throw new ValidationError(["+x+"]); ":t+=" validate.errors = ["+x+"]; return false; ":t+=" var err = "+x+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",c&&(t+=" if (false) { ")}else if(e.opts.missingRefs=="ignore")e.logger.warn(y),c&&(t+=" if (true) { ");else throw new e.MissingRefError(e.baseId,i,y)}else if(p.inline){var S=e.util.copy(e);S.level++;var w="valid"+S.level;S.schema=p.schema,S.schemaPath="",S.errSchemaPath=i;var T=e.validate(S).replace(/validate\.schema/g,p.code);t+=" "+T+" ",c&&(t+=" if ("+w+") { ")}else v=p.$async===!0||e.async&&p.$async!==!1,f=p.code}if(f){var g=g||[];g.push(t),t="",e.opts.passContext?t+=" "+f+".call(this, ":t+=" "+f+"( ",t+=" "+d+", (dataPath || '')",e.errorPath!='""'&&(t+=" + "+e.errorPath);var C=o?"data"+(o-1||""):"parentData",R=o?e.dataPathArr[o]:"parentDataProperty";t+=" , "+C+" , "+R+", rootData)  ";var L=t;if(t=g.pop(),v){if(!e.async)throw new Error("async schema referenced by sync schema");c&&(t+=" var "+h+"; "),t+=" try { await "+L+"; ",c&&(t+=" "+h+" = true; "),t+=" } catch (e) { if (!(e instanceof ValidationError)) throw e; if (vErrors === null) vErrors = e.errors; else vErrors = vErrors.concat(e.errors); errors = vErrors.length; ",c&&(t+=" "+h+" = false; "),t+=" } ",c&&(t+=" if ("+h+") { ")}else t+=" if (!"+L+") { if (vErrors === null) vErrors = "+f+".errors; else vErrors = vErrors.concat("+f+".errors); errors = vErrors.length; } ",c&&(t+=" else { ")}return t}});var oc=z((Xy,ic)=>{"use strict";ic.exports=function(e,r,a){var t=" ",n=e.schema[r],o=e.schemaPath+e.util.getProperty(r),i=e.errSchemaPath+"/"+r,l=!e.opts.allErrors,c=e.util.copy(e),d="";c.level++;var h="valid"+c.level,v=c.baseId,f=!0,p=n;if(p)for(var y,g=-1,x=p.length-1;g<x;)y=p[g+=1],(e.opts.strictKeywords?typeof y=="object"&&Object.keys(y).length>0||y===!1:e.util.schemaHasRules(y,e.RULES.all))&&(f=!1,c.schema=y,c.schemaPath=o+"["+g+"]",c.errSchemaPath=i+"/"+g,t+="  "+e.validate(c)+" ",c.baseId=v,l&&(t+=" if ("+h+") { ",d+="}"));return l&&(f?t+=" if (true) { ":t+=" "+d.slice(0,-1)+" "),t}});var cc=z((e_,lc)=>{"use strict";lc.exports=function(e,r,a){var t=" ",n=e.level,o=e.dataLevel,i=e.schema[r],l=e.schemaPath+e.util.getProperty(r),c=e.errSchemaPath+"/"+r,d=!e.opts.allErrors,h="data"+(o||""),v="valid"+n,f="errs__"+n,p=e.util.copy(e),y="";p.level++;var g="valid"+p.level,x=i.every(function(U){return e.opts.strictKeywords?typeof U=="object"&&Object.keys(U).length>0||U===!1:e.util.schemaHasRules(U,e.RULES.all)});if(x){var S=p.baseId;t+=" var "+f+" = errors; var "+v+" = false;  ";var w=e.compositeRule;e.compositeRule=p.compositeRule=!0;var T=i;if(T)for(var C,R=-1,L=T.length-1;R<L;)C=T[R+=1],p.schema=C,p.schemaPath=l+"["+R+"]",p.errSchemaPath=c+"/"+R,t+="  "+e.validate(p)+" ",p.baseId=S,t+=" "+v+" = "+v+" || "+g+"; if (!"+v+") { ",y+="}";e.compositeRule=p.compositeRule=w,t+=" "+y+" if (!"+v+") {   var err =   ",e.createErrors!==!1?(t+=" { keyword: 'anyOf' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: {} ",e.opts.messages!==!1&&(t+=" , message: 'should match some schema in anyOf' "),e.opts.verbose&&(t+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+h+" "),t+=" } "):t+=" {} ",t+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",!e.compositeRule&&d&&(e.async?t+=" throw new ValidationError(vErrors); ":t+=" validate.errors = vErrors; return false; "),t+=" } else {  errors = "+f+"; if (vErrors !== null) { if ("+f+") vErrors.length = "+f+"; else vErrors = null; } ",e.opts.allErrors&&(t+=" } ")}else d&&(t+=" if (true) { ");return t}});var dc=z((t_,uc)=>{"use strict";uc.exports=function(e,r,a){var t=" ",n=e.schema[r],o=e.errSchemaPath+"/"+r,i=!e.opts.allErrors,l=e.util.toQuotedString(n);return e.opts.$comment===!0?t+=" console.log("+l+");":typeof e.opts.$comment=="function"&&(t+=" self._opts.$comment("+l+", "+e.util.toQuotedString(o)+", validate.root.schema);"),t}});var hc=z((r_,fc)=>{"use strict";fc.exports=function(e,r,a){var t=" ",n=e.level,o=e.dataLevel,i=e.schema[r],l=e.schemaPath+e.util.getProperty(r),c=e.errSchemaPath+"/"+r,d=!e.opts.allErrors,h="data"+(o||""),v="valid"+n,f=e.opts.$data&&i&&i.$data,p;f?(t+=" var schema"+n+" = "+e.util.getData(i.$data,o,e.dataPathArr)+"; ",p="schema"+n):p=i,f||(t+=" var schema"+n+" = validate.schema"+l+";"),t+="var "+v+" = equal("+h+", schema"+n+"); if (!"+v+") {   ";var y=y||[];y.push(t),t="",e.createErrors!==!1?(t+=" { keyword: 'const' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { allowedValue: schema"+n+" } ",e.opts.messages!==!1&&(t+=" , message: 'should be equal to constant' "),e.opts.verbose&&(t+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+h+" "),t+=" } "):t+=" {} ";var g=t;return t=y.pop(),!e.compositeRule&&d?e.async?t+=" throw new ValidationError(["+g+"]); ":t+=" validate.errors = ["+g+"]; return false; ":t+=" var err = "+g+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",t+=" }",d&&(t+=" else { "),t}});var mc=z((s_,pc)=>{"use strict";pc.exports=function(e,r,a){var t=" ",n=e.level,o=e.dataLevel,i=e.schema[r],l=e.schemaPath+e.util.getProperty(r),c=e.errSchemaPath+"/"+r,d=!e.opts.allErrors,h="data"+(o||""),v="valid"+n,f="errs__"+n,p=e.util.copy(e),y="";p.level++;var g="valid"+p.level,x="i"+n,S=p.dataLevel=e.dataLevel+1,w="data"+S,T=e.baseId,C=e.opts.strictKeywords?typeof i=="object"&&Object.keys(i).length>0||i===!1:e.util.schemaHasRules(i,e.RULES.all);if(t+="var "+f+" = errors;var "+v+";",C){var R=e.compositeRule;e.compositeRule=p.compositeRule=!0,p.schema=i,p.schemaPath=l,p.errSchemaPath=c,t+=" var "+g+" = false; for (var "+x+" = 0; "+x+" < "+h+".length; "+x+"++) { ",p.errorPath=e.util.getPathExpr(e.errorPath,x,e.opts.jsonPointers,!0);var L=h+"["+x+"]";p.dataPathArr[S]=x;var U=e.validate(p);p.baseId=T,e.util.varOccurences(U,w)<2?t+=" "+e.util.varReplace(U,w,L)+" ":t+=" var "+w+" = "+L+"; "+U+" ",t+=" if ("+g+") break; }  ",e.compositeRule=p.compositeRule=R,t+=" "+y+" if (!"+g+") {"}else t+=" if ("+h+".length == 0) {";var $=$||[];$.push(t),t="",e.createErrors!==!1?(t+=" { keyword: 'contains' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: {} ",e.opts.messages!==!1&&(t+=" , message: 'should contain a valid item' "),e.opts.verbose&&(t+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+h+" "),t+=" } "):t+=" {} ";var D=t;return t=$.pop(),!e.compositeRule&&d?e.async?t+=" throw new ValidationError(["+D+"]); ":t+=" validate.errors = ["+D+"]; return false; ":t+=" var err = "+D+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",t+=" } else { ",C&&(t+="  errors = "+f+"; if (vErrors !== null) { if ("+f+") vErrors.length = "+f+"; else vErrors = null; } "),e.opts.allErrors&&(t+=" } "),t}});var gc=z((a_,vc)=>{"use strict";vc.exports=function(e,r,a){var t=" ",n=e.level,o=e.dataLevel,i=e.schema[r],l=e.schemaPath+e.util.getProperty(r),c=e.errSchemaPath+"/"+r,d=!e.opts.allErrors,h="data"+(o||""),v="errs__"+n,f=e.util.copy(e),p="";f.level++;var y="valid"+f.level,g={},x={},S=e.opts.ownProperties;for(R in i)if(R!="__proto__"){var w=i[R],T=Array.isArray(w)?x:g;T[R]=w}t+="var "+v+" = errors;";var C=e.errorPath;t+="var missing"+n+";";for(var R in x)if(T=x[R],T.length){if(t+=" if ( "+h+e.util.getProperty(R)+" !== undefined ",S&&(t+=" && Object.prototype.hasOwnProperty.call("+h+", '"+e.util.escapeQuotes(R)+"') "),d){t+=" && ( ";var L=T;if(L)for(var U,$=-1,D=L.length-1;$<D;){U=L[$+=1],$&&(t+=" || ");var F=e.util.getProperty(U),q=h+F;t+=" ( ( "+q+" === undefined ",S&&(t+=" || ! Object.prototype.hasOwnProperty.call("+h+", '"+e.util.escapeQuotes(U)+"') "),t+=") && (missing"+n+" = "+e.util.toQuotedString(e.opts.jsonPointers?U:F)+") ) "}t+=")) {  ";var I="missing"+n,A="' + "+I+" + '";e.opts._errorDataPathProperty&&(e.errorPath=e.opts.jsonPointers?e.util.getPathExpr(C,I,!0):C+" + "+I);var V=V||[];V.push(t),t="",e.createErrors!==!1?(t+=" { keyword: 'dependencies' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { property: '"+e.util.escapeQuotes(R)+"', missingProperty: '"+A+"', depsCount: "+T.length+", deps: '"+e.util.escapeQuotes(T.length==1?T[0]:T.join(", "))+"' } ",e.opts.messages!==!1&&(t+=" , message: 'should have ",T.length==1?t+="property "+e.util.escapeQuotes(T[0]):t+="properties "+e.util.escapeQuotes(T.join(", ")),t+=" when property "+e.util.escapeQuotes(R)+" is present' "),e.opts.verbose&&(t+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+h+" "),t+=" } "):t+=" {} ";var ue=t;t=V.pop(),!e.compositeRule&&d?e.async?t+=" throw new ValidationError(["+ue+"]); ":t+=" validate.errors = ["+ue+"]; return false; ":t+=" var err = "+ue+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; "}else{t+=" ) { ";var ee=T;if(ee)for(var U,se=-1,X=ee.length-1;se<X;){U=ee[se+=1];var F=e.util.getProperty(U),A=e.util.escapeQuotes(U),q=h+F;e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPath(C,U,e.opts.jsonPointers)),t+=" if ( "+q+" === undefined ",S&&(t+=" || ! Object.prototype.hasOwnProperty.call("+h+", '"+e.util.escapeQuotes(U)+"') "),t+=") {  var err =   ",e.createErrors!==!1?(t+=" { keyword: 'dependencies' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { property: '"+e.util.escapeQuotes(R)+"', missingProperty: '"+A+"', depsCount: "+T.length+", deps: '"+e.util.escapeQuotes(T.length==1?T[0]:T.join(", "))+"' } ",e.opts.messages!==!1&&(t+=" , message: 'should have ",T.length==1?t+="property "+e.util.escapeQuotes(T[0]):t+="properties "+e.util.escapeQuotes(T.join(", ")),t+=" when property "+e.util.escapeQuotes(R)+" is present' "),e.opts.verbose&&(t+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+h+" "),t+=" } "):t+=" {} ",t+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } "}}t+=" }   ",d&&(p+="}",t+=" else { ")}e.errorPath=C;var H=f.baseId;for(var R in g){var w=g[R];(e.opts.strictKeywords?typeof w=="object"&&Object.keys(w).length>0||w===!1:e.util.schemaHasRules(w,e.RULES.all))&&(t+=" "+y+" = true; if ( "+h+e.util.getProperty(R)+" !== undefined ",S&&(t+=" && Object.prototype.hasOwnProperty.call("+h+", '"+e.util.escapeQuotes(R)+"') "),t+=") { ",f.schema=w,f.schemaPath=l+e.util.getProperty(R),f.errSchemaPath=c+"/"+e.util.escapeFragment(R),t+="  "+e.validate(f)+" ",f.baseId=H,t+=" }  ",d&&(t+=" if ("+y+") { ",p+="}"))}return d&&(t+="   "+p+" if ("+v+" == errors) {"),t}});var _c=z((n_,yc)=>{"use strict";yc.exports=function(e,r,a){var t=" ",n=e.level,o=e.dataLevel,i=e.schema[r],l=e.schemaPath+e.util.getProperty(r),c=e.errSchemaPath+"/"+r,d=!e.opts.allErrors,h="data"+(o||""),v="valid"+n,f=e.opts.$data&&i&&i.$data,p;f?(t+=" var schema"+n+" = "+e.util.getData(i.$data,o,e.dataPathArr)+"; ",p="schema"+n):p=i;var y="i"+n,g="schema"+n;f||(t+=" var "+g+" = validate.schema"+l+";"),t+="var "+v+";",f&&(t+=" if (schema"+n+" === undefined) "+v+" = true; else if (!Array.isArray(schema"+n+")) "+v+" = false; else {"),t+=""+v+" = false;for (var "+y+"=0; "+y+"<"+g+".length; "+y+"++) if (equal("+h+", "+g+"["+y+"])) { "+v+" = true; break; }",f&&(t+="  }  "),t+=" if (!"+v+") {   ";var x=x||[];x.push(t),t="",e.createErrors!==!1?(t+=" { keyword: 'enum' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { allowedValues: schema"+n+" } ",e.opts.messages!==!1&&(t+=" , message: 'should be equal to one of the allowed values' "),e.opts.verbose&&(t+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+h+" "),t+=" } "):t+=" {} ";var S=t;return t=x.pop(),!e.compositeRule&&d?e.async?t+=" throw new ValidationError(["+S+"]); ":t+=" validate.errors = ["+S+"]; return false; ":t+=" var err = "+S+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",t+=" }",d&&(t+=" else { "),t}});var xc=z((i_,bc)=>{"use strict";bc.exports=function(e,r,a){var t=" ",n=e.level,o=e.dataLevel,i=e.schema[r],l=e.schemaPath+e.util.getProperty(r),c=e.errSchemaPath+"/"+r,d=!e.opts.allErrors,h="data"+(o||"");if(e.opts.format===!1)return d&&(t+=" if (true) { "),t;var v=e.opts.$data&&i&&i.$data,f;v?(t+=" var schema"+n+" = "+e.util.getData(i.$data,o,e.dataPathArr)+"; ",f="schema"+n):f=i;var p=e.opts.unknownFormats,y=Array.isArray(p);if(v){var g="format"+n,x="isObject"+n,S="formatType"+n;t+=" var "+g+" = formats["+f+"]; var "+x+" = typeof "+g+" == 'object' && !("+g+" instanceof RegExp) && "+g+".validate; var "+S+" = "+x+" && "+g+".type || 'string'; if ("+x+") { ",e.async&&(t+=" var async"+n+" = "+g+".async; "),t+=" "+g+" = "+g+".validate; } if (  ",v&&(t+=" ("+f+" !== undefined && typeof "+f+" != 'string') || "),t+=" (",p!="ignore"&&(t+=" ("+f+" && !"+g+" ",y&&(t+=" && self._opts.unknownFormats.indexOf("+f+") == -1 "),t+=") || "),t+=" ("+g+" && "+S+" == '"+a+"' && !(typeof "+g+" == 'function' ? ",e.async?t+=" (async"+n+" ? await "+g+"("+h+") : "+g+"("+h+")) ":t+=" "+g+"("+h+") ",t+=" : "+g+".test("+h+"))))) {"}else{var g=e.formats[i];if(!g){if(p=="ignore")return e.logger.warn('unknown format "'+i+'" ignored in schema at path "'+e.errSchemaPath+'"'),d&&(t+=" if (true) { "),t;if(y&&p.indexOf(i)>=0)return d&&(t+=" if (true) { "),t;throw new Error('unknown format "'+i+'" is used in schema at path "'+e.errSchemaPath+'"')}var x=typeof g=="object"&&!(g instanceof RegExp)&&g.validate,S=x&&g.type||"string";if(x){var w=g.async===!0;g=g.validate}if(S!=a)return d&&(t+=" if (true) { "),t;if(w){if(!e.async)throw new Error("async format in sync schema");var T="formats"+e.util.getProperty(i)+".validate";t+=" if (!(await "+T+"("+h+"))) { "}else{t+=" if (! ";var T="formats"+e.util.getProperty(i);x&&(T+=".validate"),typeof g=="function"?t+=" "+T+"("+h+") ":t+=" "+T+".test("+h+") ",t+=") { "}}var C=C||[];C.push(t),t="",e.createErrors!==!1?(t+=" { keyword: 'format' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { format:  ",v?t+=""+f:t+=""+e.util.toQuotedString(i),t+="  } ",e.opts.messages!==!1&&(t+=` , message: 'should match format "`,v?t+="' + "+f+" + '":t+=""+e.util.escapeQuotes(i),t+=`"' `),e.opts.verbose&&(t+=" , schema:  ",v?t+="validate.schema"+l:t+=""+e.util.toQuotedString(i),t+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+h+" "),t+=" } "):t+=" {} ";var R=t;return t=C.pop(),!e.compositeRule&&d?e.async?t+=" throw new ValidationError(["+R+"]); ":t+=" validate.errors = ["+R+"]; return false; ":t+=" var err = "+R+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",t+=" } ",d&&(t+=" else { "),t}});var Sc=z((o_,Ec)=>{"use strict";Ec.exports=function(e,r,a){var t=" ",n=e.level,o=e.dataLevel,i=e.schema[r],l=e.schemaPath+e.util.getProperty(r),c=e.errSchemaPath+"/"+r,d=!e.opts.allErrors,h="data"+(o||""),v="valid"+n,f="errs__"+n,p=e.util.copy(e);p.level++;var y="valid"+p.level,g=e.schema.then,x=e.schema.else,S=g!==void 0&&(e.opts.strictKeywords?typeof g=="object"&&Object.keys(g).length>0||g===!1:e.util.schemaHasRules(g,e.RULES.all)),w=x!==void 0&&(e.opts.strictKeywords?typeof x=="object"&&Object.keys(x).length>0||x===!1:e.util.schemaHasRules(x,e.RULES.all)),T=p.baseId;if(S||w){var C;p.createErrors=!1,p.schema=i,p.schemaPath=l,p.errSchemaPath=c,t+=" var "+f+" = errors; var "+v+" = true;  ";var R=e.compositeRule;e.compositeRule=p.compositeRule=!0,t+="  "+e.validate(p)+" ",p.baseId=T,p.createErrors=!0,t+="  errors = "+f+"; if (vErrors !== null) { if ("+f+") vErrors.length = "+f+"; else vErrors = null; }  ",e.compositeRule=p.compositeRule=R,S?(t+=" if ("+y+") {  ",p.schema=e.schema.then,p.schemaPath=e.schemaPath+".then",p.errSchemaPath=e.errSchemaPath+"/then",t+="  "+e.validate(p)+" ",p.baseId=T,t+=" "+v+" = "+y+"; ",S&&w?(C="ifClause"+n,t+=" var "+C+" = 'then'; "):C="'then'",t+=" } ",w&&(t+=" else { ")):t+=" if (!"+y+") { ",w&&(p.schema=e.schema.else,p.schemaPath=e.schemaPath+".else",p.errSchemaPath=e.errSchemaPath+"/else",t+="  "+e.validate(p)+" ",p.baseId=T,t+=" "+v+" = "+y+"; ",S&&w?(C="ifClause"+n,t+=" var "+C+" = 'else'; "):C="'else'",t+=" } "),t+=" if (!"+v+") {   var err =   ",e.createErrors!==!1?(t+=" { keyword: 'if' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { failingKeyword: "+C+" } ",e.opts.messages!==!1&&(t+=` , message: 'should match "' + `+C+` + '" schema' `),e.opts.verbose&&(t+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+h+" "),t+=" } "):t+=" {} ",t+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",!e.compositeRule&&d&&(e.async?t+=" throw new ValidationError(vErrors); ":t+=" validate.errors = vErrors; return false; "),t+=" }   ",d&&(t+=" else { ")}else d&&(t+=" if (true) { ");return t}});var wc=z((l_,Pc)=>{"use strict";Pc.exports=function(e,r,a){var t=" ",n=e.level,o=e.dataLevel,i=e.schema[r],l=e.schemaPath+e.util.getProperty(r),c=e.errSchemaPath+"/"+r,d=!e.opts.allErrors,h="data"+(o||""),v="valid"+n,f="errs__"+n,p=e.util.copy(e),y="";p.level++;var g="valid"+p.level,x="i"+n,S=p.dataLevel=e.dataLevel+1,w="data"+S,T=e.baseId;if(t+="var "+f+" = errors;var "+v+";",Array.isArray(i)){var C=e.schema.additionalItems;if(C===!1){t+=" "+v+" = "+h+".length <= "+i.length+"; ";var R=c;c=e.errSchemaPath+"/additionalItems",t+="  if (!"+v+") {   ";var L=L||[];L.push(t),t="",e.createErrors!==!1?(t+=" { keyword: 'additionalItems' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { limit: "+i.length+" } ",e.opts.messages!==!1&&(t+=" , message: 'should NOT have more than "+i.length+" items' "),e.opts.verbose&&(t+=" , schema: false , parentSchema: validate.schema"+e.schemaPath+" , data: "+h+" "),t+=" } "):t+=" {} ";var U=t;t=L.pop(),!e.compositeRule&&d?e.async?t+=" throw new ValidationError(["+U+"]); ":t+=" validate.errors = ["+U+"]; return false; ":t+=" var err = "+U+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",t+=" } ",c=R,d&&(y+="}",t+=" else { ")}var $=i;if($){for(var D,F=-1,q=$.length-1;F<q;)if(D=$[F+=1],e.opts.strictKeywords?typeof D=="object"&&Object.keys(D).length>0||D===!1:e.util.schemaHasRules(D,e.RULES.all)){t+=" "+g+" = true; if ("+h+".length > "+F+") { ";var I=h+"["+F+"]";p.schema=D,p.schemaPath=l+"["+F+"]",p.errSchemaPath=c+"/"+F,p.errorPath=e.util.getPathExpr(e.errorPath,F,e.opts.jsonPointers,!0),p.dataPathArr[S]=F;var A=e.validate(p);p.baseId=T,e.util.varOccurences(A,w)<2?t+=" "+e.util.varReplace(A,w,I)+" ":t+=" var "+w+" = "+I+"; "+A+" ",t+=" }  ",d&&(t+=" if ("+g+") { ",y+="}")}}if(typeof C=="object"&&(e.opts.strictKeywords?typeof C=="object"&&Object.keys(C).length>0||C===!1:e.util.schemaHasRules(C,e.RULES.all))){p.schema=C,p.schemaPath=e.schemaPath+".additionalItems",p.errSchemaPath=e.errSchemaPath+"/additionalItems",t+=" "+g+" = true; if ("+h+".length > "+i.length+") {  for (var "+x+" = "+i.length+"; "+x+" < "+h+".length; "+x+"++) { ",p.errorPath=e.util.getPathExpr(e.errorPath,x,e.opts.jsonPointers,!0);var I=h+"["+x+"]";p.dataPathArr[S]=x;var A=e.validate(p);p.baseId=T,e.util.varOccurences(A,w)<2?t+=" "+e.util.varReplace(A,w,I)+" ":t+=" var "+w+" = "+I+"; "+A+" ",d&&(t+=" if (!"+g+") break; "),t+=" } }  ",d&&(t+=" if ("+g+") { ",y+="}")}}else if(e.opts.strictKeywords?typeof i=="object"&&Object.keys(i).length>0||i===!1:e.util.schemaHasRules(i,e.RULES.all)){p.schema=i,p.schemaPath=l,p.errSchemaPath=c,t+="  for (var "+x+" = 0; "+x+" < "+h+".length; "+x+"++) { ",p.errorPath=e.util.getPathExpr(e.errorPath,x,e.opts.jsonPointers,!0);var I=h+"["+x+"]";p.dataPathArr[S]=x;var A=e.validate(p);p.baseId=T,e.util.varOccurences(A,w)<2?t+=" "+e.util.varReplace(A,w,I)+" ":t+=" var "+w+" = "+I+"; "+A+" ",d&&(t+=" if (!"+g+") break; "),t+=" }"}return d&&(t+=" "+y+" if ("+f+" == errors) {"),t}});var Nn=z((c_,Tc)=>{"use strict";Tc.exports=function(e,r,a){var t=" ",n=e.level,o=e.dataLevel,i=e.schema[r],l=e.schemaPath+e.util.getProperty(r),c=e.errSchemaPath+"/"+r,d=!e.opts.allErrors,T,h="data"+(o||""),v=e.opts.$data&&i&&i.$data,f;v?(t+=" var schema"+n+" = "+e.util.getData(i.$data,o,e.dataPathArr)+"; ",f="schema"+n):f=i;var p=r=="maximum",y=p?"exclusiveMaximum":"exclusiveMinimum",g=e.schema[y],x=e.opts.$data&&g&&g.$data,S=p?"<":">",w=p?">":"<",T=void 0;if(!(v||typeof i=="number"||i===void 0))throw new Error(r+" must be number");if(!(x||g===void 0||typeof g=="number"||typeof g=="boolean"))throw new Error(y+" must be number or boolean");if(x){var C=e.util.getData(g.$data,o,e.dataPathArr),R="exclusive"+n,L="exclType"+n,U="exclIsNumber"+n,$="op"+n,D="' + "+$+" + '";t+=" var schemaExcl"+n+" = "+C+"; ",C="schemaExcl"+n,t+=" var "+R+"; var "+L+" = typeof "+C+"; if ("+L+" != 'boolean' && "+L+" != 'undefined' && "+L+" != 'number') { ";var T=y,F=F||[];F.push(t),t="",e.createErrors!==!1?(t+=" { keyword: '"+(T||"_exclusiveLimit")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: {} ",e.opts.messages!==!1&&(t+=" , message: '"+y+" should be boolean' "),e.opts.verbose&&(t+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+h+" "),t+=" } "):t+=" {} ";var q=t;t=F.pop(),!e.compositeRule&&d?e.async?t+=" throw new ValidationError(["+q+"]); ":t+=" validate.errors = ["+q+"]; return false; ":t+=" var err = "+q+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",t+=" } else if ( ",v&&(t+=" ("+f+" !== undefined && typeof "+f+" != 'number') || "),t+=" "+L+" == 'number' ? ( ("+R+" = "+f+" === undefined || "+C+" "+S+"= "+f+") ? "+h+" "+w+"= "+C+" : "+h+" "+w+" "+f+" ) : ( ("+R+" = "+C+" === true) ? "+h+" "+w+"= "+f+" : "+h+" "+w+" "+f+" ) || "+h+" !== "+h+") { var op"+n+" = "+R+" ? '"+S+"' : '"+S+"='; ",i===void 0&&(T=y,c=e.errSchemaPath+"/"+y,f=C,v=x)}else{var U=typeof g=="number",D=S;if(U&&v){var $="'"+D+"'";t+=" if ( ",v&&(t+=" ("+f+" !== undefined && typeof "+f+" != 'number') || "),t+=" ( "+f+" === undefined || "+g+" "+S+"= "+f+" ? "+h+" "+w+"= "+g+" : "+h+" "+w+" "+f+" ) || "+h+" !== "+h+") { "}else{U&&i===void 0?(R=!0,T=y,c=e.errSchemaPath+"/"+y,f=g,w+="="):(U&&(f=Math[p?"min":"max"](g,i)),g===(U?f:!0)?(R=!0,T=y,c=e.errSchemaPath+"/"+y,w+="="):(R=!1,D+="="));var $="'"+D+"'";t+=" if ( ",v&&(t+=" ("+f+" !== undefined && typeof "+f+" != 'number') || "),t+=" "+h+" "+w+" "+f+" || "+h+" !== "+h+") { "}}T=T||r;var F=F||[];F.push(t),t="",e.createErrors!==!1?(t+=" { keyword: '"+(T||"_limit")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { comparison: "+$+", limit: "+f+", exclusive: "+R+" } ",e.opts.messages!==!1&&(t+=" , message: 'should be "+D+" ",v?t+="' + "+f:t+=""+f+"'"),e.opts.verbose&&(t+=" , schema:  ",v?t+="validate.schema"+l:t+=""+i,t+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+h+" "),t+=" } "):t+=" {} ";var q=t;return t=F.pop(),!e.compositeRule&&d?e.async?t+=" throw new ValidationError(["+q+"]); ":t+=" validate.errors = ["+q+"]; return false; ":t+=" var err = "+q+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",t+=" } ",d&&(t+=" else { "),t}});var Ln=z((u_,Cc)=>{"use strict";Cc.exports=function(e,r,a){var t=" ",n=e.level,o=e.dataLevel,i=e.schema[r],l=e.schemaPath+e.util.getProperty(r),c=e.errSchemaPath+"/"+r,d=!e.opts.allErrors,y,h="data"+(o||""),v=e.opts.$data&&i&&i.$data,f;if(v?(t+=" var schema"+n+" = "+e.util.getData(i.$data,o,e.dataPathArr)+"; ",f="schema"+n):f=i,!(v||typeof i=="number"))throw new Error(r+" must be number");var p=r=="maxItems"?">":"<";t+="if ( ",v&&(t+=" ("+f+" !== undefined && typeof "+f+" != 'number') || "),t+=" "+h+".length "+p+" "+f+") { ";var y=r,g=g||[];g.push(t),t="",e.createErrors!==!1?(t+=" { keyword: '"+(y||"_limitItems")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { limit: "+f+" } ",e.opts.messages!==!1&&(t+=" , message: 'should NOT have ",r=="maxItems"?t+="more":t+="fewer",t+=" than ",v?t+="' + "+f+" + '":t+=""+i,t+=" items' "),e.opts.verbose&&(t+=" , schema:  ",v?t+="validate.schema"+l:t+=""+i,t+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+h+" "),t+=" } "):t+=" {} ";var x=t;return t=g.pop(),!e.compositeRule&&d?e.async?t+=" throw new ValidationError(["+x+"]); ":t+=" validate.errors = ["+x+"]; return false; ":t+=" var err = "+x+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",t+="} ",d&&(t+=" else { "),t}});var Fn=z((d_,Rc)=>{"use strict";Rc.exports=function(e,r,a){var t=" ",n=e.level,o=e.dataLevel,i=e.schema[r],l=e.schemaPath+e.util.getProperty(r),c=e.errSchemaPath+"/"+r,d=!e.opts.allErrors,y,h="data"+(o||""),v=e.opts.$data&&i&&i.$data,f;if(v?(t+=" var schema"+n+" = "+e.util.getData(i.$data,o,e.dataPathArr)+"; ",f="schema"+n):f=i,!(v||typeof i=="number"))throw new Error(r+" must be number");var p=r=="maxLength"?">":"<";t+="if ( ",v&&(t+=" ("+f+" !== undefined && typeof "+f+" != 'number') || "),e.opts.unicode===!1?t+=" "+h+".length ":t+=" ucs2length("+h+") ",t+=" "+p+" "+f+") { ";var y=r,g=g||[];g.push(t),t="",e.createErrors!==!1?(t+=" { keyword: '"+(y||"_limitLength")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { limit: "+f+" } ",e.opts.messages!==!1&&(t+=" , message: 'should NOT be ",r=="maxLength"?t+="longer":t+="shorter",t+=" than ",v?t+="' + "+f+" + '":t+=""+i,t+=" characters' "),e.opts.verbose&&(t+=" , schema:  ",v?t+="validate.schema"+l:t+=""+i,t+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+h+" "),t+=" } "):t+=" {} ";var x=t;return t=g.pop(),!e.compositeRule&&d?e.async?t+=" throw new ValidationError(["+x+"]); ":t+=" validate.errors = ["+x+"]; return false; ":t+=" var err = "+x+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",t+="} ",d&&(t+=" else { "),t}});var jn=z((f_,kc)=>{"use strict";kc.exports=function(e,r,a){var t=" ",n=e.level,o=e.dataLevel,i=e.schema[r],l=e.schemaPath+e.util.getProperty(r),c=e.errSchemaPath+"/"+r,d=!e.opts.allErrors,y,h="data"+(o||""),v=e.opts.$data&&i&&i.$data,f;if(v?(t+=" var schema"+n+" = "+e.util.getData(i.$data,o,e.dataPathArr)+"; ",f="schema"+n):f=i,!(v||typeof i=="number"))throw new Error(r+" must be number");var p=r=="maxProperties"?">":"<";t+="if ( ",v&&(t+=" ("+f+" !== undefined && typeof "+f+" != 'number') || "),t+=" Object.keys("+h+").length "+p+" "+f+") { ";var y=r,g=g||[];g.push(t),t="",e.createErrors!==!1?(t+=" { keyword: '"+(y||"_limitProperties")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { limit: "+f+" } ",e.opts.messages!==!1&&(t+=" , message: 'should NOT have ",r=="maxProperties"?t+="more":t+="fewer",t+=" than ",v?t+="' + "+f+" + '":t+=""+i,t+=" properties' "),e.opts.verbose&&(t+=" , schema:  ",v?t+="validate.schema"+l:t+=""+i,t+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+h+" "),t+=" } "):t+=" {} ";var x=t;return t=g.pop(),!e.compositeRule&&d?e.async?t+=" throw new ValidationError(["+x+"]); ":t+=" validate.errors = ["+x+"]; return false; ":t+=" var err = "+x+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",t+="} ",d&&(t+=" else { "),t}});var Dc=z((h_,Oc)=>{"use strict";Oc.exports=function(e,r,a){var t=" ",n=e.level,o=e.dataLevel,i=e.schema[r],l=e.schemaPath+e.util.getProperty(r),c=e.errSchemaPath+"/"+r,d=!e.opts.allErrors,h="data"+(o||""),v=e.opts.$data&&i&&i.$data,f;if(v?(t+=" var schema"+n+" = "+e.util.getData(i.$data,o,e.dataPathArr)+"; ",f="schema"+n):f=i,!(v||typeof i=="number"))throw new Error(r+" must be number");t+="var division"+n+";if (",v&&(t+=" "+f+" !== undefined && ( typeof "+f+" != 'number' || "),t+=" (division"+n+" = "+h+" / "+f+", ",e.opts.multipleOfPrecision?t+=" Math.abs(Math.round(division"+n+") - division"+n+") > 1e-"+e.opts.multipleOfPrecision+" ":t+=" division"+n+" !== parseInt(division"+n+") ",t+=" ) ",v&&(t+="  )  "),t+=" ) {   ";var p=p||[];p.push(t),t="",e.createErrors!==!1?(t+=" { keyword: 'multipleOf' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { multipleOf: "+f+" } ",e.opts.messages!==!1&&(t+=" , message: 'should be multiple of ",v?t+="' + "+f:t+=""+f+"'"),e.opts.verbose&&(t+=" , schema:  ",v?t+="validate.schema"+l:t+=""+i,t+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+h+" "),t+=" } "):t+=" {} ";var y=t;return t=p.pop(),!e.compositeRule&&d?e.async?t+=" throw new ValidationError(["+y+"]); ":t+=" validate.errors = ["+y+"]; return false; ":t+=" var err = "+y+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",t+="} ",d&&(t+=" else { "),t}});var Ic=z((p_,$c)=>{"use strict";$c.exports=function(e,r,a){var t=" ",n=e.level,o=e.dataLevel,i=e.schema[r],l=e.schemaPath+e.util.getProperty(r),c=e.errSchemaPath+"/"+r,d=!e.opts.allErrors,h="data"+(o||""),v="errs__"+n,f=e.util.copy(e);f.level++;var p="valid"+f.level;if(e.opts.strictKeywords?typeof i=="object"&&Object.keys(i).length>0||i===!1:e.util.schemaHasRules(i,e.RULES.all)){f.schema=i,f.schemaPath=l,f.errSchemaPath=c,t+=" var "+v+" = errors;  ";var y=e.compositeRule;e.compositeRule=f.compositeRule=!0,f.createErrors=!1;var g;f.opts.allErrors&&(g=f.opts.allErrors,f.opts.allErrors=!1),t+=" "+e.validate(f)+" ",f.createErrors=!0,g&&(f.opts.allErrors=g),e.compositeRule=f.compositeRule=y,t+=" if ("+p+") {   ";var x=x||[];x.push(t),t="",e.createErrors!==!1?(t+=" { keyword: 'not' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: {} ",e.opts.messages!==!1&&(t+=" , message: 'should NOT be valid' "),e.opts.verbose&&(t+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+h+" "),t+=" } "):t+=" {} ";var S=t;t=x.pop(),!e.compositeRule&&d?e.async?t+=" throw new ValidationError(["+S+"]); ":t+=" validate.errors = ["+S+"]; return false; ":t+=" var err = "+S+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",t+=" } else {  errors = "+v+"; if (vErrors !== null) { if ("+v+") vErrors.length = "+v+"; else vErrors = null; } ",e.opts.allErrors&&(t+=" } ")}else t+="  var err =   ",e.createErrors!==!1?(t+=" { keyword: 'not' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: {} ",e.opts.messages!==!1&&(t+=" , message: 'should NOT be valid' "),e.opts.verbose&&(t+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+h+" "),t+=" } "):t+=" {} ",t+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",d&&(t+=" if (false) { ");return t}});var Nc=z((m_,Ac)=>{"use strict";Ac.exports=function(e,r,a){var t=" ",n=e.level,o=e.dataLevel,i=e.schema[r],l=e.schemaPath+e.util.getProperty(r),c=e.errSchemaPath+"/"+r,d=!e.opts.allErrors,h="data"+(o||""),v="valid"+n,f="errs__"+n,p=e.util.copy(e),y="";p.level++;var g="valid"+p.level,x=p.baseId,S="prevValid"+n,w="passingSchemas"+n;t+="var "+f+" = errors , "+S+" = false , "+v+" = false , "+w+" = null; ";var T=e.compositeRule;e.compositeRule=p.compositeRule=!0;var C=i;if(C)for(var R,L=-1,U=C.length-1;L<U;)R=C[L+=1],(e.opts.strictKeywords?typeof R=="object"&&Object.keys(R).length>0||R===!1:e.util.schemaHasRules(R,e.RULES.all))?(p.schema=R,p.schemaPath=l+"["+L+"]",p.errSchemaPath=c+"/"+L,t+="  "+e.validate(p)+" ",p.baseId=x):t+=" var "+g+" = true; ",L&&(t+=" if ("+g+" && "+S+") { "+v+" = false; "+w+" = ["+w+", "+L+"]; } else { ",y+="}"),t+=" if ("+g+") { "+v+" = "+S+" = true; "+w+" = "+L+"; }";return e.compositeRule=p.compositeRule=T,t+=""+y+"if (!"+v+") {   var err =   ",e.createErrors!==!1?(t+=" { keyword: 'oneOf' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { passingSchemas: "+w+" } ",e.opts.messages!==!1&&(t+=" , message: 'should match exactly one schema in oneOf' "),e.opts.verbose&&(t+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+h+" "),t+=" } "):t+=" {} ",t+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",!e.compositeRule&&d&&(e.async?t+=" throw new ValidationError(vErrors); ":t+=" validate.errors = vErrors; return false; "),t+="} else {  errors = "+f+"; if (vErrors !== null) { if ("+f+") vErrors.length = "+f+"; else vErrors = null; }",e.opts.allErrors&&(t+=" } "),t}});var Fc=z((v_,Lc)=>{"use strict";Lc.exports=function(e,r,a){var t=" ",n=e.level,o=e.dataLevel,i=e.schema[r],l=e.schemaPath+e.util.getProperty(r),c=e.errSchemaPath+"/"+r,d=!e.opts.allErrors,h="data"+(o||""),v=e.opts.$data&&i&&i.$data,f;v?(t+=" var schema"+n+" = "+e.util.getData(i.$data,o,e.dataPathArr)+"; ",f="schema"+n):f=i;var p=v?"(new RegExp("+f+"))":e.usePattern(i);t+="if ( ",v&&(t+=" ("+f+" !== undefined && typeof "+f+" != 'string') || "),t+=" !"+p+".test("+h+") ) {   ";var y=y||[];y.push(t),t="",e.createErrors!==!1?(t+=" { keyword: 'pattern' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { pattern:  ",v?t+=""+f:t+=""+e.util.toQuotedString(i),t+="  } ",e.opts.messages!==!1&&(t+=` , message: 'should match pattern "`,v?t+="' + "+f+" + '":t+=""+e.util.escapeQuotes(i),t+=`"' `),e.opts.verbose&&(t+=" , schema:  ",v?t+="validate.schema"+l:t+=""+e.util.toQuotedString(i),t+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+h+" "),t+=" } "):t+=" {} ";var g=t;return t=y.pop(),!e.compositeRule&&d?e.async?t+=" throw new ValidationError(["+g+"]); ":t+=" validate.errors = ["+g+"]; return false; ":t+=" var err = "+g+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",t+="} ",d&&(t+=" else { "),t}});var Mc=z((g_,jc)=>{"use strict";jc.exports=function(e,r,a){var t=" ",n=e.level,o=e.dataLevel,i=e.schema[r],l=e.schemaPath+e.util.getProperty(r),c=e.errSchemaPath+"/"+r,d=!e.opts.allErrors,h="data"+(o||""),v="errs__"+n,f=e.util.copy(e),p="";f.level++;var y="valid"+f.level,g="key"+n,x="idx"+n,S=f.dataLevel=e.dataLevel+1,w="data"+S,T="dataProperties"+n,C=Object.keys(i||{}).filter(se),R=e.schema.patternProperties||{},L=Object.keys(R).filter(se),U=e.schema.additionalProperties,$=C.length||L.length,D=U===!1,F=typeof U=="object"&&Object.keys(U).length,q=e.opts.removeAdditional,I=D||F||q,A=e.opts.ownProperties,V=e.baseId,ue=e.schema.required;if(ue&&!(e.opts.$data&&ue.$data)&&ue.length<e.opts.loopRequired)var ee=e.util.toHash(ue);function se(ot){return ot!=="__proto__"}if(t+="var "+v+" = errors;var "+y+" = true;",A&&(t+=" var "+T+" = undefined;"),I){if(A?t+=" "+T+" = "+T+" || Object.keys("+h+"); for (var "+x+"=0; "+x+"<"+T+".length; "+x+"++) { var "+g+" = "+T+"["+x+"]; ":t+=" for (var "+g+" in "+h+") { ",$){if(t+=" var isAdditional"+n+" = !(false ",C.length)if(C.length>8)t+=" || validate.schema"+l+".hasOwnProperty("+g+") ";else{var X=C;if(X)for(var H,xe=-1,Ae=X.length-1;xe<Ae;)H=X[xe+=1],t+=" || "+g+" == "+e.util.toQuotedString(H)+" "}if(L.length){var Fe=L;if(Fe)for(var ie,we=-1,ke=Fe.length-1;we<ke;)ie=Fe[we+=1],t+=" || "+e.usePattern(ie)+".test("+g+") "}t+=" ); if (isAdditional"+n+") { "}if(q=="all")t+=" delete "+h+"["+g+"]; ";else{var je=e.errorPath,Mt="' + "+g+" + '";if(e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPathExpr(e.errorPath,g,e.opts.jsonPointers)),D)if(q)t+=" delete "+h+"["+g+"]; ";else{t+=" "+y+" = false; ";var Pt=c;c=e.errSchemaPath+"/additionalProperties";var Te=Te||[];Te.push(t),t="",e.createErrors!==!1?(t+=" { keyword: 'additionalProperties' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { additionalProperty: '"+Mt+"' } ",e.opts.messages!==!1&&(t+=" , message: '",e.opts._errorDataPathProperty?t+="is an invalid additional property":t+="should NOT have additional properties",t+="' "),e.opts.verbose&&(t+=" , schema: false , parentSchema: validate.schema"+e.schemaPath+" , data: "+h+" "),t+=" } "):t+=" {} ";var Ee=t;t=Te.pop(),!e.compositeRule&&d?e.async?t+=" throw new ValidationError(["+Ee+"]); ":t+=" validate.errors = ["+Ee+"]; return false; ":t+=" var err = "+Ee+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",c=Pt,d&&(t+=" break; ")}else if(F)if(q=="failing"){t+=" var "+v+" = errors;  ";var dr=e.compositeRule;e.compositeRule=f.compositeRule=!0,f.schema=U,f.schemaPath=e.schemaPath+".additionalProperties",f.errSchemaPath=e.errSchemaPath+"/additionalProperties",f.errorPath=e.opts._errorDataPathProperty?e.errorPath:e.util.getPathExpr(e.errorPath,g,e.opts.jsonPointers);var Ne=h+"["+g+"]";f.dataPathArr[S]=g;var le=e.validate(f);f.baseId=V,e.util.varOccurences(le,w)<2?t+=" "+e.util.varReplace(le,w,Ne)+" ":t+=" var "+w+" = "+Ne+"; "+le+" ",t+=" if (!"+y+") { errors = "+v+"; if (validate.errors !== null) { if (errors) validate.errors.length = errors; else validate.errors = null; } delete "+h+"["+g+"]; }  ",e.compositeRule=f.compositeRule=dr}else{f.schema=U,f.schemaPath=e.schemaPath+".additionalProperties",f.errSchemaPath=e.errSchemaPath+"/additionalProperties",f.errorPath=e.opts._errorDataPathProperty?e.errorPath:e.util.getPathExpr(e.errorPath,g,e.opts.jsonPointers);var Ne=h+"["+g+"]";f.dataPathArr[S]=g;var le=e.validate(f);f.baseId=V,e.util.varOccurences(le,w)<2?t+=" "+e.util.varReplace(le,w,Ne)+" ":t+=" var "+w+" = "+Ne+"; "+le+" ",d&&(t+=" if (!"+y+") break; ")}e.errorPath=je}$&&(t+=" } "),t+=" }  ",d&&(t+=" if ("+y+") { ",p+="}")}var Ut=e.opts.useDefaults&&!e.compositeRule;if(C.length){var wt=C;if(wt)for(var H,fr=-1,hr=wt.length-1;fr<hr;){H=wt[fr+=1];var $e=i[H];if(e.opts.strictKeywords?typeof $e=="object"&&Object.keys($e).length>0||$e===!1:e.util.schemaHasRules($e,e.RULES.all)){var Ye=e.util.getProperty(H),Ne=h+Ye,Be=Ut&&$e.default!==void 0;f.schema=$e,f.schemaPath=l+Ye,f.errSchemaPath=c+"/"+e.util.escapeFragment(H),f.errorPath=e.util.getPath(e.errorPath,H,e.opts.jsonPointers),f.dataPathArr[S]=e.util.toQuotedString(H);var le=e.validate(f);if(f.baseId=V,e.util.varOccurences(le,w)<2){le=e.util.varReplace(le,w,Ne);var Me=Ne}else{var Me=w;t+=" var "+w+" = "+Ne+"; "}if(Be)t+=" "+le+" ";else{if(ee&&ee[H]){t+=" if ( "+Me+" === undefined ",A&&(t+=" || ! Object.prototype.hasOwnProperty.call("+h+", '"+e.util.escapeQuotes(H)+"') "),t+=") { "+y+" = false; ";var je=e.errorPath,Pt=c,mt=e.util.escapeQuotes(H);e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPath(je,H,e.opts.jsonPointers)),c=e.errSchemaPath+"/required";var Te=Te||[];Te.push(t),t="",e.createErrors!==!1?(t+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { missingProperty: '"+mt+"' } ",e.opts.messages!==!1&&(t+=" , message: '",e.opts._errorDataPathProperty?t+="is a required property":t+="should have required property \\'"+mt+"\\'",t+="' "),e.opts.verbose&&(t+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+h+" "),t+=" } "):t+=" {} ";var Ee=t;t=Te.pop(),!e.compositeRule&&d?e.async?t+=" throw new ValidationError(["+Ee+"]); ":t+=" validate.errors = ["+Ee+"]; return false; ":t+=" var err = "+Ee+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",c=Pt,e.errorPath=je,t+=" } else { "}else d?(t+=" if ( "+Me+" === undefined ",A&&(t+=" || ! Object.prototype.hasOwnProperty.call("+h+", '"+e.util.escapeQuotes(H)+"') "),t+=") { "+y+" = true; } else { "):(t+=" if ("+Me+" !== undefined ",A&&(t+=" &&   Object.prototype.hasOwnProperty.call("+h+", '"+e.util.escapeQuotes(H)+"') "),t+=" ) { ");t+=" "+le+" } "}}d&&(t+=" if ("+y+") { ",p+="}")}}if(L.length){var Ge=L;if(Ge)for(var ie,Rs=-1,Ga=Ge.length-1;Rs<Ga;){ie=Ge[Rs+=1];var $e=R[ie];if(e.opts.strictKeywords?typeof $e=="object"&&Object.keys($e).length>0||$e===!1:e.util.schemaHasRules($e,e.RULES.all)){f.schema=$e,f.schemaPath=e.schemaPath+".patternProperties"+e.util.getProperty(ie),f.errSchemaPath=e.errSchemaPath+"/patternProperties/"+e.util.escapeFragment(ie),A?t+=" "+T+" = "+T+" || Object.keys("+h+"); for (var "+x+"=0; "+x+"<"+T+".length; "+x+"++) { var "+g+" = "+T+"["+x+"]; ":t+=" for (var "+g+" in "+h+") { ",t+=" if ("+e.usePattern(ie)+".test("+g+")) { ",f.errorPath=e.util.getPathExpr(e.errorPath,g,e.opts.jsonPointers);var Ne=h+"["+g+"]";f.dataPathArr[S]=g;var le=e.validate(f);f.baseId=V,e.util.varOccurences(le,w)<2?t+=" "+e.util.varReplace(le,w,Ne)+" ":t+=" var "+w+" = "+Ne+"; "+le+" ",d&&(t+=" if (!"+y+") break; "),t+=" } ",d&&(t+=" else "+y+" = true; "),t+=" }  ",d&&(t+=" if ("+y+") { ",p+="}")}}}return d&&(t+=" "+p+" if ("+v+" == errors) {"),t}});var qc=z((y_,Uc)=>{"use strict";Uc.exports=function(e,r,a){var t=" ",n=e.level,o=e.dataLevel,i=e.schema[r],l=e.schemaPath+e.util.getProperty(r),c=e.errSchemaPath+"/"+r,d=!e.opts.allErrors,h="data"+(o||""),v="errs__"+n,f=e.util.copy(e),p="";f.level++;var y="valid"+f.level;if(t+="var "+v+" = errors;",e.opts.strictKeywords?typeof i=="object"&&Object.keys(i).length>0||i===!1:e.util.schemaHasRules(i,e.RULES.all)){f.schema=i,f.schemaPath=l,f.errSchemaPath=c;var g="key"+n,x="idx"+n,S="i"+n,w="' + "+g+" + '",T=f.dataLevel=e.dataLevel+1,C="data"+T,R="dataProperties"+n,L=e.opts.ownProperties,U=e.baseId;L&&(t+=" var "+R+" = undefined; "),L?t+=" "+R+" = "+R+" || Object.keys("+h+"); for (var "+x+"=0; "+x+"<"+R+".length; "+x+"++) { var "+g+" = "+R+"["+x+"]; ":t+=" for (var "+g+" in "+h+") { ",t+=" var startErrs"+n+" = errors; ";var $=g,D=e.compositeRule;e.compositeRule=f.compositeRule=!0;var F=e.validate(f);f.baseId=U,e.util.varOccurences(F,C)<2?t+=" "+e.util.varReplace(F,C,$)+" ":t+=" var "+C+" = "+$+"; "+F+" ",e.compositeRule=f.compositeRule=D,t+=" if (!"+y+") { for (var "+S+"=startErrs"+n+"; "+S+"<errors; "+S+"++) { vErrors["+S+"].propertyName = "+g+"; }   var err =   ",e.createErrors!==!1?(t+=" { keyword: 'propertyNames' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { propertyName: '"+w+"' } ",e.opts.messages!==!1&&(t+=" , message: 'property name \\'"+w+"\\' is invalid' "),e.opts.verbose&&(t+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+h+" "),t+=" } "):t+=" {} ",t+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",!e.compositeRule&&d&&(e.async?t+=" throw new ValidationError(vErrors); ":t+=" validate.errors = vErrors; return false; "),d&&(t+=" break; "),t+=" } }"}return d&&(t+=" "+p+" if ("+v+" == errors) {"),t}});var zc=z((__,Vc)=>{"use strict";Vc.exports=function(e,r,a){var t=" ",n=e.level,o=e.dataLevel,i=e.schema[r],l=e.schemaPath+e.util.getProperty(r),c=e.errSchemaPath+"/"+r,d=!e.opts.allErrors,h="data"+(o||""),v="valid"+n,f=e.opts.$data&&i&&i.$data,p;f?(t+=" var schema"+n+" = "+e.util.getData(i.$data,o,e.dataPathArr)+"; ",p="schema"+n):p=i;var y="schema"+n;if(!f)if(i.length<e.opts.loopRequired&&e.schema.properties&&Object.keys(e.schema.properties).length){var g=[],x=i;if(x)for(var S,w=-1,T=x.length-1;w<T;){S=x[w+=1];var C=e.schema.properties[S];C&&(e.opts.strictKeywords?typeof C=="object"&&Object.keys(C).length>0||C===!1:e.util.schemaHasRules(C,e.RULES.all))||(g[g.length]=S)}}else var g=i;if(f||g.length){var R=e.errorPath,L=f||g.length>=e.opts.loopRequired,U=e.opts.ownProperties;if(d)if(t+=" var missing"+n+"; ",L){f||(t+=" var "+y+" = validate.schema"+l+"; ");var $="i"+n,D="schema"+n+"["+$+"]",F="' + "+D+" + '";e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPathExpr(R,D,e.opts.jsonPointers)),t+=" var "+v+" = true; ",f&&(t+=" if (schema"+n+" === undefined) "+v+" = true; else if (!Array.isArray(schema"+n+")) "+v+" = false; else {"),t+=" for (var "+$+" = 0; "+$+" < "+y+".length; "+$+"++) { "+v+" = "+h+"["+y+"["+$+"]] !== undefined ",U&&(t+=" &&   Object.prototype.hasOwnProperty.call("+h+", "+y+"["+$+"]) "),t+="; if (!"+v+") break; } ",f&&(t+="  }  "),t+="  if (!"+v+") {   ";var q=q||[];q.push(t),t="",e.createErrors!==!1?(t+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { missingProperty: '"+F+"' } ",e.opts.messages!==!1&&(t+=" , message: '",e.opts._errorDataPathProperty?t+="is a required property":t+="should have required property \\'"+F+"\\'",t+="' "),e.opts.verbose&&(t+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+h+" "),t+=" } "):t+=" {} ";var I=t;t=q.pop(),!e.compositeRule&&d?e.async?t+=" throw new ValidationError(["+I+"]); ":t+=" validate.errors = ["+I+"]; return false; ":t+=" var err = "+I+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",t+=" } else { "}else{t+=" if ( ";var A=g;if(A)for(var V,$=-1,ue=A.length-1;$<ue;){V=A[$+=1],$&&(t+=" || ");var ee=e.util.getProperty(V),se=h+ee;t+=" ( ( "+se+" === undefined ",U&&(t+=" || ! Object.prototype.hasOwnProperty.call("+h+", '"+e.util.escapeQuotes(V)+"') "),t+=") && (missing"+n+" = "+e.util.toQuotedString(e.opts.jsonPointers?V:ee)+") ) "}t+=") {  ";var D="missing"+n,F="' + "+D+" + '";e.opts._errorDataPathProperty&&(e.errorPath=e.opts.jsonPointers?e.util.getPathExpr(R,D,!0):R+" + "+D);var q=q||[];q.push(t),t="",e.createErrors!==!1?(t+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { missingProperty: '"+F+"' } ",e.opts.messages!==!1&&(t+=" , message: '",e.opts._errorDataPathProperty?t+="is a required property":t+="should have required property \\'"+F+"\\'",t+="' "),e.opts.verbose&&(t+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+h+" "),t+=" } "):t+=" {} ";var I=t;t=q.pop(),!e.compositeRule&&d?e.async?t+=" throw new ValidationError(["+I+"]); ":t+=" validate.errors = ["+I+"]; return false; ":t+=" var err = "+I+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",t+=" } else { "}else if(L){f||(t+=" var "+y+" = validate.schema"+l+"; ");var $="i"+n,D="schema"+n+"["+$+"]",F="' + "+D+" + '";e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPathExpr(R,D,e.opts.jsonPointers)),f&&(t+=" if ("+y+" && !Array.isArray("+y+")) {  var err =   ",e.createErrors!==!1?(t+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { missingProperty: '"+F+"' } ",e.opts.messages!==!1&&(t+=" , message: '",e.opts._errorDataPathProperty?t+="is a required property":t+="should have required property \\'"+F+"\\'",t+="' "),e.opts.verbose&&(t+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+h+" "),t+=" } "):t+=" {} ",t+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } else if ("+y+" !== undefined) { "),t+=" for (var "+$+" = 0; "+$+" < "+y+".length; "+$+"++) { if ("+h+"["+y+"["+$+"]] === undefined ",U&&(t+=" || ! Object.prototype.hasOwnProperty.call("+h+", "+y+"["+$+"]) "),t+=") {  var err =   ",e.createErrors!==!1?(t+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { missingProperty: '"+F+"' } ",e.opts.messages!==!1&&(t+=" , message: '",e.opts._errorDataPathProperty?t+="is a required property":t+="should have required property \\'"+F+"\\'",t+="' "),e.opts.verbose&&(t+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+h+" "),t+=" } "):t+=" {} ",t+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } } ",f&&(t+="  }  ")}else{var X=g;if(X)for(var V,H=-1,xe=X.length-1;H<xe;){V=X[H+=1];var ee=e.util.getProperty(V),F=e.util.escapeQuotes(V),se=h+ee;e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPath(R,V,e.opts.jsonPointers)),t+=" if ( "+se+" === undefined ",U&&(t+=" || ! Object.prototype.hasOwnProperty.call("+h+", '"+e.util.escapeQuotes(V)+"') "),t+=") {  var err =   ",e.createErrors!==!1?(t+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { missingProperty: '"+F+"' } ",e.opts.messages!==!1&&(t+=" , message: '",e.opts._errorDataPathProperty?t+="is a required property":t+="should have required property \\'"+F+"\\'",t+="' "),e.opts.verbose&&(t+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+h+" "),t+=" } "):t+=" {} ",t+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } "}}e.errorPath=R}else d&&(t+=" if (true) {");return t}});var Hc=z((b_,Bc)=>{"use strict";Bc.exports=function(e,r,a){var t=" ",n=e.level,o=e.dataLevel,i=e.schema[r],l=e.schemaPath+e.util.getProperty(r),c=e.errSchemaPath+"/"+r,d=!e.opts.allErrors,h="data"+(o||""),v="valid"+n,f=e.opts.$data&&i&&i.$data,p;if(f?(t+=" var schema"+n+" = "+e.util.getData(i.$data,o,e.dataPathArr)+"; ",p="schema"+n):p=i,(i||f)&&e.opts.uniqueItems!==!1){f&&(t+=" var "+v+"; if ("+p+" === false || "+p+" === undefined) "+v+" = true; else if (typeof "+p+" != 'boolean') "+v+" = false; else { "),t+=" var i = "+h+".length , "+v+" = true , j; if (i > 1) { ";var y=e.schema.items&&e.schema.items.type,g=Array.isArray(y);if(!y||y=="object"||y=="array"||g&&(y.indexOf("object")>=0||y.indexOf("array")>=0))t+=" outer: for (;i--;) { for (j = i; j--;) { if (equal("+h+"[i], "+h+"[j])) { "+v+" = false; break outer; } } } ";else{t+=" var itemIndices = {}, item; for (;i--;) { var item = "+h+"[i]; ";var x="checkDataType"+(g?"s":"");t+=" if ("+e.util[x](y,"item",e.opts.strictNumbers,!0)+") continue; ",g&&(t+=` if (typeof item == 'string') item = '"' + item; `),t+=" if (typeof itemIndices[item] == 'number') { "+v+" = false; j = itemIndices[item]; break; } itemIndices[item] = i; } "}t+=" } ",f&&(t+="  }  "),t+=" if (!"+v+") {   ";var S=S||[];S.push(t),t="",e.createErrors!==!1?(t+=" { keyword: 'uniqueItems' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { i: i, j: j } ",e.opts.messages!==!1&&(t+=" , message: 'should NOT have duplicate items (items ## ' + j + ' and ' + i + ' are identical)' "),e.opts.verbose&&(t+=" , schema:  ",f?t+="validate.schema"+l:t+=""+i,t+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+h+" "),t+=" } "):t+=" {} ";var w=t;t=S.pop(),!e.compositeRule&&d?e.async?t+=" throw new ValidationError(["+w+"]); ":t+=" validate.errors = ["+w+"]; return false; ":t+=" var err = "+w+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",t+=" } ",d&&(t+=" else { ")}else d&&(t+=" if (true) { ");return t}});var Wc=z((x_,Zc)=>{"use strict";Zc.exports={$ref:nc(),allOf:oc(),anyOf:cc(),$comment:dc(),const:hc(),contains:mc(),dependencies:gc(),enum:_c(),format:xc(),if:Sc(),items:wc(),maximum:Nn(),minimum:Nn(),maxItems:Ln(),minItems:Ln(),maxLength:Fn(),minLength:Fn(),maxProperties:jn(),minProperties:jn(),multipleOf:Dc(),not:Ic(),oneOf:Nc(),pattern:Fc(),properties:Mc(),propertyNames:qc(),required:zc(),uniqueItems:Hc(),validate:In()}});var Jc=z((E_,Qc)=>{"use strict";var Gc=Wc(),Mn=Tr().toHash;Qc.exports=function(){var e=[{type:"number",rules:[{maximum:["exclusiveMaximum"]},{minimum:["exclusiveMinimum"]},"multipleOf","format"]},{type:"string",rules:["maxLength","minLength","pattern","format"]},{type:"array",rules:["maxItems","minItems","items","contains","uniqueItems"]},{type:"object",rules:["maxProperties","minProperties","required","dependencies","propertyNames",{properties:["additionalProperties","patternProperties"]}]},{rules:["$ref","const","enum","not","anyOf","oneOf","allOf","if"]}],r=["type","$comment"],a=["$schema","$id","id","$data","$async","title","description","default","definitions","examples","readOnly","writeOnly","contentMediaType","contentEncoding","additionalItems","then","else"],t=["number","integer","string","array","object","boolean","null"];return e.all=Mn(r),e.types=Mn(t),e.forEach(function(n){n.rules=n.rules.map(function(o){var i;if(typeof o=="object"){var l=Object.keys(o)[0];i=o[l],o=l,i.forEach(function(d){r.push(d),e.all[d]=!0})}r.push(o);var c=e.all[o]={keyword:o,code:Gc[o],implements:i};return c}),e.all.$comment={keyword:"$comment",code:Gc.$comment},n.type&&(e.types[n.type]=n)}),e.keywords=Mn(r.concat(a)),e.custom={},e}});var Xc=z((S_,Yc)=>{"use strict";var Kc=["multipleOf","maximum","exclusiveMaximum","minimum","exclusiveMinimum","maxLength","minLength","pattern","additionalItems","maxItems","minItems","uniqueItems","maxProperties","minProperties","required","additionalProperties","enum","format","const"];Yc.exports=function(s,e){for(var r=0;r<e.length;r++){s=JSON.parse(JSON.stringify(s));var a=e[r].split("/"),t=s,n;for(n=1;n<a.length;n++)t=t[a[n]];for(n=0;n<Kc.length;n++){var o=Kc[n],i=t[o];i&&(t[o]={anyOf:[i,{$ref:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#"}]})}}return s}});var ru=z((P_,tu)=>{"use strict";var Om=ha().MissingRef;tu.exports=eu;function eu(s,e,r){var a=this;if(typeof this._opts.loadSchema!="function")throw new Error("options.loadSchema should be a function");typeof e=="function"&&(r=e,e=void 0);var t=n(s).then(function(){var i=a._addSchema(s,void 0,e);return i.validate||o(i)});return r&&t.then(function(i){r(null,i)},r),t;function n(i){var l=i.$schema;return l&&!a.getSchema(l)?eu.call(a,{$ref:l},!0):Promise.resolve()}function o(i){try{return a._compile(i)}catch(c){if(c instanceof Om)return l(c);throw c}function l(c){var d=c.missingSchema;if(f(d))throw new Error("Schema "+d+" is loaded but "+c.missingRef+" cannot be resolved");var h=a._loadingSchemas[d];return h||(h=a._loadingSchemas[d]=a._opts.loadSchema(d),h.then(v,v)),h.then(function(p){if(!f(d))return n(p).then(function(){f(d)||a.addSchema(p,d,void 0,e)})}).then(function(){return o(i)});function v(){delete a._loadingSchemas[d]}function f(p){return a._refs[p]||a._schemas[p]}}}}});var au=z((w_,su)=>{"use strict";su.exports=function(e,r,a){var t=" ",n=e.level,o=e.dataLevel,i=e.schema[r],l=e.schemaPath+e.util.getProperty(r),c=e.errSchemaPath+"/"+r,d=!e.opts.allErrors,h,v="data"+(o||""),f="valid"+n,p="errs__"+n,y=e.opts.$data&&i&&i.$data,g;y?(t+=" var schema"+n+" = "+e.util.getData(i.$data,o,e.dataPathArr)+"; ",g="schema"+n):g=i;var x=this,S="definition"+n,w=x.definition,T="",C,R,L,U,$;if(y&&w.$data){$="keywordValidate"+n;var D=w.validateSchema;t+=" var "+S+" = RULES.custom['"+r+"'].definition; var "+$+" = "+S+".validate;"}else{if(U=e.useCustomRule(x,i,e.schema,e),!U)return;g="validate.schema"+l,$=U.code,C=w.compile,R=w.inline,L=w.macro}var F=$+".errors",q="i"+n,I="ruleErr"+n,A=w.async;if(A&&!e.async)throw new Error("async keyword in sync schema");if(R||L||(t+=""+F+" = null;"),t+="var "+p+" = errors;var "+f+";",y&&w.$data&&(T+="}",t+=" if ("+g+" === undefined) { "+f+" = true; } else { ",D&&(T+="}",t+=" "+f+" = "+S+".validateSchema("+g+"); if ("+f+") { ")),R)w.statements?t+=" "+U.validate+" ":t+=" "+f+" = "+U.validate+"; ";else if(L){var V=e.util.copy(e),T="";V.level++;var ue="valid"+V.level;V.schema=U.validate,V.schemaPath="";var ee=e.compositeRule;e.compositeRule=V.compositeRule=!0;var se=e.validate(V).replace(/validate\.schema/g,$);e.compositeRule=V.compositeRule=ee,t+=" "+se}else{var X=X||[];X.push(t),t="",t+="  "+$+".call( ",e.opts.passContext?t+="this":t+="self",C||w.schema===!1?t+=" , "+v+" ":t+=" , "+g+" , "+v+" , validate.schema"+e.schemaPath+" ",t+=" , (dataPath || '')",e.errorPath!='""'&&(t+=" + "+e.errorPath);var H=o?"data"+(o-1||""):"parentData",xe=o?e.dataPathArr[o]:"parentDataProperty";t+=" , "+H+" , "+xe+" , rootData )  ";var Ae=t;t=X.pop(),w.errors===!1?(t+=" "+f+" = ",A&&(t+="await "),t+=""+Ae+"; "):A?(F="customErrors"+n,t+=" var "+F+" = null; try { "+f+" = await "+Ae+"; } catch (e) { "+f+" = false; if (e instanceof ValidationError) "+F+" = e.errors; else throw e; } "):t+=" "+F+" = null; "+f+" = "+Ae+"; "}if(w.modifying&&(t+=" if ("+H+") "+v+" = "+H+"["+xe+"];"),t+=""+T,w.valid)d&&(t+=" if (true) { ");else{t+=" if ( ",w.valid===void 0?(t+=" !",L?t+=""+ue:t+=""+f):t+=" "+!w.valid+" ",t+=") { ",h=x.keyword;var X=X||[];X.push(t),t="";var X=X||[];X.push(t),t="",e.createErrors!==!1?(t+=" { keyword: '"+(h||"custom")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { keyword: '"+x.keyword+"' } ",e.opts.messages!==!1&&(t+=` , message: 'should pass "`+x.keyword+`" keyword validation' `),e.opts.verbose&&(t+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+v+" "),t+=" } "):t+=" {} ";var Fe=t;t=X.pop(),!e.compositeRule&&d?e.async?t+=" throw new ValidationError(["+Fe+"]); ":t+=" validate.errors = ["+Fe+"]; return false; ":t+=" var err = "+Fe+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ";var ie=t;t=X.pop(),R?w.errors?w.errors!="full"&&(t+="  for (var "+q+"="+p+"; "+q+"<errors; "+q+"++) { var "+I+" = vErrors["+q+"]; if ("+I+".dataPath === undefined) "+I+".dataPath = (dataPath || '') + "+e.errorPath+"; if ("+I+".schemaPath === undefined) { "+I+'.schemaPath = "'+c+'"; } ',e.opts.verbose&&(t+=" "+I+".schema = "+g+"; "+I+".data = "+v+"; "),t+=" } "):w.errors===!1?t+=" "+ie+" ":(t+=" if ("+p+" == errors) { "+ie+" } else {  for (var "+q+"="+p+"; "+q+"<errors; "+q+"++) { var "+I+" = vErrors["+q+"]; if ("+I+".dataPath === undefined) "+I+".dataPath = (dataPath || '') + "+e.errorPath+"; if ("+I+".schemaPath === undefined) { "+I+'.schemaPath = "'+c+'"; } ',e.opts.verbose&&(t+=" "+I+".schema = "+g+"; "+I+".data = "+v+"; "),t+=" } } "):L?(t+="   var err =   ",e.createErrors!==!1?(t+=" { keyword: '"+(h||"custom")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { keyword: '"+x.keyword+"' } ",e.opts.messages!==!1&&(t+=` , message: 'should pass "`+x.keyword+`" keyword validation' `),e.opts.verbose&&(t+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+v+" "),t+=" } "):t+=" {} ",t+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",!e.compositeRule&&d&&(e.async?t+=" throw new ValidationError(vErrors); ":t+=" validate.errors = vErrors; return false; ")):w.errors===!1?t+=" "+ie+" ":(t+=" if (Array.isArray("+F+")) { if (vErrors === null) vErrors = "+F+"; else vErrors = vErrors.concat("+F+"); errors = vErrors.length;  for (var "+q+"="+p+"; "+q+"<errors; "+q+"++) { var "+I+" = vErrors["+q+"]; if ("+I+".dataPath === undefined) "+I+".dataPath = (dataPath || '') + "+e.errorPath+";  "+I+'.schemaPath = "'+c+'";  ',e.opts.verbose&&(t+=" "+I+".schema = "+g+"; "+I+".data = "+v+"; "),t+=" } } else { "+ie+" } "),t+=" } ",d&&(t+=" else { ")}return t}});var Un=z((T_,Dm)=>{Dm.exports={$schema:"http://json-schema.org/draft-07/schema#",$id:"http://json-schema.org/draft-07/schema#",title:"Core schema meta-schema",definitions:{schemaArray:{type:"array",minItems:1,items:{$ref:"#"}},nonNegativeInteger:{type:"integer",minimum:0},nonNegativeIntegerDefault0:{allOf:[{$ref:"#/definitions/nonNegativeInteger"},{default:0}]},simpleTypes:{enum:["array","boolean","integer","null","number","object","string"]},stringArray:{type:"array",items:{type:"string"},uniqueItems:!0,default:[]}},type:["object","boolean"],properties:{$id:{type:"string",format:"uri-reference"},$schema:{type:"string",format:"uri"},$ref:{type:"string",format:"uri-reference"},$comment:{type:"string"},title:{type:"string"},description:{type:"string"},default:!0,readOnly:{type:"boolean",default:!1},examples:{type:"array",items:!0},multipleOf:{type:"number",exclusiveMinimum:0},maximum:{type:"number"},exclusiveMaximum:{type:"number"},minimum:{type:"number"},exclusiveMinimum:{type:"number"},maxLength:{$ref:"#/definitions/nonNegativeInteger"},minLength:{$ref:"#/definitions/nonNegativeIntegerDefault0"},pattern:{type:"string",format:"regex"},additionalItems:{$ref:"#"},items:{anyOf:[{$ref:"#"},{$ref:"#/definitions/schemaArray"}],default:!0},maxItems:{$ref:"#/definitions/nonNegativeInteger"},minItems:{$ref:"#/definitions/nonNegativeIntegerDefault0"},uniqueItems:{type:"boolean",default:!1},contains:{$ref:"#"},maxProperties:{$ref:"#/definitions/nonNegativeInteger"},minProperties:{$ref:"#/definitions/nonNegativeIntegerDefault0"},required:{$ref:"#/definitions/stringArray"},additionalProperties:{$ref:"#"},definitions:{type:"object",additionalProperties:{$ref:"#"},default:{}},properties:{type:"object",additionalProperties:{$ref:"#"},default:{}},patternProperties:{type:"object",additionalProperties:{$ref:"#"},propertyNames:{format:"regex"},default:{}},dependencies:{type:"object",additionalProperties:{anyOf:[{$ref:"#"},{$ref:"#/definitions/stringArray"}]}},propertyNames:{$ref:"#"},const:!0,enum:{type:"array",items:!0,minItems:1,uniqueItems:!0},type:{anyOf:[{$ref:"#/definitions/simpleTypes"},{type:"array",items:{$ref:"#/definitions/simpleTypes"},minItems:1,uniqueItems:!0}]},format:{type:"string"},contentMediaType:{type:"string"},contentEncoding:{type:"string"},if:{$ref:"#"},then:{$ref:"#"},else:{$ref:"#"},allOf:{$ref:"#/definitions/schemaArray"},anyOf:{$ref:"#/definitions/schemaArray"},oneOf:{$ref:"#/definitions/schemaArray"},not:{$ref:"#"}},default:!0}});var ou=z((C_,iu)=>{"use strict";var nu=Un();iu.exports={$id:"https://github.com/ajv-validator/ajv/blob/master/lib/definition_schema.js",definitions:{simpleTypes:nu.definitions.simpleTypes},type:"object",dependencies:{schema:["validate"],$data:["validate"],statements:["inline"],valid:{not:{required:["macro"]}}},properties:{type:nu.properties.type,schema:{type:"boolean"},statements:{type:"boolean"},dependencies:{type:"array",items:{type:"string"}},metaSchema:{type:"object"},modifying:{type:"boolean"},valid:{type:"boolean"},$data:{type:"boolean"},async:{type:"boolean"},errors:{anyOf:[{type:"boolean"},{const:"full"}]}}}});var cu=z((R_,lu)=>{"use strict";var $m=/^[a-z_$][a-z0-9_$-]*$/i,Im=au(),Am=ou();lu.exports={add:Nm,get:Lm,remove:Fm,validate:qn};function Nm(s,e){var r=this.RULES;if(r.keywords[s])throw new Error("Keyword "+s+" is already defined");if(!$m.test(s))throw new Error("Keyword "+s+" is not a valid identifier");if(e){this.validateKeyword(e,!0);var a=e.type;if(Array.isArray(a))for(var t=0;t<a.length;t++)o(s,a[t],e);else o(s,a,e);var n=e.metaSchema;n&&(e.$data&&this._opts.$data&&(n={anyOf:[n,{$ref:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#"}]}),e.validateSchema=this.compile(n,!0))}r.keywords[s]=r.all[s]=!0;function o(i,l,c){for(var d,h=0;h<r.length;h++){var v=r[h];if(v.type==l){d=v;break}}d||(d={type:l,rules:[]},r.push(d));var f={keyword:i,definition:c,custom:!0,code:Im,implements:c.implements};d.rules.push(f),r.custom[i]=f}return this}function Lm(s){var e=this.RULES.custom[s];return e?e.definition:this.RULES.keywords[s]||!1}function Fm(s){var e=this.RULES;delete e.keywords[s],delete e.all[s],delete e.custom[s];for(var r=0;r<e.length;r++)for(var a=e[r].rules,t=0;t<a.length;t++)if(a[t].keyword==s){a.splice(t,1);break}return this}function qn(s,e){qn.errors=null;var r=this._validateKeyword=this._validateKeyword||this.compile(Am,!0);if(r(s))return!0;if(qn.errors=r.errors,e)throw new Error("custom keyword definition is invalid: "+this.errorsText(r.errors));return!1}});var uu=z((k_,jm)=>{jm.exports={$schema:"http://json-schema.org/draft-07/schema#",$id:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#",description:"Meta-schema for $data reference (JSON Schema extension proposal)",type:"object",required:["$data"],properties:{$data:{type:"string",anyOf:[{format:"relative-json-pointer"},{format:"json-pointer"}]}},additionalProperties:!1}});var bu=z((O_,_u)=>{"use strict";var du=zl(),Cr=fa(),Mm=Hl(),fu=Tn(),Um=$n(),qm=sc(),Vm=Jc(),hu=Xc(),pu=Tr();_u.exports=Se,Se.prototype.validate=Bm,Se.prototype.compile=Hm,Se.prototype.addSchema=Zm,Se.prototype.addMetaSchema=Wm,Se.prototype.validateSchema=Gm,Se.prototype.getSchema=Jm,Se.prototype.removeSchema=Ym,Se.prototype.addFormat=iv,Se.prototype.errorsText=nv,Se.prototype._addSchema=Xm,Se.prototype._compile=ev,Se.prototype.compileAsync=ru();var _a=cu();Se.prototype.addKeyword=_a.add,Se.prototype.getKeyword=_a.get,Se.prototype.removeKeyword=_a.remove,Se.prototype.validateKeyword=_a.validate;var mu=ha();Se.ValidationError=mu.Validation,Se.MissingRefError=mu.MissingRef,Se.$dataMetaSchema=hu;var ba="http://json-schema.org/draft-07/schema",vu=["removeAdditional","useDefaults","coerceTypes","strictDefaults"],zm=["/properties"];function Se(s){if(!(this instanceof Se))return new Se(s);s=this._opts=pu.copy(s)||{},fv(this),this._schemas={},this._refs={},this._fragments={},this._formats=qm(s.format),this._cache=s.cache||new Mm,this._loadingSchemas={},this._compilations=[],this.RULES=Vm(),this._getId=tv(s),s.loopRequired=s.loopRequired||1/0,s.errorDataPath=="property"&&(s._errorDataPathProperty=!0),s.serialize===void 0&&(s.serialize=Um),this._metaOpts=dv(this),s.formats&&cv(this),s.keywords&&uv(this),ov(this),typeof s.meta=="object"&&this.addMetaSchema(s.meta),s.nullable&&this.addKeyword("nullable",{metaSchema:{type:"boolean"}}),lv(this)}function Bm(s,e){var r;if(typeof s=="string"){if(r=this.getSchema(s),!r)throw new Error('no schema with key or ref "'+s+'"')}else{var a=this._addSchema(s);r=a.validate||this._compile(a)}var t=r(e);return r.$async!==!0&&(this.errors=r.errors),t}function Hm(s,e){var r=this._addSchema(s,void 0,e);return r.validate||this._compile(r)}function Zm(s,e,r,a){if(Array.isArray(s)){for(var t=0;t<s.length;t++)this.addSchema(s[t],void 0,r,a);return this}var n=this._getId(s);if(n!==void 0&&typeof n!="string")throw new Error("schema id must be string");return e=Cr.normalizeId(e||n),yu(this,e),this._schemas[e]=this._addSchema(s,r,a,!0),this}function Wm(s,e,r){return this.addSchema(s,e,r,!0),this}function Gm(s,e){var r=s.$schema;if(r!==void 0&&typeof r!="string")throw new Error("$schema must be a string");if(r=r||this._opts.defaultMeta||Qm(this),!r)return this.logger.warn("meta-schema not available"),this.errors=null,!0;var a=this.validate(r,s);if(!a&&e){var t="schema is invalid: "+this.errorsText();if(this._opts.validateSchema=="log")this.logger.error(t);else throw new Error(t)}return a}function Qm(s){var e=s._opts.meta;return s._opts.defaultMeta=typeof e=="object"?s._getId(e)||e:s.getSchema(ba)?ba:void 0,s._opts.defaultMeta}function Jm(s){var e=gu(this,s);switch(typeof e){case"object":return e.validate||this._compile(e);case"string":return this.getSchema(e);case"undefined":return Km(this,s)}}function Km(s,e){var r=Cr.schema.call(s,{schema:{}},e);if(r){var a=r.schema,t=r.root,n=r.baseId,o=du.call(s,a,t,void 0,n);return s._fragments[e]=new fu({ref:e,fragment:!0,schema:a,root:t,baseId:n,validate:o}),o}}function gu(s,e){return e=Cr.normalizeId(e),s._schemas[e]||s._refs[e]||s._fragments[e]}function Ym(s){if(s instanceof RegExp)return xa(this,this._schemas,s),xa(this,this._refs,s),this;switch(typeof s){case"undefined":return xa(this,this._schemas),xa(this,this._refs),this._cache.clear(),this;case"string":var e=gu(this,s);return e&&this._cache.del(e.cacheKey),delete this._schemas[s],delete this._refs[s],this;case"object":var r=this._opts.serialize,a=r?r(s):s;this._cache.del(a);var t=this._getId(s);t&&(t=Cr.normalizeId(t),delete this._schemas[t],delete this._refs[t])}return this}function xa(s,e,r){for(var a in e){var t=e[a];!t.meta&&(!r||r.test(a))&&(s._cache.del(t.cacheKey),delete e[a])}}function Xm(s,e,r,a){if(typeof s!="object"&&typeof s!="boolean")throw new Error("schema should be object or boolean");var t=this._opts.serialize,n=t?t(s):s,o=this._cache.get(n);if(o)return o;a=a||this._opts.addUsedSchema!==!1;var i=Cr.normalizeId(this._getId(s));i&&a&&yu(this,i);var l=this._opts.validateSchema!==!1&&!e,c;l&&!(c=i&&i==Cr.normalizeId(s.$schema))&&this.validateSchema(s,!0);var d=Cr.ids.call(this,s),h=new fu({id:i,schema:s,localRefs:d,cacheKey:n,meta:r});return i[0]!="#"&&a&&(this._refs[i]=h),this._cache.put(n,h),l&&c&&this.validateSchema(s,!0),h}function ev(s,e){if(s.compiling)return s.validate=t,t.schema=s.schema,t.errors=null,t.root=e||t,s.schema.$async===!0&&(t.$async=!0),t;s.compiling=!0;var r;s.meta&&(r=this._opts,this._opts=this._metaOpts);var a;try{a=du.call(this,s.schema,e,s.localRefs)}catch(n){throw delete s.validate,n}finally{s.compiling=!1,s.meta&&(this._opts=r)}return s.validate=a,s.refs=a.refs,s.refVal=a.refVal,s.root=a.root,a;function t(){var n=s.validate,o=n.apply(this,arguments);return t.errors=n.errors,o}}function tv(s){switch(s.schemaId){case"auto":return av;case"id":return rv;default:return sv}}function rv(s){return s.$id&&this.logger.warn("schema $id ignored",s.$id),s.id}function sv(s){return s.id&&this.logger.warn("schema id ignored",s.id),s.$id}function av(s){if(s.$id&&s.id&&s.$id!=s.id)throw new Error("schema $id is different from id");return s.$id||s.id}function nv(s,e){if(s=s||this.errors,!s)return"No errors";e=e||{};for(var r=e.separator===void 0?", ":e.separator,a=e.dataVar===void 0?"data":e.dataVar,t="",n=0;n<s.length;n++){var o=s[n];o&&(t+=a+o.dataPath+" "+o.message+r)}return t.slice(0,-r.length)}function iv(s,e){return typeof e=="string"&&(e=new RegExp(e)),this._formats[s]=e,this}function ov(s){var e;if(s._opts.$data&&(e=uu(),s.addMetaSchema(e,e.$id,!0)),s._opts.meta!==!1){var r=Un();s._opts.$data&&(r=hu(r,zm)),s.addMetaSchema(r,ba,!0),s._refs["http://json-schema.org/schema"]=ba}}function lv(s){var e=s._opts.schemas;if(e)if(Array.isArray(e))s.addSchema(e);else for(var r in e)s.addSchema(e[r],r)}function cv(s){for(var e in s._opts.formats){var r=s._opts.formats[e];s.addFormat(e,r)}}function uv(s){for(var e in s._opts.keywords){var r=s._opts.keywords[e];s.addKeyword(e,r)}}function yu(s,e){if(s._schemas[e]||s._refs[e])throw new Error('schema with key or id "'+e+'" already exists')}function dv(s){for(var e=pu.copy(s._opts),r=0;r<vu.length;r++)delete e[vu[r]];return e}function fv(s){var e=s._opts.logger;if(e===!1)s.logger={log:Vn,warn:Vn,error:Vn};else{if(e===void 0&&(e=console),!(typeof e=="object"&&e.log&&e.warn&&e.error))throw new Error("logger must implement log, warn and error methods");s.logger=e}}function Vn(){}});var At=z((Wx,Pd)=>{"use strict";var Ed=["nodebuffer","arraybuffer","fragments"],Sd=typeof Blob<"u";Sd&&Ed.push("blob"),Pd.exports={BINARY_TYPES:Ed,EMPTY_BUFFER:Buffer.alloc(0),GUID:"258EAFA5-E914-47DA-95CA-C5AB0DC85B11",hasBlob:Sd,kForOnEventAttribute:Symbol("kIsForOnEventAttribute"),kListener:Symbol("kListener"),kStatusCode:Symbol("status-code"),kWebSocket:Symbol("websocket"),NOOP:()=>{}}});var ys=z((Gx,Da)=>{"use strict";var{EMPTY_BUFFER:Av}=At(),Xn=Buffer[Symbol.species];function Nv(s,e){if(s.length===0)return Av;if(s.length===1)return s[0];let r=Buffer.allocUnsafe(e),a=0;for(let t=0;t<s.length;t++){let n=s[t];r.set(n,a),a+=n.length}return a<e?new Xn(r.buffer,r.byteOffset,a):r}function wd(s,e,r,a,t){for(let n=0;n<t;n++)r[a+n]=s[n]^e[n&3]}function Td(s,e){for(let r=0;r<s.length;r++)s[r]^=e[r&3]}function Lv(s){return s.length===s.buffer.byteLength?s.buffer:s.buffer.slice(s.byteOffset,s.byteOffset+s.length)}function ei(s){if(ei.readOnly=!0,Buffer.isBuffer(s))return s;let e;return s instanceof ArrayBuffer?e=new Xn(s):ArrayBuffer.isView(s)?e=new Xn(s.buffer,s.byteOffset,s.byteLength):(e=Buffer.from(s),ei.readOnly=!1),e}if(Da.exports={concat:Nv,mask:wd,toArrayBuffer:Lv,toBuffer:ei,unmask:Td},!process.env.WS_NO_BUFFER_UTIL)try{let s=require("bufferutil");Da.exports.mask=function(e,r,a,t,n){n<48?wd(e,r,a,t,n):s.mask(e,r,a,t,n)},Da.exports.unmask=function(e,r){e.length<32?Td(e,r):s.unmask(e,r)}}catch{}});var kd=z((Qx,Rd)=>{"use strict";var Cd=Symbol("kDone"),ti=Symbol("kRun"),ri=class{constructor(e){this[Cd]=()=>{this.pending--,this[ti]()},this.concurrency=e||1/0,this.jobs=[],this.pending=0}add(e){this.jobs.push(e),this[ti]()}[ti](){if(this.pending!==this.concurrency&&this.jobs.length){let e=this.jobs.shift();this.pending++,e(this[Cd])}}};Rd.exports=ri});var xs=z((Jx,Id)=>{"use strict";var _s=require("zlib"),Od=ys(),Fv=kd(),{kStatusCode:Dd}=At(),jv=Buffer[Symbol.species],Mv=Buffer.from([0,0,255,255]),$a=Symbol("permessage-deflate"),Nt=Symbol("total-length"),bs=Symbol("callback"),cr=Symbol("buffers"),Ia=Symbol("error"),Aa,si=class{constructor(e,r,a){if(this._maxPayload=a|0,this._options=e||{},this._threshold=this._options.threshold!==void 0?this._options.threshold:1024,this._isServer=!!r,this._deflate=null,this._inflate=null,this.params=null,!Aa){let t=this._options.concurrencyLimit!==void 0?this._options.concurrencyLimit:10;Aa=new Fv(t)}}static get extensionName(){return"permessage-deflate"}offer(){let e={};return this._options.serverNoContextTakeover&&(e.server_no_context_takeover=!0),this._options.clientNoContextTakeover&&(e.client_no_context_takeover=!0),this._options.serverMaxWindowBits&&(e.server_max_window_bits=this._options.serverMaxWindowBits),this._options.clientMaxWindowBits?e.client_max_window_bits=this._options.clientMaxWindowBits:this._options.clientMaxWindowBits==null&&(e.client_max_window_bits=!0),e}accept(e){return e=this.normalizeParams(e),this.params=this._isServer?this.acceptAsServer(e):this.acceptAsClient(e),this.params}cleanup(){if(this._inflate&&(this._inflate.close(),this._inflate=null),this._deflate){let e=this._deflate[bs];this._deflate.close(),this._deflate=null,e&&e(new Error("The deflate stream was closed while data was being processed"))}}acceptAsServer(e){let r=this._options,a=e.find(t=>!(r.serverNoContextTakeover===!1&&t.server_no_context_takeover||t.server_max_window_bits&&(r.serverMaxWindowBits===!1||typeof r.serverMaxWindowBits=="number"&&r.serverMaxWindowBits>t.server_max_window_bits)||typeof r.clientMaxWindowBits=="number"&&!t.client_max_window_bits));if(!a)throw new Error("None of the extension offers can be accepted");return r.serverNoContextTakeover&&(a.server_no_context_takeover=!0),r.clientNoContextTakeover&&(a.client_no_context_takeover=!0),typeof r.serverMaxWindowBits=="number"&&(a.server_max_window_bits=r.serverMaxWindowBits),typeof r.clientMaxWindowBits=="number"?a.client_max_window_bits=r.clientMaxWindowBits:(a.client_max_window_bits===!0||r.clientMaxWindowBits===!1)&&delete a.client_max_window_bits,a}acceptAsClient(e){let r=e[0];if(this._options.clientNoContextTakeover===!1&&r.client_no_context_takeover)throw new Error('Unexpected parameter "client_no_context_takeover"');if(!r.client_max_window_bits)typeof this._options.clientMaxWindowBits=="number"&&(r.client_max_window_bits=this._options.clientMaxWindowBits);else if(this._options.clientMaxWindowBits===!1||typeof this._options.clientMaxWindowBits=="number"&&r.client_max_window_bits>this._options.clientMaxWindowBits)throw new Error('Unexpected or invalid parameter "client_max_window_bits"');return r}normalizeParams(e){return e.forEach(r=>{Object.keys(r).forEach(a=>{let t=r[a];if(t.length>1)throw new Error(`Parameter "${a}" must have only a single value`);if(t=t[0],a==="client_max_window_bits"){if(t!==!0){let n=+t;if(!Number.isInteger(n)||n<8||n>15)throw new TypeError(`Invalid value for parameter "${a}": ${t}`);t=n}else if(!this._isServer)throw new TypeError(`Invalid value for parameter "${a}": ${t}`)}else if(a==="server_max_window_bits"){let n=+t;if(!Number.isInteger(n)||n<8||n>15)throw new TypeError(`Invalid value for parameter "${a}": ${t}`);t=n}else if(a==="client_no_context_takeover"||a==="server_no_context_takeover"){if(t!==!0)throw new TypeError(`Invalid value for parameter "${a}": ${t}`)}else throw new Error(`Unknown parameter "${a}"`);r[a]=t})}),e}decompress(e,r,a){Aa.add(t=>{this._decompress(e,r,(n,o)=>{t(),a(n,o)})})}compress(e,r,a){Aa.add(t=>{this._compress(e,r,(n,o)=>{t(),a(n,o)})})}_decompress(e,r,a){let t=this._isServer?"client":"server";if(!this._inflate){let n=`${t}_max_window_bits`,o=typeof this.params[n]!="number"?_s.Z_DEFAULT_WINDOWBITS:this.params[n];this._inflate=_s.createInflateRaw({...this._options.zlibInflateOptions,windowBits:o}),this._inflate[$a]=this,this._inflate[Nt]=0,this._inflate[cr]=[],this._inflate.on("error",qv),this._inflate.on("data",$d)}this._inflate[bs]=a,this._inflate.write(e),r&&this._inflate.write(Mv),this._inflate.flush(()=>{let n=this._inflate[Ia];if(n){this._inflate.close(),this._inflate=null,a(n);return}let o=Od.concat(this._inflate[cr],this._inflate[Nt]);this._inflate._readableState.endEmitted?(this._inflate.close(),this._inflate=null):(this._inflate[Nt]=0,this._inflate[cr]=[],r&&this.params[`${t}_no_context_takeover`]&&this._inflate.reset()),a(null,o)})}_compress(e,r,a){let t=this._isServer?"server":"client";if(!this._deflate){let n=`${t}_max_window_bits`,o=typeof this.params[n]!="number"?_s.Z_DEFAULT_WINDOWBITS:this.params[n];this._deflate=_s.createDeflateRaw({...this._options.zlibDeflateOptions,windowBits:o}),this._deflate[Nt]=0,this._deflate[cr]=[],this._deflate.on("data",Uv)}this._deflate[bs]=a,this._deflate.write(e),this._deflate.flush(_s.Z_SYNC_FLUSH,()=>{if(!this._deflate)return;let n=Od.concat(this._deflate[cr],this._deflate[Nt]);r&&(n=new jv(n.buffer,n.byteOffset,n.length-4)),this._deflate[bs]=null,this._deflate[Nt]=0,this._deflate[cr]=[],r&&this.params[`${t}_no_context_takeover`]&&this._deflate.reset(),a(null,n)})}};Id.exports=si;function Uv(s){this[cr].push(s),this[Nt]+=s.length}function $d(s){if(this[Nt]+=s.length,this[$a]._maxPayload<1||this[Nt]<=this[$a]._maxPayload){this[cr].push(s);return}this[Ia]=new RangeError("Max payload size exceeded"),this[Ia].code="WS_ERR_UNSUPPORTED_MESSAGE_LENGTH",this[Ia][Dd]=1009,this.removeListener("data",$d),this.reset()}function qv(s){this[$a]._inflate=null,s[Dd]=1007,this[bs](s)}});var Wr=z((Kx,Na)=>{"use strict";var{isUtf8:Ad}=require("buffer"),{hasBlob:Vv}=At(),zv=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,1,1,1,1,0,0,1,1,0,1,1,0,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,0,1,0];function Bv(s){return s>=1e3&&s<=1014&&s!==1004&&s!==1005&&s!==1006||s>=3e3&&s<=4999}function ai(s){let e=s.length,r=0;for(;r<e;)if(!(s[r]&128))r++;else if((s[r]&224)===192){if(r+1===e||(s[r+1]&192)!==128||(s[r]&254)===192)return!1;r+=2}else if((s[r]&240)===224){if(r+2>=e||(s[r+1]&192)!==128||(s[r+2]&192)!==128||s[r]===224&&(s[r+1]&224)===128||s[r]===237&&(s[r+1]&224)===160)return!1;r+=3}else if((s[r]&248)===240){if(r+3>=e||(s[r+1]&192)!==128||(s[r+2]&192)!==128||(s[r+3]&192)!==128||s[r]===240&&(s[r+1]&240)===128||s[r]===244&&s[r+1]>143||s[r]>244)return!1;r+=4}else return!1;return!0}function Hv(s){return Vv&&typeof s=="object"&&typeof s.arrayBuffer=="function"&&typeof s.type=="string"&&typeof s.stream=="function"&&(s[Symbol.toStringTag]==="Blob"||s[Symbol.toStringTag]==="File")}if(Na.exports={isBlob:Hv,isValidStatusCode:Bv,isValidUTF8:ai,tokenChars:zv},Ad)Na.exports.isValidUTF8=function(s){return s.length<24?ai(s):Ad(s)};else if(!process.env.WS_NO_UTF_8_VALIDATE)try{let s=require("utf-8-validate");Na.exports.isValidUTF8=function(e){return e.length<32?ai(e):s(e)}}catch{}});var ci=z((Yx,qd)=>{"use strict";var{Writable:Zv}=require("stream"),Nd=xs(),{BINARY_TYPES:Wv,EMPTY_BUFFER:Ld,kStatusCode:Gv,kWebSocket:Qv}=At(),{concat:ni,toArrayBuffer:Jv,unmask:Kv}=ys(),{isValidStatusCode:Yv,isValidUTF8:Fd}=Wr(),La=Buffer[Symbol.species],nt=0,jd=1,Md=2,Ud=3,ii=4,oi=5,Fa=6,li=class extends Zv{constructor(e={}){super(),this._allowSynchronousEvents=e.allowSynchronousEvents!==void 0?e.allowSynchronousEvents:!0,this._binaryType=e.binaryType||Wv[0],this._extensions=e.extensions||{},this._isServer=!!e.isServer,this._maxPayload=e.maxPayload|0,this._skipUTF8Validation=!!e.skipUTF8Validation,this[Qv]=void 0,this._bufferedBytes=0,this._buffers=[],this._compressed=!1,this._payloadLength=0,this._mask=void 0,this._fragmented=0,this._masked=!1,this._fin=!1,this._opcode=0,this._totalPayloadLength=0,this._messageLength=0,this._fragments=[],this._errored=!1,this._loop=!1,this._state=nt}_write(e,r,a){if(this._opcode===8&&this._state==nt)return a();this._bufferedBytes+=e.length,this._buffers.push(e),this.startLoop(a)}consume(e){if(this._bufferedBytes-=e,e===this._buffers[0].length)return this._buffers.shift();if(e<this._buffers[0].length){let a=this._buffers[0];return this._buffers[0]=new La(a.buffer,a.byteOffset+e,a.length-e),new La(a.buffer,a.byteOffset,e)}let r=Buffer.allocUnsafe(e);do{let a=this._buffers[0],t=r.length-e;e>=a.length?r.set(this._buffers.shift(),t):(r.set(new Uint8Array(a.buffer,a.byteOffset,e),t),this._buffers[0]=new La(a.buffer,a.byteOffset+e,a.length-e)),e-=a.length}while(e>0);return r}startLoop(e){this._loop=!0;do switch(this._state){case nt:this.getInfo(e);break;case jd:this.getPayloadLength16(e);break;case Md:this.getPayloadLength64(e);break;case Ud:this.getMask();break;case ii:this.getData(e);break;case oi:case Fa:this._loop=!1;return}while(this._loop);this._errored||e()}getInfo(e){if(this._bufferedBytes<2){this._loop=!1;return}let r=this.consume(2);if(r[0]&48){let t=this.createError(RangeError,"RSV2 and RSV3 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_2_3");e(t);return}let a=(r[0]&64)===64;if(a&&!this._extensions[Nd.extensionName]){let t=this.createError(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1");e(t);return}if(this._fin=(r[0]&128)===128,this._opcode=r[0]&15,this._payloadLength=r[1]&127,this._opcode===0){if(a){let t=this.createError(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1");e(t);return}if(!this._fragmented){let t=this.createError(RangeError,"invalid opcode 0",!0,1002,"WS_ERR_INVALID_OPCODE");e(t);return}this._opcode=this._fragmented}else if(this._opcode===1||this._opcode===2){if(this._fragmented){let t=this.createError(RangeError,`invalid opcode ${this._opcode}`,!0,1002,"WS_ERR_INVALID_OPCODE");e(t);return}this._compressed=a}else if(this._opcode>7&&this._opcode<11){if(!this._fin){let t=this.createError(RangeError,"FIN must be set",!0,1002,"WS_ERR_EXPECTED_FIN");e(t);return}if(a){let t=this.createError(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1");e(t);return}if(this._payloadLength>125||this._opcode===8&&this._payloadLength===1){let t=this.createError(RangeError,`invalid payload length ${this._payloadLength}`,!0,1002,"WS_ERR_INVALID_CONTROL_PAYLOAD_LENGTH");e(t);return}}else{let t=this.createError(RangeError,`invalid opcode ${this._opcode}`,!0,1002,"WS_ERR_INVALID_OPCODE");e(t);return}if(!this._fin&&!this._fragmented&&(this._fragmented=this._opcode),this._masked=(r[1]&128)===128,this._isServer){if(!this._masked){let t=this.createError(RangeError,"MASK must be set",!0,1002,"WS_ERR_EXPECTED_MASK");e(t);return}}else if(this._masked){let t=this.createError(RangeError,"MASK must be clear",!0,1002,"WS_ERR_UNEXPECTED_MASK");e(t);return}this._payloadLength===126?this._state=jd:this._payloadLength===127?this._state=Md:this.haveLength(e)}getPayloadLength16(e){if(this._bufferedBytes<2){this._loop=!1;return}this._payloadLength=this.consume(2).readUInt16BE(0),this.haveLength(e)}getPayloadLength64(e){if(this._bufferedBytes<8){this._loop=!1;return}let r=this.consume(8),a=r.readUInt32BE(0);if(a>Math.pow(2,21)-1){let t=this.createError(RangeError,"Unsupported WebSocket frame: payload length > 2^53 - 1",!1,1009,"WS_ERR_UNSUPPORTED_DATA_PAYLOAD_LENGTH");e(t);return}this._payloadLength=a*Math.pow(2,32)+r.readUInt32BE(4),this.haveLength(e)}haveLength(e){if(this._payloadLength&&this._opcode<8&&(this._totalPayloadLength+=this._payloadLength,this._totalPayloadLength>this._maxPayload&&this._maxPayload>0)){let r=this.createError(RangeError,"Max payload size exceeded",!1,1009,"WS_ERR_UNSUPPORTED_MESSAGE_LENGTH");e(r);return}this._masked?this._state=Ud:this._state=ii}getMask(){if(this._bufferedBytes<4){this._loop=!1;return}this._mask=this.consume(4),this._state=ii}getData(e){let r=Ld;if(this._payloadLength){if(this._bufferedBytes<this._payloadLength){this._loop=!1;return}r=this.consume(this._payloadLength),this._masked&&this._mask[0]|this._mask[1]|this._mask[2]|this._mask[3]&&Kv(r,this._mask)}if(this._opcode>7){this.controlMessage(r,e);return}if(this._compressed){this._state=oi,this.decompress(r,e);return}r.length&&(this._messageLength=this._totalPayloadLength,this._fragments.push(r)),this.dataMessage(e)}decompress(e,r){this._extensions[Nd.extensionName].decompress(e,this._fin,(t,n)=>{if(t)return r(t);if(n.length){if(this._messageLength+=n.length,this._messageLength>this._maxPayload&&this._maxPayload>0){let o=this.createError(RangeError,"Max payload size exceeded",!1,1009,"WS_ERR_UNSUPPORTED_MESSAGE_LENGTH");r(o);return}this._fragments.push(n)}this.dataMessage(r),this._state===nt&&this.startLoop(r)})}dataMessage(e){if(!this._fin){this._state=nt;return}let r=this._messageLength,a=this._fragments;if(this._totalPayloadLength=0,this._messageLength=0,this._fragmented=0,this._fragments=[],this._opcode===2){let t;this._binaryType==="nodebuffer"?t=ni(a,r):this._binaryType==="arraybuffer"?t=Jv(ni(a,r)):this._binaryType==="blob"?t=new Blob(a):t=a,this._allowSynchronousEvents?(this.emit("message",t,!0),this._state=nt):(this._state=Fa,setImmediate(()=>{this.emit("message",t,!0),this._state=nt,this.startLoop(e)}))}else{let t=ni(a,r);if(!this._skipUTF8Validation&&!Fd(t)){let n=this.createError(Error,"invalid UTF-8 sequence",!0,1007,"WS_ERR_INVALID_UTF8");e(n);return}this._state===oi||this._allowSynchronousEvents?(this.emit("message",t,!1),this._state=nt):(this._state=Fa,setImmediate(()=>{this.emit("message",t,!1),this._state=nt,this.startLoop(e)}))}}controlMessage(e,r){if(this._opcode===8){if(e.length===0)this._loop=!1,this.emit("conclude",1005,Ld),this.end();else{let a=e.readUInt16BE(0);if(!Yv(a)){let n=this.createError(RangeError,`invalid status code ${a}`,!0,1002,"WS_ERR_INVALID_CLOSE_CODE");r(n);return}let t=new La(e.buffer,e.byteOffset+2,e.length-2);if(!this._skipUTF8Validation&&!Fd(t)){let n=this.createError(Error,"invalid UTF-8 sequence",!0,1007,"WS_ERR_INVALID_UTF8");r(n);return}this._loop=!1,this.emit("conclude",a,t),this.end()}this._state=nt;return}this._allowSynchronousEvents?(this.emit(this._opcode===9?"ping":"pong",e),this._state=nt):(this._state=Fa,setImmediate(()=>{this.emit(this._opcode===9?"ping":"pong",e),this._state=nt,this.startLoop(r)}))}createError(e,r,a,t,n){this._loop=!1,this._errored=!0;let o=new e(a?`Invalid WebSocket frame: ${r}`:r);return Error.captureStackTrace(o,this.createError),o.code=n,o[Gv]=t,o}};qd.exports=li});var fi=z((eE,Bd)=>{"use strict";var{Duplex:Xx}=require("stream"),{randomFillSync:Xv}=require("crypto"),Vd=xs(),{EMPTY_BUFFER:eg,kWebSocket:tg,NOOP:rg}=At(),{isBlob:Gr,isValidStatusCode:sg}=Wr(),{mask:zd,toBuffer:kr}=ys(),it=Symbol("kByteLength"),ag=Buffer.alloc(4),ja=8*1024,Or,Qr=ja,ht=0,ng=1,ig=2,ui=class s{constructor(e,r,a){this._extensions=r||{},a&&(this._generateMask=a,this._maskBuffer=Buffer.alloc(4)),this._socket=e,this._firstFragment=!0,this._compress=!1,this._bufferedBytes=0,this._queue=[],this._state=ht,this.onerror=rg,this[tg]=void 0}static frame(e,r){let a,t=!1,n=2,o=!1;r.mask&&(a=r.maskBuffer||ag,r.generateMask?r.generateMask(a):(Qr===ja&&(Or===void 0&&(Or=Buffer.alloc(ja)),Xv(Or,0,ja),Qr=0),a[0]=Or[Qr++],a[1]=Or[Qr++],a[2]=Or[Qr++],a[3]=Or[Qr++]),o=(a[0]|a[1]|a[2]|a[3])===0,n=6);let i;typeof e=="string"?(!r.mask||o)&&r[it]!==void 0?i=r[it]:(e=Buffer.from(e),i=e.length):(i=e.length,t=r.mask&&r.readOnly&&!o);let l=i;i>=65536?(n+=8,l=127):i>125&&(n+=2,l=126);let c=Buffer.allocUnsafe(t?i+n:n);return c[0]=r.fin?r.opcode|128:r.opcode,r.rsv1&&(c[0]|=64),c[1]=l,l===126?c.writeUInt16BE(i,2):l===127&&(c[2]=c[3]=0,c.writeUIntBE(i,4,6)),r.mask?(c[1]|=128,c[n-4]=a[0],c[n-3]=a[1],c[n-2]=a[2],c[n-1]=a[3],o?[c,e]:t?(zd(e,a,c,n,i),[c]):(zd(e,a,e,0,i),[c,e])):[c,e]}close(e,r,a,t){let n;if(e===void 0)n=eg;else{if(typeof e!="number"||!sg(e))throw new TypeError("First argument must be a valid error code number");if(r===void 0||!r.length)n=Buffer.allocUnsafe(2),n.writeUInt16BE(e,0);else{let i=Buffer.byteLength(r);if(i>123)throw new RangeError("The message must not be greater than 123 bytes");n=Buffer.allocUnsafe(2+i),n.writeUInt16BE(e,0),typeof r=="string"?n.write(r,2):n.set(r,2)}}let o={[it]:n.length,fin:!0,generateMask:this._generateMask,mask:a,maskBuffer:this._maskBuffer,opcode:8,readOnly:!1,rsv1:!1};this._state!==ht?this.enqueue([this.dispatch,n,!1,o,t]):this.sendFrame(s.frame(n,o),t)}ping(e,r,a){let t,n;if(typeof e=="string"?(t=Buffer.byteLength(e),n=!1):Gr(e)?(t=e.size,n=!1):(e=kr(e),t=e.length,n=kr.readOnly),t>125)throw new RangeError("The data size must not be greater than 125 bytes");let o={[it]:t,fin:!0,generateMask:this._generateMask,mask:r,maskBuffer:this._maskBuffer,opcode:9,readOnly:n,rsv1:!1};Gr(e)?this._state!==ht?this.enqueue([this.getBlobData,e,!1,o,a]):this.getBlobData(e,!1,o,a):this._state!==ht?this.enqueue([this.dispatch,e,!1,o,a]):this.sendFrame(s.frame(e,o),a)}pong(e,r,a){let t,n;if(typeof e=="string"?(t=Buffer.byteLength(e),n=!1):Gr(e)?(t=e.size,n=!1):(e=kr(e),t=e.length,n=kr.readOnly),t>125)throw new RangeError("The data size must not be greater than 125 bytes");let o={[it]:t,fin:!0,generateMask:this._generateMask,mask:r,maskBuffer:this._maskBuffer,opcode:10,readOnly:n,rsv1:!1};Gr(e)?this._state!==ht?this.enqueue([this.getBlobData,e,!1,o,a]):this.getBlobData(e,!1,o,a):this._state!==ht?this.enqueue([this.dispatch,e,!1,o,a]):this.sendFrame(s.frame(e,o),a)}send(e,r,a){let t=this._extensions[Vd.extensionName],n=r.binary?2:1,o=r.compress,i,l;typeof e=="string"?(i=Buffer.byteLength(e),l=!1):Gr(e)?(i=e.size,l=!1):(e=kr(e),i=e.length,l=kr.readOnly),this._firstFragment?(this._firstFragment=!1,o&&t&&t.params[t._isServer?"server_no_context_takeover":"client_no_context_takeover"]&&(o=i>=t._threshold),this._compress=o):(o=!1,n=0),r.fin&&(this._firstFragment=!0);let c={[it]:i,fin:r.fin,generateMask:this._generateMask,mask:r.mask,maskBuffer:this._maskBuffer,opcode:n,readOnly:l,rsv1:o};Gr(e)?this._state!==ht?this.enqueue([this.getBlobData,e,this._compress,c,a]):this.getBlobData(e,this._compress,c,a):this._state!==ht?this.enqueue([this.dispatch,e,this._compress,c,a]):this.dispatch(e,this._compress,c,a)}getBlobData(e,r,a,t){this._bufferedBytes+=a[it],this._state=ig,e.arrayBuffer().then(n=>{if(this._socket.destroyed){let i=new Error("The socket was closed while the blob was being read");process.nextTick(di,this,i,t);return}this._bufferedBytes-=a[it];let o=kr(n);r?this.dispatch(o,r,a,t):(this._state=ht,this.sendFrame(s.frame(o,a),t),this.dequeue())}).catch(n=>{process.nextTick(og,this,n,t)})}dispatch(e,r,a,t){if(!r){this.sendFrame(s.frame(e,a),t);return}let n=this._extensions[Vd.extensionName];this._bufferedBytes+=a[it],this._state=ng,n.compress(e,a.fin,(o,i)=>{if(this._socket.destroyed){let l=new Error("The socket was closed while data was being compressed");di(this,l,t);return}this._bufferedBytes-=a[it],this._state=ht,a.readOnly=!1,this.sendFrame(s.frame(i,a),t),this.dequeue()})}dequeue(){for(;this._state===ht&&this._queue.length;){let e=this._queue.shift();this._bufferedBytes-=e[3][it],Reflect.apply(e[0],this,e.slice(1))}}enqueue(e){this._bufferedBytes+=e[3][it],this._queue.push(e)}sendFrame(e,r){e.length===2?(this._socket.cork(),this._socket.write(e[0]),this._socket.write(e[1],r),this._socket.uncork()):this._socket.write(e[0],r)}};Bd.exports=ui;function di(s,e,r){typeof r=="function"&&r(e);for(let a=0;a<s._queue.length;a++){let t=s._queue[a],n=t[t.length-1];typeof n=="function"&&n(e)}}function og(s,e,r){di(s,e,r),s.onerror(e)}});var Xd=z((tE,Yd)=>{"use strict";var{kForOnEventAttribute:Es,kListener:hi}=At(),Hd=Symbol("kCode"),Zd=Symbol("kData"),Wd=Symbol("kError"),Gd=Symbol("kMessage"),Qd=Symbol("kReason"),Jr=Symbol("kTarget"),Jd=Symbol("kType"),Kd=Symbol("kWasClean"),Lt=class{constructor(e){this[Jr]=null,this[Jd]=e}get target(){return this[Jr]}get type(){return this[Jd]}};Object.defineProperty(Lt.prototype,"target",{enumerable:!0}),Object.defineProperty(Lt.prototype,"type",{enumerable:!0});var Dr=class extends Lt{constructor(e,r={}){super(e),this[Hd]=r.code===void 0?0:r.code,this[Qd]=r.reason===void 0?"":r.reason,this[Kd]=r.wasClean===void 0?!1:r.wasClean}get code(){return this[Hd]}get reason(){return this[Qd]}get wasClean(){return this[Kd]}};Object.defineProperty(Dr.prototype,"code",{enumerable:!0}),Object.defineProperty(Dr.prototype,"reason",{enumerable:!0}),Object.defineProperty(Dr.prototype,"wasClean",{enumerable:!0});var Kr=class extends Lt{constructor(e,r={}){super(e),this[Wd]=r.error===void 0?null:r.error,this[Gd]=r.message===void 0?"":r.message}get error(){return this[Wd]}get message(){return this[Gd]}};Object.defineProperty(Kr.prototype,"error",{enumerable:!0}),Object.defineProperty(Kr.prototype,"message",{enumerable:!0});var Ss=class extends Lt{constructor(e,r={}){super(e),this[Zd]=r.data===void 0?null:r.data}get data(){return this[Zd]}};Object.defineProperty(Ss.prototype,"data",{enumerable:!0});var lg={addEventListener(s,e,r={}){for(let t of this.listeners(s))if(!r[Es]&&t[hi]===e&&!t[Es])return;let a;if(s==="message")a=function(n,o){let i=new Ss("message",{data:o?n:n.toString()});i[Jr]=this,Ma(e,this,i)};else if(s==="close")a=function(n,o){let i=new Dr("close",{code:n,reason:o.toString(),wasClean:this._closeFrameReceived&&this._closeFrameSent});i[Jr]=this,Ma(e,this,i)};else if(s==="error")a=function(n){let o=new Kr("error",{error:n,message:n.message});o[Jr]=this,Ma(e,this,o)};else if(s==="open")a=function(){let n=new Lt("open");n[Jr]=this,Ma(e,this,n)};else return;a[Es]=!!r[Es],a[hi]=e,r.once?this.once(s,a):this.on(s,a)},removeEventListener(s,e){for(let r of this.listeners(s))if(r[hi]===e&&!r[Es]){this.removeListener(s,r);break}}};Yd.exports={CloseEvent:Dr,ErrorEvent:Kr,Event:Lt,EventTarget:lg,MessageEvent:Ss};function Ma(s,e,r){typeof s=="object"&&s.handleEvent?s.handleEvent.call(s,r):s.call(e,r)}});var pi=z((rE,ef)=>{"use strict";var{tokenChars:Ps}=Wr();function St(s,e,r){s[e]===void 0?s[e]=[r]:s[e].push(r)}function cg(s){let e=Object.create(null),r=Object.create(null),a=!1,t=!1,n=!1,o,i,l=-1,c=-1,d=-1,h=0;for(;h<s.length;h++)if(c=s.charCodeAt(h),o===void 0)if(d===-1&&Ps[c]===1)l===-1&&(l=h);else if(h!==0&&(c===32||c===9))d===-1&&l!==-1&&(d=h);else if(c===59||c===44){if(l===-1)throw new SyntaxError(`Unexpected character at index ${h}`);d===-1&&(d=h);let f=s.slice(l,d);c===44?(St(e,f,r),r=Object.create(null)):o=f,l=d=-1}else throw new SyntaxError(`Unexpected character at index ${h}`);else if(i===void 0)if(d===-1&&Ps[c]===1)l===-1&&(l=h);else if(c===32||c===9)d===-1&&l!==-1&&(d=h);else if(c===59||c===44){if(l===-1)throw new SyntaxError(`Unexpected character at index ${h}`);d===-1&&(d=h),St(r,s.slice(l,d),!0),c===44&&(St(e,o,r),r=Object.create(null),o=void 0),l=d=-1}else if(c===61&&l!==-1&&d===-1)i=s.slice(l,h),l=d=-1;else throw new SyntaxError(`Unexpected character at index ${h}`);else if(t){if(Ps[c]!==1)throw new SyntaxError(`Unexpected character at index ${h}`);l===-1?l=h:a||(a=!0),t=!1}else if(n)if(Ps[c]===1)l===-1&&(l=h);else if(c===34&&l!==-1)n=!1,d=h;else if(c===92)t=!0;else throw new SyntaxError(`Unexpected character at index ${h}`);else if(c===34&&s.charCodeAt(h-1)===61)n=!0;else if(d===-1&&Ps[c]===1)l===-1&&(l=h);else if(l!==-1&&(c===32||c===9))d===-1&&(d=h);else if(c===59||c===44){if(l===-1)throw new SyntaxError(`Unexpected character at index ${h}`);d===-1&&(d=h);let f=s.slice(l,d);a&&(f=f.replace(/\\/g,""),a=!1),St(r,i,f),c===44&&(St(e,o,r),r=Object.create(null),o=void 0),i=void 0,l=d=-1}else throw new SyntaxError(`Unexpected character at index ${h}`);if(l===-1||n||c===32||c===9)throw new SyntaxError("Unexpected end of input");d===-1&&(d=h);let v=s.slice(l,d);return o===void 0?St(e,v,r):(i===void 0?St(r,v,!0):a?St(r,i,v.replace(/\\/g,"")):St(r,i,v),St(e,o,r)),e}function ug(s){return Object.keys(s).map(e=>{let r=s[e];return Array.isArray(r)||(r=[r]),r.map(a=>[e].concat(Object.keys(a).map(t=>{let n=a[t];return Array.isArray(n)||(n=[n]),n.map(o=>o===!0?t:`${t}=${o}`).join("; ")})).join("; ")).join(", ")}).join(", ")}ef.exports={format:ug,parse:cg}});var za=z((nE,hf)=>{"use strict";var dg=require("events"),fg=require("https"),hg=require("http"),tf=require("net"),pg=require("tls"),{randomBytes:mg,createHash:vg}=require("crypto"),{Duplex:sE,Readable:aE}=require("stream"),{URL:mi}=require("url"),ur=xs(),gg=ci(),yg=fi(),{isBlob:_g}=Wr(),{BINARY_TYPES:rf,EMPTY_BUFFER:Ua,GUID:bg,kForOnEventAttribute:vi,kListener:xg,kStatusCode:Eg,kWebSocket:Oe,NOOP:sf}=At(),{EventTarget:{addEventListener:Sg,removeEventListener:Pg}}=Xd(),{format:wg,parse:Tg}=pi(),{toBuffer:Cg}=ys(),Rg=30*1e3,af=Symbol("kAborted"),gi=[8,13],Ft=["CONNECTING","OPEN","CLOSING","CLOSED"],kg=/^[!#$%&'*+\-.0-9A-Z^_`|a-z~]+$/,ge=class s extends dg{constructor(e,r,a){super(),this._binaryType=rf[0],this._closeCode=1006,this._closeFrameReceived=!1,this._closeFrameSent=!1,this._closeMessage=Ua,this._closeTimer=null,this._errorEmitted=!1,this._extensions={},this._paused=!1,this._protocol="",this._readyState=s.CONNECTING,this._receiver=null,this._sender=null,this._socket=null,e!==null?(this._bufferedAmount=0,this._isServer=!1,this._redirects=0,r===void 0?r=[]:Array.isArray(r)||(typeof r=="object"&&r!==null?(a=r,r=[]):r=[r]),nf(this,e,r,a)):(this._autoPong=a.autoPong,this._isServer=!0)}get binaryType(){return this._binaryType}set binaryType(e){rf.includes(e)&&(this._binaryType=e,this._receiver&&(this._receiver._binaryType=e))}get bufferedAmount(){return this._socket?this._socket._writableState.length+this._sender._bufferedBytes:this._bufferedAmount}get extensions(){return Object.keys(this._extensions).join()}get isPaused(){return this._paused}get onclose(){return null}get onerror(){return null}get onopen(){return null}get onmessage(){return null}get protocol(){return this._protocol}get readyState(){return this._readyState}get url(){return this._url}setSocket(e,r,a){let t=new gg({allowSynchronousEvents:a.allowSynchronousEvents,binaryType:this.binaryType,extensions:this._extensions,isServer:this._isServer,maxPayload:a.maxPayload,skipUTF8Validation:a.skipUTF8Validation}),n=new yg(e,this._extensions,a.generateMask);this._receiver=t,this._sender=n,this._socket=e,t[Oe]=this,n[Oe]=this,e[Oe]=this,t.on("conclude",$g),t.on("drain",Ig),t.on("error",Ag),t.on("message",Ng),t.on("ping",Lg),t.on("pong",Fg),n.onerror=jg,e.setTimeout&&e.setTimeout(0),e.setNoDelay&&e.setNoDelay(),r.length>0&&e.unshift(r),e.on("close",uf),e.on("data",Va),e.on("end",df),e.on("error",ff),this._readyState=s.OPEN,this.emit("open")}emitClose(){if(!this._socket){this._readyState=s.CLOSED,this.emit("close",this._closeCode,this._closeMessage);return}this._extensions[ur.extensionName]&&this._extensions[ur.extensionName].cleanup(),this._receiver.removeAllListeners(),this._readyState=s.CLOSED,this.emit("close",this._closeCode,this._closeMessage)}close(e,r){if(this.readyState!==s.CLOSED){if(this.readyState===s.CONNECTING){Ke(this,this._req,"WebSocket was closed before the connection was established");return}if(this.readyState===s.CLOSING){this._closeFrameSent&&(this._closeFrameReceived||this._receiver._writableState.errorEmitted)&&this._socket.end();return}this._readyState=s.CLOSING,this._sender.close(e,r,!this._isServer,a=>{a||(this._closeFrameSent=!0,(this._closeFrameReceived||this._receiver._writableState.errorEmitted)&&this._socket.end())}),cf(this)}}pause(){this.readyState===s.CONNECTING||this.readyState===s.CLOSED||(this._paused=!0,this._socket.pause())}ping(e,r,a){if(this.readyState===s.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");if(typeof e=="function"?(a=e,e=r=void 0):typeof r=="function"&&(a=r,r=void 0),typeof e=="number"&&(e=e.toString()),this.readyState!==s.OPEN){yi(this,e,a);return}r===void 0&&(r=!this._isServer),this._sender.ping(e||Ua,r,a)}pong(e,r,a){if(this.readyState===s.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");if(typeof e=="function"?(a=e,e=r=void 0):typeof r=="function"&&(a=r,r=void 0),typeof e=="number"&&(e=e.toString()),this.readyState!==s.OPEN){yi(this,e,a);return}r===void 0&&(r=!this._isServer),this._sender.pong(e||Ua,r,a)}resume(){this.readyState===s.CONNECTING||this.readyState===s.CLOSED||(this._paused=!1,this._receiver._writableState.needDrain||this._socket.resume())}send(e,r,a){if(this.readyState===s.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");if(typeof r=="function"&&(a=r,r={}),typeof e=="number"&&(e=e.toString()),this.readyState!==s.OPEN){yi(this,e,a);return}let t={binary:typeof e!="string",mask:!this._isServer,compress:!0,fin:!0,...r};this._extensions[ur.extensionName]||(t.compress=!1),this._sender.send(e||Ua,t,a)}terminate(){if(this.readyState!==s.CLOSED){if(this.readyState===s.CONNECTING){Ke(this,this._req,"WebSocket was closed before the connection was established");return}this._socket&&(this._readyState=s.CLOSING,this._socket.destroy())}}};Object.defineProperty(ge,"CONNECTING",{enumerable:!0,value:Ft.indexOf("CONNECTING")}),Object.defineProperty(ge.prototype,"CONNECTING",{enumerable:!0,value:Ft.indexOf("CONNECTING")}),Object.defineProperty(ge,"OPEN",{enumerable:!0,value:Ft.indexOf("OPEN")}),Object.defineProperty(ge.prototype,"OPEN",{enumerable:!0,value:Ft.indexOf("OPEN")}),Object.defineProperty(ge,"CLOSING",{enumerable:!0,value:Ft.indexOf("CLOSING")}),Object.defineProperty(ge.prototype,"CLOSING",{enumerable:!0,value:Ft.indexOf("CLOSING")}),Object.defineProperty(ge,"CLOSED",{enumerable:!0,value:Ft.indexOf("CLOSED")}),Object.defineProperty(ge.prototype,"CLOSED",{enumerable:!0,value:Ft.indexOf("CLOSED")}),["binaryType","bufferedAmount","extensions","isPaused","protocol","readyState","url"].forEach(s=>{Object.defineProperty(ge.prototype,s,{enumerable:!0})}),["open","error","close","message"].forEach(s=>{Object.defineProperty(ge.prototype,`on${s}`,{enumerable:!0,get(){for(let e of this.listeners(s))if(e[vi])return e[xg];return null},set(e){for(let r of this.listeners(s))if(r[vi]){this.removeListener(s,r);break}typeof e=="function"&&this.addEventListener(s,e,{[vi]:!0})}})}),ge.prototype.addEventListener=Sg,ge.prototype.removeEventListener=Pg,hf.exports=ge;function nf(s,e,r,a){let t={allowSynchronousEvents:!0,autoPong:!0,protocolVersion:gi[1],maxPayload:104857600,skipUTF8Validation:!1,perMessageDeflate:!0,followRedirects:!1,maxRedirects:10,...a,socketPath:void 0,hostname:void 0,protocol:void 0,timeout:void 0,method:"GET",host:void 0,path:void 0,port:void 0};if(s._autoPong=t.autoPong,!gi.includes(t.protocolVersion))throw new RangeError(`Unsupported protocol version: ${t.protocolVersion} (supported versions: ${gi.join(", ")})`);let n;if(e instanceof mi)n=e;else try{n=new mi(e)}catch{throw new SyntaxError(`Invalid URL: ${e}`)}n.protocol==="http:"?n.protocol="ws:":n.protocol==="https:"&&(n.protocol="wss:"),s._url=n.href;let o=n.protocol==="wss:",i=n.protocol==="ws+unix:",l;if(n.protocol!=="ws:"&&!o&&!i?l=`The URL's protocol must be one of "ws:", "wss:", "http:", "https", or "ws+unix:"`:i&&!n.pathname?l="The URL's pathname is empty":n.hash&&(l="The URL contains a fragment identifier"),l){let y=new SyntaxError(l);if(s._redirects===0)throw y;qa(s,y);return}let c=o?443:80,d=mg(16).toString("base64"),h=o?fg.request:hg.request,v=new Set,f;if(t.createConnection=t.createConnection||(o?Dg:Og),t.defaultPort=t.defaultPort||c,t.port=n.port||c,t.host=n.hostname.startsWith("[")?n.hostname.slice(1,-1):n.hostname,t.headers={...t.headers,"Sec-WebSocket-Version":t.protocolVersion,"Sec-WebSocket-Key":d,Connection:"Upgrade",Upgrade:"websocket"},t.path=n.pathname+n.search,t.timeout=t.handshakeTimeout,t.perMessageDeflate&&(f=new ur(t.perMessageDeflate!==!0?t.perMessageDeflate:{},!1,t.maxPayload),t.headers["Sec-WebSocket-Extensions"]=wg({[ur.extensionName]:f.offer()})),r.length){for(let y of r){if(typeof y!="string"||!kg.test(y)||v.has(y))throw new SyntaxError("An invalid or duplicated subprotocol was specified");v.add(y)}t.headers["Sec-WebSocket-Protocol"]=r.join(",")}if(t.origin&&(t.protocolVersion<13?t.headers["Sec-WebSocket-Origin"]=t.origin:t.headers.Origin=t.origin),(n.username||n.password)&&(t.auth=`${n.username}:${n.password}`),i){let y=t.path.split(":");t.socketPath=y[0],t.path=y[1]}let p;if(t.followRedirects){if(s._redirects===0){s._originalIpc=i,s._originalSecure=o,s._originalHostOrSocketPath=i?t.socketPath:n.host;let y=a&&a.headers;if(a={...a,headers:{}},y)for(let[g,x]of Object.entries(y))a.headers[g.toLowerCase()]=x}else if(s.listenerCount("redirect")===0){let y=i?s._originalIpc?t.socketPath===s._originalHostOrSocketPath:!1:s._originalIpc?!1:n.host===s._originalHostOrSocketPath;(!y||s._originalSecure&&!o)&&(delete t.headers.authorization,delete t.headers.cookie,y||delete t.headers.host,t.auth=void 0)}t.auth&&!a.headers.authorization&&(a.headers.authorization="Basic "+Buffer.from(t.auth).toString("base64")),p=s._req=h(t),s._redirects&&s.emit("redirect",s.url,p)}else p=s._req=h(t);t.timeout&&p.on("timeout",()=>{Ke(s,p,"Opening handshake has timed out")}),p.on("error",y=>{p===null||p[af]||(p=s._req=null,qa(s,y))}),p.on("response",y=>{let g=y.headers.location,x=y.statusCode;if(g&&t.followRedirects&&x>=300&&x<400){if(++s._redirects>t.maxRedirects){Ke(s,p,"Maximum redirects exceeded");return}p.abort();let S;try{S=new mi(g,e)}catch{let T=new SyntaxError(`Invalid URL: ${g}`);qa(s,T);return}nf(s,S,r,a)}else s.emit("unexpected-response",p,y)||Ke(s,p,`Unexpected server response: ${y.statusCode}`)}),p.on("upgrade",(y,g,x)=>{if(s.emit("upgrade",y),s.readyState!==ge.CONNECTING)return;p=s._req=null;let S=y.headers.upgrade;if(S===void 0||S.toLowerCase()!=="websocket"){Ke(s,g,"Invalid Upgrade header");return}let w=vg("sha1").update(d+bg).digest("base64");if(y.headers["sec-websocket-accept"]!==w){Ke(s,g,"Invalid Sec-WebSocket-Accept header");return}let T=y.headers["sec-websocket-protocol"],C;if(T!==void 0?v.size?v.has(T)||(C="Server sent an invalid subprotocol"):C="Server sent a subprotocol but none was requested":v.size&&(C="Server sent no subprotocol"),C){Ke(s,g,C);return}T&&(s._protocol=T);let R=y.headers["sec-websocket-extensions"];if(R!==void 0){if(!f){Ke(s,g,"Server sent a Sec-WebSocket-Extensions header but no extension was requested");return}let L;try{L=Tg(R)}catch{Ke(s,g,"Invalid Sec-WebSocket-Extensions header");return}let U=Object.keys(L);if(U.length!==1||U[0]!==ur.extensionName){Ke(s,g,"Server indicated an extension that was not requested");return}try{f.accept(L[ur.extensionName])}catch{Ke(s,g,"Invalid Sec-WebSocket-Extensions header");return}s._extensions[ur.extensionName]=f}s.setSocket(g,x,{allowSynchronousEvents:t.allowSynchronousEvents,generateMask:t.generateMask,maxPayload:t.maxPayload,skipUTF8Validation:t.skipUTF8Validation})}),t.finishRequest?t.finishRequest(p,s):p.end()}function qa(s,e){s._readyState=ge.CLOSING,s._errorEmitted=!0,s.emit("error",e),s.emitClose()}function Og(s){return s.path=s.socketPath,tf.connect(s)}function Dg(s){return s.path=void 0,!s.servername&&s.servername!==""&&(s.servername=tf.isIP(s.host)?"":s.host),pg.connect(s)}function Ke(s,e,r){s._readyState=ge.CLOSING;let a=new Error(r);Error.captureStackTrace(a,Ke),e.setHeader?(e[af]=!0,e.abort(),e.socket&&!e.socket.destroyed&&e.socket.destroy(),process.nextTick(qa,s,a)):(e.destroy(a),e.once("error",s.emit.bind(s,"error")),e.once("close",s.emitClose.bind(s)))}function yi(s,e,r){if(e){let a=_g(e)?e.size:Cg(e).length;s._socket?s._sender._bufferedBytes+=a:s._bufferedAmount+=a}if(r){let a=new Error(`WebSocket is not open: readyState ${s.readyState} (${Ft[s.readyState]})`);process.nextTick(r,a)}}function $g(s,e){let r=this[Oe];r._closeFrameReceived=!0,r._closeMessage=e,r._closeCode=s,r._socket[Oe]!==void 0&&(r._socket.removeListener("data",Va),process.nextTick(lf,r._socket),s===1005?r.close():r.close(s,e))}function Ig(){let s=this[Oe];s.isPaused||s._socket.resume()}function Ag(s){let e=this[Oe];e._socket[Oe]!==void 0&&(e._socket.removeListener("data",Va),process.nextTick(lf,e._socket),e.close(s[Eg])),e._errorEmitted||(e._errorEmitted=!0,e.emit("error",s))}function of(){this[Oe].emitClose()}function Ng(s,e){this[Oe].emit("message",s,e)}function Lg(s){let e=this[Oe];e._autoPong&&e.pong(s,!this._isServer,sf),e.emit("ping",s)}function Fg(s){this[Oe].emit("pong",s)}function lf(s){s.resume()}function jg(s){let e=this[Oe];e.readyState!==ge.CLOSED&&(e.readyState===ge.OPEN&&(e._readyState=ge.CLOSING,cf(e)),this._socket.end(),e._errorEmitted||(e._errorEmitted=!0,e.emit("error",s)))}function cf(s){s._closeTimer=setTimeout(s._socket.destroy.bind(s._socket),Rg)}function uf(){let s=this[Oe];this.removeListener("close",uf),this.removeListener("data",Va),this.removeListener("end",df),s._readyState=ge.CLOSING;let e;!this._readableState.endEmitted&&!s._closeFrameReceived&&!s._receiver._writableState.errorEmitted&&(e=s._socket.read())!==null&&s._receiver.write(e),s._receiver.end(),this[Oe]=void 0,clearTimeout(s._closeTimer),s._receiver._writableState.finished||s._receiver._writableState.errorEmitted?s.emitClose():(s._receiver.on("error",of),s._receiver.on("finish",of))}function Va(s){this[Oe]._receiver.write(s)||this.pause()}function df(){let s=this[Oe];s._readyState=ge.CLOSING,s._receiver.end(),this.end()}function ff(){let s=this[Oe];this.removeListener("error",ff),this.on("error",sf),s&&(s._readyState=ge.CLOSING,this.destroy())}});var gf=z((oE,vf)=>{"use strict";var iE=za(),{Duplex:Mg}=require("stream");function pf(s){s.emit("close")}function Ug(){!this.destroyed&&this._writableState.finished&&this.destroy()}function mf(s){this.removeListener("error",mf),this.destroy(),this.listenerCount("error")===0&&this.emit("error",s)}function qg(s,e){let r=!0,a=new Mg({...e,autoDestroy:!1,emitClose:!1,objectMode:!1,writableObjectMode:!1});return s.on("message",function(n,o){let i=!o&&a._readableState.objectMode?n.toString():n;a.push(i)||s.pause()}),s.once("error",function(n){a.destroyed||(r=!1,a.destroy(n))}),s.once("close",function(){a.destroyed||a.push(null)}),a._destroy=function(t,n){if(s.readyState===s.CLOSED){n(t),process.nextTick(pf,a);return}let o=!1;s.once("error",function(l){o=!0,n(l)}),s.once("close",function(){o||n(t),process.nextTick(pf,a)}),r&&s.terminate()},a._final=function(t){if(s.readyState===s.CONNECTING){s.once("open",function(){a._final(t)});return}s._socket!==null&&(s._socket._writableState.finished?(t(),a._readableState.endEmitted&&a.destroy()):(s._socket.once("finish",function(){t()}),s.close()))},a._read=function(){s.isPaused&&s.resume()},a._write=function(t,n,o){if(s.readyState===s.CONNECTING){s.once("open",function(){a._write(t,n,o)});return}s.send(t,o)},a.on("end",Ug),a.on("error",mf),a}vf.exports=qg});var _f=z((lE,yf)=>{"use strict";var{tokenChars:Vg}=Wr();function zg(s){let e=new Set,r=-1,a=-1,t=0;for(t;t<s.length;t++){let o=s.charCodeAt(t);if(a===-1&&Vg[o]===1)r===-1&&(r=t);else if(t!==0&&(o===32||o===9))a===-1&&r!==-1&&(a=t);else if(o===44){if(r===-1)throw new SyntaxError(`Unexpected character at index ${t}`);a===-1&&(a=t);let i=s.slice(r,a);if(e.has(i))throw new SyntaxError(`The "${i}" subprotocol is duplicated`);e.add(i),r=a=-1}else throw new SyntaxError(`Unexpected character at index ${t}`)}if(r===-1||a!==-1)throw new SyntaxError("Unexpected end of input");let n=s.slice(r,t);if(e.has(n))throw new SyntaxError(`The "${n}" subprotocol is duplicated`);return e.add(n),e}yf.exports={parse:zg}});var Tf=z((uE,wf)=>{"use strict";var Bg=require("events"),Ba=require("http"),{Duplex:cE}=require("stream"),{createHash:Hg}=require("crypto"),bf=pi(),$r=xs(),Zg=_f(),Wg=za(),{GUID:Gg,kWebSocket:Qg}=At(),Jg=/^[+/0-9A-Za-z]{22}==$/,xf=0,Ef=1,Sf=2,_i=class extends Bg{constructor(e,r){if(super(),e={allowSynchronousEvents:!0,autoPong:!0,maxPayload:100*1024*1024,skipUTF8Validation:!1,perMessageDeflate:!1,handleProtocols:null,clientTracking:!0,verifyClient:null,noServer:!1,backlog:null,server:null,host:null,path:null,port:null,WebSocket:Wg,...e},e.port==null&&!e.server&&!e.noServer||e.port!=null&&(e.server||e.noServer)||e.server&&e.noServer)throw new TypeError('One and only one of the "port", "server", or "noServer" options must be specified');if(e.port!=null?(this._server=Ba.createServer((a,t)=>{let n=Ba.STATUS_CODES[426];t.writeHead(426,{"Content-Length":n.length,"Content-Type":"text/plain"}),t.end(n)}),this._server.listen(e.port,e.host,e.backlog,r)):e.server&&(this._server=e.server),this._server){let a=this.emit.bind(this,"connection");this._removeListeners=Kg(this._server,{listening:this.emit.bind(this,"listening"),error:this.emit.bind(this,"error"),upgrade:(t,n,o)=>{this.handleUpgrade(t,n,o,a)}})}e.perMessageDeflate===!0&&(e.perMessageDeflate={}),e.clientTracking&&(this.clients=new Set,this._shouldEmitClose=!1),this.options=e,this._state=xf}address(){if(this.options.noServer)throw new Error('The server is operating in "noServer" mode');return this._server?this._server.address():null}close(e){if(this._state===Sf){e&&this.once("close",()=>{e(new Error("The server is not running"))}),process.nextTick(ws,this);return}if(e&&this.once("close",e),this._state!==Ef)if(this._state=Ef,this.options.noServer||this.options.server)this._server&&(this._removeListeners(),this._removeListeners=this._server=null),this.clients?this.clients.size?this._shouldEmitClose=!0:process.nextTick(ws,this):process.nextTick(ws,this);else{let r=this._server;this._removeListeners(),this._removeListeners=this._server=null,r.close(()=>{ws(this)})}}shouldHandle(e){if(this.options.path){let r=e.url.indexOf("?");if((r!==-1?e.url.slice(0,r):e.url)!==this.options.path)return!1}return!0}handleUpgrade(e,r,a,t){r.on("error",Pf);let n=e.headers["sec-websocket-key"],o=e.headers.upgrade,i=+e.headers["sec-websocket-version"];if(e.method!=="GET"){Ir(this,e,r,405,"Invalid HTTP method");return}if(o===void 0||o.toLowerCase()!=="websocket"){Ir(this,e,r,400,"Invalid Upgrade header");return}if(n===void 0||!Jg.test(n)){Ir(this,e,r,400,"Missing or invalid Sec-WebSocket-Key header");return}if(i!==8&&i!==13){Ir(this,e,r,400,"Missing or invalid Sec-WebSocket-Version header");return}if(!this.shouldHandle(e)){Ts(r,400);return}let l=e.headers["sec-websocket-protocol"],c=new Set;if(l!==void 0)try{c=Zg.parse(l)}catch{Ir(this,e,r,400,"Invalid Sec-WebSocket-Protocol header");return}let d=e.headers["sec-websocket-extensions"],h={};if(this.options.perMessageDeflate&&d!==void 0){let v=new $r(this.options.perMessageDeflate,!0,this.options.maxPayload);try{let f=bf.parse(d);f[$r.extensionName]&&(v.accept(f[$r.extensionName]),h[$r.extensionName]=v)}catch{Ir(this,e,r,400,"Invalid or unacceptable Sec-WebSocket-Extensions header");return}}if(this.options.verifyClient){let v={origin:e.headers[`${i===8?"sec-websocket-origin":"origin"}`],secure:!!(e.socket.authorized||e.socket.encrypted),req:e};if(this.options.verifyClient.length===2){this.options.verifyClient(v,(f,p,y,g)=>{if(!f)return Ts(r,p||401,y,g);this.completeUpgrade(h,n,c,e,r,a,t)});return}if(!this.options.verifyClient(v))return Ts(r,401)}this.completeUpgrade(h,n,c,e,r,a,t)}completeUpgrade(e,r,a,t,n,o,i){if(!n.readable||!n.writable)return n.destroy();if(n[Qg])throw new Error("server.handleUpgrade() was called more than once with the same socket, possibly due to a misconfiguration");if(this._state>xf)return Ts(n,503);let c=["HTTP/1.1 101 Switching Protocols","Upgrade: websocket","Connection: Upgrade",`Sec-WebSocket-Accept: ${Hg("sha1").update(r+Gg).digest("base64")}`],d=new this.options.WebSocket(null,void 0,this.options);if(a.size){let h=this.options.handleProtocols?this.options.handleProtocols(a,t):a.values().next().value;h&&(c.push(`Sec-WebSocket-Protocol: ${h}`),d._protocol=h)}if(e[$r.extensionName]){let h=e[$r.extensionName].params,v=bf.format({[$r.extensionName]:[h]});c.push(`Sec-WebSocket-Extensions: ${v}`),d._extensions=e}this.emit("headers",c,t),n.write(c.concat(`\r
`).join(`\r
`)),n.removeListener("error",Pf),d.setSocket(n,o,{allowSynchronousEvents:this.options.allowSynchronousEvents,maxPayload:this.options.maxPayload,skipUTF8Validation:this.options.skipUTF8Validation}),this.clients&&(this.clients.add(d),d.on("close",()=>{this.clients.delete(d),this._shouldEmitClose&&!this.clients.size&&process.nextTick(ws,this)})),i(d,t)}};wf.exports=_i;function Kg(s,e){for(let r of Object.keys(e))s.on(r,e[r]);return function(){for(let a of Object.keys(e))s.removeListener(a,e[a])}}function ws(s){s._state=Sf,s.emit("close")}function Pf(){this.destroy()}function Ts(s,e,r,a){r=r||Ba.STATUS_CODES[e],a={Connection:"close","Content-Type":"text/html","Content-Length":Buffer.byteLength(r),...a},s.once("finish",s.destroy),s.end(`HTTP/1.1 ${e} ${Ba.STATUS_CODES[e]}\r
`+Object.keys(a).map(t=>`${t}: ${a[t]}`).join(`\r
`)+`\r
\r
`+r)}function Ir(s,e,r,a,t){if(s.listenerCount("wsClientError")){let n=new Error(t);Error.captureStackTrace(n,Ir),s.emit("wsClientError",n,r,e)}else Ts(r,a,t)}});var ay={};uh(ay,{activate:()=>ty,deactivate:()=>ry});module.exports=dh(ay);var gr=de(require("child_process")),Mi=de(require("vscode"));async function fh(){return new Promise(async s=>{try{let e=gr.spawn("bash",["-c",'ps -eo pid,ppid,command | grep -E "(node.*bin/claude|/claude)($| )" | grep -v "grep" || echo "no_claude_found"']),r="";e.stdout.on("data",a=>{r+=a.toString()}),e.on("close",()=>{if(r.includes("no_claude_found")||r.trim()===""){console.log("No Claude processes found running"),s([]);return}let a=r.trim().split(`
`).map(t=>{let n=t.trim().split(/\s+/);return{pid:n[0],ppid:n[1]}});console.log(`Found ${a.length} Claude processes running`),s(a)}),e.on("error",a=>{console.error(`Error checking for Claude processes: ${a}`),s([])})}catch(e){console.error(`Error in process check: ${e}`),s([])}})}async function hh(s){let e="",r=gr.spawn("bash",["-c",`pid=${s}; while [ "$pid" -ne 1 ]; do echo $pid; pid=$(ps -o ppid= -p $pid | tr -d ' '); done`]);return r.stdout.on("data",a=>{e+=a.toString()}),new Promise(a=>{r.on("close",()=>{let t=e.trim().split(`
`).filter(n=>n.length>0);a(t)}),r.on("error",t=>{console.error(`Error getting process tree: ${t}`),a([])})})}async function ph(s){return new Promise(async e=>{try{let r=gr.spawn("bash",["-c",`ps -o pid= --ppid ${s}`]),a="";r.stdout.on("data",t=>{a+=t.toString()}),r.on("close",()=>{let t=a.trim().split(`
`).map(n=>n.trim()).filter(n=>n.length>0);e(t)}),r.on("error",t=>{console.error(`Error finding children: ${t}`),e([])})}catch(r){console.error(`Error checking for child processes: ${r}`),e([])}})}async function Ui(s,e){let r={claudeRunning:!1,terminalProcessTree:[],runningClaudeProcesses:[],isChildOfThisTerminal:!1};try{let a=await e.processId;if(!a)return s.info("Could not get terminal process ID"),r;r.runningClaudeProcesses=await fh();let t=r.runningClaudeProcesses.length>0;r.terminalProcessTree=await hh(a);let n=await ph(a);for(let o of r.runningClaudeProcesses){if(o.ppid===a.toString()){r.isChildOfThisTerminal=!0;break}if(n.includes(o.ppid)){r.isChildOfThisTerminal=!0;break}let i=o.ppid;if(i===a.toString()){r.isChildOfThisTerminal=!0;break}if(a.toString()===i){r.isChildOfThisTerminal=!0;break}try{let l=gr.spawn("bash",["-c",`ps -p ${i} -o command=`]),c="";l.stdout.on("data",d=>{c+=d.toString()}),await new Promise(d=>{l.on("close",()=>{let h=c.trim();if((h.includes("bash")||h.includes("sh")||h.includes("zsh"))&&e.name!=="Claude Code")if(a.toString()===i)r.isChildOfThisTerminal=!0;else{let v=gr.spawn("bash",["-c",`ps -p ${a} -o command=`]),f="";v.stdout.on("data",p=>{f+=p.toString()}),v.on("close",()=>{let p=f.trim();(p.includes("bash")||p.includes("sh")||p.includes("zsh"))&&e.name!=="Claude Code"&&(r.isChildOfThisTerminal=!0)})}d()})})}catch(l){s.error(`Error checking Claude's parent process: ${l}`)}if(r.isChildOfThisTerminal)break}return!r.isChildOfThisTerminal&&e.name==="Claude Code"?(r.claudeRunning=!1,r):(t&&r.isChildOfThisTerminal?r.claudeRunning=!0:r.claudeRunning=!1,r)}catch(a){return s.error("Error checking if Claude is running:",a),r}}async function qi(){return new Promise(s=>{try{let e=gr.spawn("which",["claude"]);e.on("close",r=>{s(r===0)}),e.on("error",()=>{s(!1)})}catch(e){console.error(`Error checking for claude command: ${e}`),s(!1)}})}function kt(){try{let s=Mi.window.activeTerminal;s&&s.show()}catch(s){console.error("Error focusing terminal:",s)}}var lt=de(require("vscode"));function mh(s,e,r){let a="",t="",n="";if(e.isEmpty){if(r){let o=s.lineAt(r.start.line),i=s.lineAt(r.end.line);a=o.text.trim(),t=i.text.trim();let c=s.lineAt(e.active.line).text.trim();r.start.line===r.end.line?n=`line ${r.start.line+1}`:n=`lines ${r.start.line+1}-${r.end.line+1}`,e.active.line!==r.start.line&&e.active.line!==r.end.line&&(n=`line ${e.active.line+1} (cursor)`,a=c,t=c)}}else{let o=s.lineAt(e.start.line),i=s.lineAt(e.end.line);a=o.text.trim(),t=i.text.trim(),e.start.line===e.end.line?n=`line ${e.start.line+1}`:n=`lines ${e.start.line+1}-${e.end.line+1}`}return{rangeDescription:n,firstLineText:a,lastLineText:t}}function Ya(s,e,r,a,t,n,o="",i){let{rangeDescription:l,firstLineText:c,lastLineText:d}=mh(s,r,a),h="";if(i){let v=i.range.start.line+1;h=`Fix: ${i.severity===lt.DiagnosticSeverity.Error?"Error":i.severity===lt.DiagnosticSeverity.Warning?"Warning":i.severity===lt.DiagnosticSeverity.Information?"Info":"Hint"} in ${t} line ${v}: ${i.message}`,o&&!o.includes(i.message)&&(h+=`

Note: ${o}`)}else if(o){h=`${o}

`,h+=`Context: ${t} (${n}), ${l}:`,c===d?h+=`
\`${c}\``:(h+=`
First line: \`${c}\``,h+=`
Last line: \`${d}\``);let f=lt.languages.getDiagnostics(s.uri).filter(p=>a&&p.range.intersection(a)!==void 0);f.length>0&&(h+=`

There are ${f.length} issues in this section:`,f.forEach(p=>{let y=p.range.start.line+1,g=p.severity===lt.DiagnosticSeverity.Error?"Error":p.severity===lt.DiagnosticSeverity.Warning?"Warning":"Issue";h+=`
- ${g} at line ${y}: ${p.message}`}))}else{h=`Please analyze and fix issues in ${t} (${n}), ${l}:`,c===d?h+=`
\`${c}\``:(h+=`
First line: \`${c}\``,h+=`
Last line: \`${d}\``);let f=lt.languages.getDiagnostics(s.uri).filter(p=>a&&p.range.intersection(a)!==void 0);f.length>0&&(h+=`

Found ${f.length} issues:`,f.forEach(p=>{let y=p.range.start.line+1,g=p.severity===lt.DiagnosticSeverity.Error?"Error":p.severity===lt.DiagnosticSeverity.Warning?"Warning":"Issue";h+=`
- ${g} at line ${y}: ${p.message}`}))}return h}var Y=de(require("vscode")),Is=de(require("path")),Xi=de(Ki());async function Yi(s,e,r=!0){let a,t=!1;for(let i of Y.window.terminals)if(i.name==="Claude Code"){a=i;try{if(await i.processId){let c=await Ui(s,i);t=c.claudeRunning,s.info("Claude running check result:",c)}}catch(l){s.error("Error checking if Claude is running:",l)}break}if(a&&t)return s.info("Focusing existing Claude terminal"),a.show(),{terminal:a,claudeRunning:t};s.info("Creating new Claude terminal"),r&&Y.window.withProgress({location:Y.ProgressLocation.Notification,title:"Claude Code launching...",cancellable:!1},async i=>new Promise(l=>setTimeout(l,2e3)));let n=Y.window.createTerminal({name:"Claude Code",iconPath:Y.Uri.file(Is.join(e.extensionPath,"resources","claude-logo.svg")),location:{viewColumn:Y.ViewColumn.Beside},isTransient:!0});Y.window.onDidEndTerminalShellExecution(i=>{i.terminal===n&&i.execution.commandLine.value==="claude"&&(s.info(`Claude terminal closed after executing ${i.execution.commandLine.value}`),n.dispose())});let o=!1;return Y.window.onDidChangeTerminalShellIntegration(async i=>{i.terminal===n&&!o&&(o=!0,s.info("Terminal shell integration available"),i.shellIntegration.executeCommand("claude"))}),setTimeout(()=>{!n.shellIntegration&&!o&&(o=!0,n.sendText("claude"))},3e3),n.show(),{terminal:n,claudeRunning:!0}}function eo(s,e,r){let a=async()=>{try{await Yi(s,e)}catch(t){s.error("Error running Claude Code:",t),Y.window.showErrorMessage(`Failed to run Claude Code: ${t}`)}};e.subscriptions.push(Y.commands.registerCommand("claude-code.runClaude",()=>{r.logEvent("run_claude_command"),a()})),e.subscriptions.push(Y.commands.registerCommand("claude-code.runClaude.keyboard",()=>{r.logEvent("run_claude_command_keyboard"),a()}))}var rn="claude-code.runQuickFix";function to(s,e,r){let a=Y.commands.registerCommand(rn,async(t="",n)=>{r.logEvent("quick_fix_command");try{let o=Y.window.activeTextEditor;if(!o)throw new Error("No active text editor");let i=o.document,l=o.selection,c=i.uri.fsPath,d=i.languageId,h=Is.basename(c),v,f;if(!l.isEmpty)f=l,v=`selected code (lines ${l.start.line+1}-${l.end.line+1})`;else{let x=o.selection.active.line,S=Math.max(0,x-3),w=Math.min(i.lineCount-1,x+3);f=new Y.Range(new Y.Position(S,0),new Y.Position(w,i.lineAt(w).text.length)),v=`code around line ${x+1} (lines ${S+1}-${w+1})`}let p="";if(t&&(p+=`${t}

`),p+=`I'm working on a ${d} file (${h}).
`,p+=`Here's the ${v}:

`,n){let x=n.range.start.line+1,S=n.severity===Y.DiagnosticSeverity.Error?"Error":n.severity===Y.DiagnosticSeverity.Warning?"Warning":n.severity===Y.DiagnosticSeverity.Information?"Info":"Hint";p+=`Please fix this specific issue:
`,p+=`- ${S} at line ${x}: ${n.message}

`,f=n.range}else{let x=Y.languages.getDiagnostics(i.uri);if(x.length>0){let S=l.isEmpty?f:l,w=x.filter(T=>T.range.intersection(S)!==void 0);w.length>0&&(p+=`The code has the following issues:
`,w.forEach(T=>{let C=T.range.start.line+1,R=T.severity===Y.DiagnosticSeverity.Error?"Error":T.severity===Y.DiagnosticSeverity.Warning?"Warning":T.severity===Y.DiagnosticSeverity.Information?"Info":"Hint";p+=`- ${R} at line ${C}: ${T.message}
`}),p+=`
`)}}s.info("Enhanced prompt:",p);let{terminal:y}=await Yi(s,e,!0),g=!0;if(g){let x=Ya(i,o,l,f,h,d,t,n);y.sendText(x,!1),setTimeout(()=>{y.sendText("")},1e3)}else{let x=`claude "${c}"`;if(l.isEmpty){if(f){let T=`${f.start.line+1}:${f.start.character+1}-${f.end.line+1}:${f.end.character+1}`;x+=` -r "${T}"`}}else{let T=`${l.start.line+1}:${l.start.character+1}-${l.end.line+1}:${l.end.character+1}`;x+=` -r "${T}"`}let S=Ph(i,o,l,f,h,d,t,n),w=(0,Xi.quote)([S])[0];x+=` -p "${w}"`,y.sendText(x)}return{success:!0,message:`Running Claude Code quick fix on ${c}`,hasSelection:!l.isEmpty,existingSession:g}}catch(o){throw s.error("Error running quick fix with Claude Code:",o),Y.window.showErrorMessage(`Failed to run quick fix: ${o}`),o}});e.subscriptions.push(a)}function Ph(s,e,r,a,t,n,o,i){return Ya(s,e,r,a,t,n,o,i)}function ro(s){let e=new Y.EventEmitter;return s.push(Y.commands.registerCommand("claude-code.acceptProposedDiff",async()=>{let r=Y.window.tabGroups.activeTabGroup.activeTab;e.fire({accepted:!0,activeTab:r}),kt()})),s.push(Y.commands.registerCommand("claude-code.rejectProposedDiff",async()=>{let r=Y.window.tabGroups.activeTabGroup.activeTab;e.fire({accepted:!1,activeTab:r}),kt()})),e.event}function so(s){let e=new Y.EventEmitter;return s.push(Y.commands.registerCommand("claude-code.insertAtMentioned",async()=>{e.fire({}),kt()})),e.event}var te;(function(s){s.assertEqual=t=>t;function e(t){}s.assertIs=e;function r(t){throw new Error}s.assertNever=r,s.arrayToEnum=t=>{let n={};for(let o of t)n[o]=o;return n},s.getValidEnumValues=t=>{let n=s.objectKeys(t).filter(i=>typeof t[t[i]]!="number"),o={};for(let i of n)o[i]=t[i];return s.objectValues(o)},s.objectValues=t=>s.objectKeys(t).map(function(n){return t[n]}),s.objectKeys=typeof Object.keys=="function"?t=>Object.keys(t):t=>{let n=[];for(let o in t)Object.prototype.hasOwnProperty.call(t,o)&&n.push(o);return n},s.find=(t,n)=>{for(let o of t)if(n(o))return o},s.isInteger=typeof Number.isInteger=="function"?t=>Number.isInteger(t):t=>typeof t=="number"&&isFinite(t)&&Math.floor(t)===t;function a(t,n=" | "){return t.map(o=>typeof o=="string"?`'${o}'`:o).join(n)}s.joinValues=a,s.jsonStringifyReplacer=(t,n)=>typeof n=="bigint"?n.toString():n})(te||(te={}));var As;(function(s){s.mergeShapes=(e,r)=>({...e,...r})})(As||(As={}));var j=te.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),yt=s=>{switch(typeof s){case"undefined":return j.undefined;case"string":return j.string;case"number":return isNaN(s)?j.nan:j.number;case"boolean":return j.boolean;case"function":return j.function;case"bigint":return j.bigint;case"symbol":return j.symbol;case"object":return Array.isArray(s)?j.array:s===null?j.null:s.then&&typeof s.then=="function"&&s.catch&&typeof s.catch=="function"?j.promise:typeof Map<"u"&&s instanceof Map?j.map:typeof Set<"u"&&s instanceof Set?j.set:typeof Date<"u"&&s instanceof Date?j.date:j.object;default:return j.unknown}},k=te.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),ao=s=>JSON.stringify(s,null,2).replace(/"([^"]+)":/g,"$1:"),He=class s extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=a=>{this.issues=[...this.issues,a]},this.addIssues=(a=[])=>{this.issues=[...this.issues,...a]};let r=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,r):this.__proto__=r,this.name="ZodError",this.issues=e}format(e){let r=e||function(n){return n.message},a={_errors:[]},t=n=>{for(let o of n.issues)if(o.code==="invalid_union")o.unionErrors.map(t);else if(o.code==="invalid_return_type")t(o.returnTypeError);else if(o.code==="invalid_arguments")t(o.argumentsError);else if(o.path.length===0)a._errors.push(r(o));else{let i=a,l=0;for(;l<o.path.length;){let c=o.path[l];l===o.path.length-1?(i[c]=i[c]||{_errors:[]},i[c]._errors.push(r(o))):i[c]=i[c]||{_errors:[]},i=i[c],l++}}};return t(this),a}static assert(e){if(!(e instanceof s))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,te.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=r=>r.message){let r={},a=[];for(let t of this.issues)t.path.length>0?(r[t.path[0]]=r[t.path[0]]||[],r[t.path[0]].push(e(t))):a.push(e(t));return{formErrors:a,fieldErrors:r}}get formErrors(){return this.flatten()}};He.create=s=>new He(s);var _r=(s,e)=>{let r;switch(s.code){case k.invalid_type:s.received===j.undefined?r="Required":r=`Expected ${s.expected}, received ${s.received}`;break;case k.invalid_literal:r=`Invalid literal value, expected ${JSON.stringify(s.expected,te.jsonStringifyReplacer)}`;break;case k.unrecognized_keys:r=`Unrecognized key(s) in object: ${te.joinValues(s.keys,", ")}`;break;case k.invalid_union:r="Invalid input";break;case k.invalid_union_discriminator:r=`Invalid discriminator value. Expected ${te.joinValues(s.options)}`;break;case k.invalid_enum_value:r=`Invalid enum value. Expected ${te.joinValues(s.options)}, received '${s.received}'`;break;case k.invalid_arguments:r="Invalid function arguments";break;case k.invalid_return_type:r="Invalid function return type";break;case k.invalid_date:r="Invalid date";break;case k.invalid_string:typeof s.validation=="object"?"includes"in s.validation?(r=`Invalid input: must include "${s.validation.includes}"`,typeof s.validation.position=="number"&&(r=`${r} at one or more positions greater than or equal to ${s.validation.position}`)):"startsWith"in s.validation?r=`Invalid input: must start with "${s.validation.startsWith}"`:"endsWith"in s.validation?r=`Invalid input: must end with "${s.validation.endsWith}"`:te.assertNever(s.validation):s.validation!=="regex"?r=`Invalid ${s.validation}`:r="Invalid";break;case k.too_small:s.type==="array"?r=`Array must contain ${s.exact?"exactly":s.inclusive?"at least":"more than"} ${s.minimum} element(s)`:s.type==="string"?r=`String must contain ${s.exact?"exactly":s.inclusive?"at least":"over"} ${s.minimum} character(s)`:s.type==="number"?r=`Number must be ${s.exact?"exactly equal to ":s.inclusive?"greater than or equal to ":"greater than "}${s.minimum}`:s.type==="date"?r=`Date must be ${s.exact?"exactly equal to ":s.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(s.minimum))}`:r="Invalid input";break;case k.too_big:s.type==="array"?r=`Array must contain ${s.exact?"exactly":s.inclusive?"at most":"less than"} ${s.maximum} element(s)`:s.type==="string"?r=`String must contain ${s.exact?"exactly":s.inclusive?"at most":"under"} ${s.maximum} character(s)`:s.type==="number"?r=`Number must be ${s.exact?"exactly":s.inclusive?"less than or equal to":"less than"} ${s.maximum}`:s.type==="bigint"?r=`BigInt must be ${s.exact?"exactly":s.inclusive?"less than or equal to":"less than"} ${s.maximum}`:s.type==="date"?r=`Date must be ${s.exact?"exactly":s.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(s.maximum))}`:r="Invalid input";break;case k.custom:r="Invalid input";break;case k.invalid_intersection_types:r="Intersection results could not be merged";break;case k.not_multiple_of:r=`Number must be a multiple of ${s.multipleOf}`;break;case k.not_finite:r="Number must be finite";break;default:r=e.defaultError,te.assertNever(s)}return{message:r}},no=_r;function io(s){no=s}function is(){return no}var os=s=>{let{data:e,path:r,errorMaps:a,issueData:t}=s,n=[...r,...t.path||[]],o={...t,path:n};if(t.message!==void 0)return{...t,path:n,message:t.message};let i="",l=a.filter(c=>!!c).slice().reverse();for(let c of l)i=c(o,{data:e,defaultError:i}).message;return{...t,path:n,message:i}},oo=[];function N(s,e){let r=is(),a=os({issueData:e,data:s.data,path:s.path,errorMaps:[s.common.contextualErrorMap,s.schemaErrorMap,r,r===_r?void 0:_r].filter(t=>!!t)});s.common.issues.push(a)}var Ie=class s{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,r){let a=[];for(let t of r){if(t.status==="aborted")return W;t.status==="dirty"&&e.dirty(),a.push(t.value)}return{status:e.value,value:a}}static async mergeObjectAsync(e,r){let a=[];for(let t of r){let n=await t.key,o=await t.value;a.push({key:n,value:o})}return s.mergeObjectSync(e,a)}static mergeObjectSync(e,r){let a={};for(let t of r){let{key:n,value:o}=t;if(n.status==="aborted"||o.status==="aborted")return W;n.status==="dirty"&&e.dirty(),o.status==="dirty"&&e.dirty(),n.value!=="__proto__"&&(typeof o.value<"u"||t.alwaysSet)&&(a[n.value]=o.value)}return{status:e.value,value:a}}},W=Object.freeze({status:"aborted"}),br=s=>({status:"dirty",value:s}),Le=s=>({status:"valid",value:s}),Ns=s=>s.status==="aborted",Ls=s=>s.status==="dirty",qt=s=>s.status==="valid",qr=s=>typeof Promise<"u"&&s instanceof Promise;function Fs(s,e,r,a){if(r==="a"&&!a)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?s!==e||!a:!e.has(s))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?a:r==="a"?a.call(s):a?a.value:e.get(s)}function lo(s,e,r,a,t){if(a==="m")throw new TypeError("Private method is not writable");if(a==="a"&&!t)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?s!==e||!t:!e.has(s))throw new TypeError("Cannot write private member to an object whose class did not declare it");return a==="a"?t.call(s,r):t?t.value=r:e.set(s,r),r}typeof SuppressedError=="function"&&SuppressedError;var B;(function(s){s.errToObj=e=>typeof e=="string"?{message:e}:e||{},s.toString=e=>typeof e=="string"?e:e?.message})(B||(B={}));var ls,cs,tt=class{constructor(e,r,a,t){this._cachedPath=[],this.parent=e,this.data=r,this._path=a,this._key=t}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}},co=(s,e)=>{if(qt(e))return{success:!0,data:e.value};if(!s.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;let r=new He(s.common.issues);return this._error=r,this._error}}};function J(s){if(!s)return{};let{errorMap:e,invalid_type_error:r,required_error:a,description:t}=s;if(e&&(r||a))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:t}:{errorMap:(o,i)=>{var l,c;let{message:d}=s;return o.code==="invalid_enum_value"?{message:d??i.defaultError}:typeof i.data>"u"?{message:(l=d??a)!==null&&l!==void 0?l:i.defaultError}:o.code!=="invalid_type"?{message:i.defaultError}:{message:(c=d??r)!==null&&c!==void 0?c:i.defaultError}},description:t}}var Q=class{get description(){return this._def.description}_getType(e){return yt(e.data)}_getOrReturnCtx(e,r){return r||{common:e.parent.common,data:e.data,parsedType:yt(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new Ie,ctx:{common:e.parent.common,data:e.data,parsedType:yt(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){let r=this._parse(e);if(qr(r))throw new Error("Synchronous parse encountered promise.");return r}_parseAsync(e){let r=this._parse(e);return Promise.resolve(r)}parse(e,r){let a=this.safeParse(e,r);if(a.success)return a.data;throw a.error}safeParse(e,r){var a;let t={common:{issues:[],async:(a=r?.async)!==null&&a!==void 0?a:!1,contextualErrorMap:r?.errorMap},path:r?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:yt(e)},n=this._parseSync({data:e,path:t.path,parent:t});return co(t,n)}"~validate"(e){var r,a;let t={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:yt(e)};if(!this["~standard"].async)try{let n=this._parseSync({data:e,path:[],parent:t});return qt(n)?{value:n.value}:{issues:t.common.issues}}catch(n){!((a=(r=n?.message)===null||r===void 0?void 0:r.toLowerCase())===null||a===void 0)&&a.includes("encountered")&&(this["~standard"].async=!0),t.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:t}).then(n=>qt(n)?{value:n.value}:{issues:t.common.issues})}async parseAsync(e,r){let a=await this.safeParseAsync(e,r);if(a.success)return a.data;throw a.error}async safeParseAsync(e,r){let a={common:{issues:[],contextualErrorMap:r?.errorMap,async:!0},path:r?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:yt(e)},t=this._parse({data:e,path:a.path,parent:a}),n=await(qr(t)?t:Promise.resolve(t));return co(a,n)}refine(e,r){let a=t=>typeof r=="string"||typeof r>"u"?{message:r}:typeof r=="function"?r(t):r;return this._refinement((t,n)=>{let o=e(t),i=()=>n.addIssue({code:k.custom,...a(t)});return typeof Promise<"u"&&o instanceof Promise?o.then(l=>l?!0:(i(),!1)):o?!0:(i(),!1)})}refinement(e,r){return this._refinement((a,t)=>e(a)?!0:(t.addIssue(typeof r=="function"?r(a,t):r),!1))}_refinement(e){return new qe({schema:this,typeName:O.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:r=>this["~validate"](r)}}optional(){return Ve.create(this,this._def)}nullable(){return ut.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return bt.create(this)}promise(){return It.create(this,this._def)}or(e){return Gt.create([this,e],this._def)}and(e){return Qt.create(this,e,this._def)}transform(e){return new qe({...J(this._def),schema:this,typeName:O.ZodEffects,effect:{type:"transform",transform:e}})}default(e){let r=typeof e=="function"?e:()=>e;return new er({...J(this._def),innerType:this,defaultValue:r,typeName:O.ZodDefault})}brand(){return new zr({typeName:O.ZodBranded,type:this,...J(this._def)})}catch(e){let r=typeof e=="function"?e:()=>e;return new tr({...J(this._def),innerType:this,catchValue:r,typeName:O.ZodCatch})}describe(e){let r=this.constructor;return new r({...this._def,description:e})}pipe(e){return Br.create(this,e)}readonly(){return rr.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}},wh=/^c[^\s-]{8,}$/i,Th=/^[0-9a-z]+$/,Ch=/^[0-9A-HJKMNP-TV-Z]{26}$/i,Rh=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,kh=/^[a-z0-9_-]{21}$/i,Oh=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,Dh=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,$h=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,Ih="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$",sn,Ah=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,Nh=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,Lh=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,Fh=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,jh=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,Mh=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,uo="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",Uh=new RegExp(`^${uo}$`);function fo(s){let e="([01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d";return s.precision?e=`${e}\\.\\d{${s.precision}}`:s.precision==null&&(e=`${e}(\\.\\d+)?`),e}function qh(s){return new RegExp(`^${fo(s)}$`)}function an(s){let e=`${uo}T${fo(s)}`,r=[];return r.push(s.local?"Z?":"Z"),s.offset&&r.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${r.join("|")})`,new RegExp(`^${e}$`)}function Vh(s,e){return!!((e==="v4"||!e)&&Ah.test(s)||(e==="v6"||!e)&&Lh.test(s))}function zh(s,e){if(!Oh.test(s))return!1;try{let[r]=s.split("."),a=r.replace(/-/g,"+").replace(/_/g,"/").padEnd(r.length+(4-r.length%4)%4,"="),t=JSON.parse(atob(a));return!(typeof t!="object"||t===null||!t.typ||!t.alg||e&&t.alg!==e)}catch{return!1}}function Bh(s,e){return!!((e==="v4"||!e)&&Nh.test(s)||(e==="v6"||!e)&&Fh.test(s))}var Ot=class s extends Q{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==j.string){let n=this._getOrReturnCtx(e);return N(n,{code:k.invalid_type,expected:j.string,received:n.parsedType}),W}let a=new Ie,t;for(let n of this._def.checks)if(n.kind==="min")e.data.length<n.value&&(t=this._getOrReturnCtx(e,t),N(t,{code:k.too_small,minimum:n.value,type:"string",inclusive:!0,exact:!1,message:n.message}),a.dirty());else if(n.kind==="max")e.data.length>n.value&&(t=this._getOrReturnCtx(e,t),N(t,{code:k.too_big,maximum:n.value,type:"string",inclusive:!0,exact:!1,message:n.message}),a.dirty());else if(n.kind==="length"){let o=e.data.length>n.value,i=e.data.length<n.value;(o||i)&&(t=this._getOrReturnCtx(e,t),o?N(t,{code:k.too_big,maximum:n.value,type:"string",inclusive:!0,exact:!0,message:n.message}):i&&N(t,{code:k.too_small,minimum:n.value,type:"string",inclusive:!0,exact:!0,message:n.message}),a.dirty())}else if(n.kind==="email")$h.test(e.data)||(t=this._getOrReturnCtx(e,t),N(t,{validation:"email",code:k.invalid_string,message:n.message}),a.dirty());else if(n.kind==="emoji")sn||(sn=new RegExp(Ih,"u")),sn.test(e.data)||(t=this._getOrReturnCtx(e,t),N(t,{validation:"emoji",code:k.invalid_string,message:n.message}),a.dirty());else if(n.kind==="uuid")Rh.test(e.data)||(t=this._getOrReturnCtx(e,t),N(t,{validation:"uuid",code:k.invalid_string,message:n.message}),a.dirty());else if(n.kind==="nanoid")kh.test(e.data)||(t=this._getOrReturnCtx(e,t),N(t,{validation:"nanoid",code:k.invalid_string,message:n.message}),a.dirty());else if(n.kind==="cuid")wh.test(e.data)||(t=this._getOrReturnCtx(e,t),N(t,{validation:"cuid",code:k.invalid_string,message:n.message}),a.dirty());else if(n.kind==="cuid2")Th.test(e.data)||(t=this._getOrReturnCtx(e,t),N(t,{validation:"cuid2",code:k.invalid_string,message:n.message}),a.dirty());else if(n.kind==="ulid")Ch.test(e.data)||(t=this._getOrReturnCtx(e,t),N(t,{validation:"ulid",code:k.invalid_string,message:n.message}),a.dirty());else if(n.kind==="url")try{new URL(e.data)}catch{t=this._getOrReturnCtx(e,t),N(t,{validation:"url",code:k.invalid_string,message:n.message}),a.dirty()}else n.kind==="regex"?(n.regex.lastIndex=0,n.regex.test(e.data)||(t=this._getOrReturnCtx(e,t),N(t,{validation:"regex",code:k.invalid_string,message:n.message}),a.dirty())):n.kind==="trim"?e.data=e.data.trim():n.kind==="includes"?e.data.includes(n.value,n.position)||(t=this._getOrReturnCtx(e,t),N(t,{code:k.invalid_string,validation:{includes:n.value,position:n.position},message:n.message}),a.dirty()):n.kind==="toLowerCase"?e.data=e.data.toLowerCase():n.kind==="toUpperCase"?e.data=e.data.toUpperCase():n.kind==="startsWith"?e.data.startsWith(n.value)||(t=this._getOrReturnCtx(e,t),N(t,{code:k.invalid_string,validation:{startsWith:n.value},message:n.message}),a.dirty()):n.kind==="endsWith"?e.data.endsWith(n.value)||(t=this._getOrReturnCtx(e,t),N(t,{code:k.invalid_string,validation:{endsWith:n.value},message:n.message}),a.dirty()):n.kind==="datetime"?an(n).test(e.data)||(t=this._getOrReturnCtx(e,t),N(t,{code:k.invalid_string,validation:"datetime",message:n.message}),a.dirty()):n.kind==="date"?Uh.test(e.data)||(t=this._getOrReturnCtx(e,t),N(t,{code:k.invalid_string,validation:"date",message:n.message}),a.dirty()):n.kind==="time"?qh(n).test(e.data)||(t=this._getOrReturnCtx(e,t),N(t,{code:k.invalid_string,validation:"time",message:n.message}),a.dirty()):n.kind==="duration"?Dh.test(e.data)||(t=this._getOrReturnCtx(e,t),N(t,{validation:"duration",code:k.invalid_string,message:n.message}),a.dirty()):n.kind==="ip"?Vh(e.data,n.version)||(t=this._getOrReturnCtx(e,t),N(t,{validation:"ip",code:k.invalid_string,message:n.message}),a.dirty()):n.kind==="jwt"?zh(e.data,n.alg)||(t=this._getOrReturnCtx(e,t),N(t,{validation:"jwt",code:k.invalid_string,message:n.message}),a.dirty()):n.kind==="cidr"?Bh(e.data,n.version)||(t=this._getOrReturnCtx(e,t),N(t,{validation:"cidr",code:k.invalid_string,message:n.message}),a.dirty()):n.kind==="base64"?jh.test(e.data)||(t=this._getOrReturnCtx(e,t),N(t,{validation:"base64",code:k.invalid_string,message:n.message}),a.dirty()):n.kind==="base64url"?Mh.test(e.data)||(t=this._getOrReturnCtx(e,t),N(t,{validation:"base64url",code:k.invalid_string,message:n.message}),a.dirty()):te.assertNever(n);return{status:a.value,value:e.data}}_regex(e,r,a){return this.refinement(t=>e.test(t),{validation:r,code:k.invalid_string,...B.errToObj(a)})}_addCheck(e){return new s({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...B.errToObj(e)})}url(e){return this._addCheck({kind:"url",...B.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...B.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...B.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...B.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...B.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...B.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...B.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...B.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...B.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...B.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...B.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...B.errToObj(e)})}datetime(e){var r,a;return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof e?.precision>"u"?null:e?.precision,offset:(r=e?.offset)!==null&&r!==void 0?r:!1,local:(a=e?.local)!==null&&a!==void 0?a:!1,...B.errToObj(e?.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof e?.precision>"u"?null:e?.precision,...B.errToObj(e?.message)})}duration(e){return this._addCheck({kind:"duration",...B.errToObj(e)})}regex(e,r){return this._addCheck({kind:"regex",regex:e,...B.errToObj(r)})}includes(e,r){return this._addCheck({kind:"includes",value:e,position:r?.position,...B.errToObj(r?.message)})}startsWith(e,r){return this._addCheck({kind:"startsWith",value:e,...B.errToObj(r)})}endsWith(e,r){return this._addCheck({kind:"endsWith",value:e,...B.errToObj(r)})}min(e,r){return this._addCheck({kind:"min",value:e,...B.errToObj(r)})}max(e,r){return this._addCheck({kind:"max",value:e,...B.errToObj(r)})}length(e,r){return this._addCheck({kind:"length",value:e,...B.errToObj(r)})}nonempty(e){return this.min(1,B.errToObj(e))}trim(){return new s({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new s({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new s({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isCIDR(){return!!this._def.checks.find(e=>e.kind==="cidr")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get isBase64url(){return!!this._def.checks.find(e=>e.kind==="base64url")}get minLength(){let e=null;for(let r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e}get maxLength(){let e=null;for(let r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e}};Ot.create=s=>{var e;return new Ot({checks:[],typeName:O.ZodString,coerce:(e=s?.coerce)!==null&&e!==void 0?e:!1,...J(s)})};function Hh(s,e){let r=(s.toString().split(".")[1]||"").length,a=(e.toString().split(".")[1]||"").length,t=r>a?r:a,n=parseInt(s.toFixed(t).replace(".","")),o=parseInt(e.toFixed(t).replace(".",""));return n%o/Math.pow(10,t)}var Vt=class s extends Q{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==j.number){let n=this._getOrReturnCtx(e);return N(n,{code:k.invalid_type,expected:j.number,received:n.parsedType}),W}let a,t=new Ie;for(let n of this._def.checks)n.kind==="int"?te.isInteger(e.data)||(a=this._getOrReturnCtx(e,a),N(a,{code:k.invalid_type,expected:"integer",received:"float",message:n.message}),t.dirty()):n.kind==="min"?(n.inclusive?e.data<n.value:e.data<=n.value)&&(a=this._getOrReturnCtx(e,a),N(a,{code:k.too_small,minimum:n.value,type:"number",inclusive:n.inclusive,exact:!1,message:n.message}),t.dirty()):n.kind==="max"?(n.inclusive?e.data>n.value:e.data>=n.value)&&(a=this._getOrReturnCtx(e,a),N(a,{code:k.too_big,maximum:n.value,type:"number",inclusive:n.inclusive,exact:!1,message:n.message}),t.dirty()):n.kind==="multipleOf"?Hh(e.data,n.value)!==0&&(a=this._getOrReturnCtx(e,a),N(a,{code:k.not_multiple_of,multipleOf:n.value,message:n.message}),t.dirty()):n.kind==="finite"?Number.isFinite(e.data)||(a=this._getOrReturnCtx(e,a),N(a,{code:k.not_finite,message:n.message}),t.dirty()):te.assertNever(n);return{status:t.value,value:e.data}}gte(e,r){return this.setLimit("min",e,!0,B.toString(r))}gt(e,r){return this.setLimit("min",e,!1,B.toString(r))}lte(e,r){return this.setLimit("max",e,!0,B.toString(r))}lt(e,r){return this.setLimit("max",e,!1,B.toString(r))}setLimit(e,r,a,t){return new s({...this._def,checks:[...this._def.checks,{kind:e,value:r,inclusive:a,message:B.toString(t)}]})}_addCheck(e){return new s({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:B.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:B.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:B.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:B.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:B.toString(e)})}multipleOf(e,r){return this._addCheck({kind:"multipleOf",value:e,message:B.toString(r)})}finite(e){return this._addCheck({kind:"finite",message:B.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:B.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:B.toString(e)})}get minValue(){let e=null;for(let r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e}get maxValue(){let e=null;for(let r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&te.isInteger(e.value))}get isFinite(){let e=null,r=null;for(let a of this._def.checks){if(a.kind==="finite"||a.kind==="int"||a.kind==="multipleOf")return!0;a.kind==="min"?(r===null||a.value>r)&&(r=a.value):a.kind==="max"&&(e===null||a.value<e)&&(e=a.value)}return Number.isFinite(r)&&Number.isFinite(e)}};Vt.create=s=>new Vt({checks:[],typeName:O.ZodNumber,coerce:s?.coerce||!1,...J(s)});var zt=class s extends Q{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce)try{e.data=BigInt(e.data)}catch{return this._getInvalidInput(e)}if(this._getType(e)!==j.bigint)return this._getInvalidInput(e);let a,t=new Ie;for(let n of this._def.checks)n.kind==="min"?(n.inclusive?e.data<n.value:e.data<=n.value)&&(a=this._getOrReturnCtx(e,a),N(a,{code:k.too_small,type:"bigint",minimum:n.value,inclusive:n.inclusive,message:n.message}),t.dirty()):n.kind==="max"?(n.inclusive?e.data>n.value:e.data>=n.value)&&(a=this._getOrReturnCtx(e,a),N(a,{code:k.too_big,type:"bigint",maximum:n.value,inclusive:n.inclusive,message:n.message}),t.dirty()):n.kind==="multipleOf"?e.data%n.value!==BigInt(0)&&(a=this._getOrReturnCtx(e,a),N(a,{code:k.not_multiple_of,multipleOf:n.value,message:n.message}),t.dirty()):te.assertNever(n);return{status:t.value,value:e.data}}_getInvalidInput(e){let r=this._getOrReturnCtx(e);return N(r,{code:k.invalid_type,expected:j.bigint,received:r.parsedType}),W}gte(e,r){return this.setLimit("min",e,!0,B.toString(r))}gt(e,r){return this.setLimit("min",e,!1,B.toString(r))}lte(e,r){return this.setLimit("max",e,!0,B.toString(r))}lt(e,r){return this.setLimit("max",e,!1,B.toString(r))}setLimit(e,r,a,t){return new s({...this._def,checks:[...this._def.checks,{kind:e,value:r,inclusive:a,message:B.toString(t)}]})}_addCheck(e){return new s({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:B.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:B.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:B.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:B.toString(e)})}multipleOf(e,r){return this._addCheck({kind:"multipleOf",value:e,message:B.toString(r)})}get minValue(){let e=null;for(let r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e}get maxValue(){let e=null;for(let r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e}};zt.create=s=>{var e;return new zt({checks:[],typeName:O.ZodBigInt,coerce:(e=s?.coerce)!==null&&e!==void 0?e:!1,...J(s)})};var Bt=class extends Q{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==j.boolean){let a=this._getOrReturnCtx(e);return N(a,{code:k.invalid_type,expected:j.boolean,received:a.parsedType}),W}return Le(e.data)}};Bt.create=s=>new Bt({typeName:O.ZodBoolean,coerce:s?.coerce||!1,...J(s)});var Ht=class s extends Q{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==j.date){let n=this._getOrReturnCtx(e);return N(n,{code:k.invalid_type,expected:j.date,received:n.parsedType}),W}if(isNaN(e.data.getTime())){let n=this._getOrReturnCtx(e);return N(n,{code:k.invalid_date}),W}let a=new Ie,t;for(let n of this._def.checks)n.kind==="min"?e.data.getTime()<n.value&&(t=this._getOrReturnCtx(e,t),N(t,{code:k.too_small,message:n.message,inclusive:!0,exact:!1,minimum:n.value,type:"date"}),a.dirty()):n.kind==="max"?e.data.getTime()>n.value&&(t=this._getOrReturnCtx(e,t),N(t,{code:k.too_big,message:n.message,inclusive:!0,exact:!1,maximum:n.value,type:"date"}),a.dirty()):te.assertNever(n);return{status:a.value,value:new Date(e.data.getTime())}}_addCheck(e){return new s({...this._def,checks:[...this._def.checks,e]})}min(e,r){return this._addCheck({kind:"min",value:e.getTime(),message:B.toString(r)})}max(e,r){return this._addCheck({kind:"max",value:e.getTime(),message:B.toString(r)})}get minDate(){let e=null;for(let r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(let r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e!=null?new Date(e):null}};Ht.create=s=>new Ht({checks:[],coerce:s?.coerce||!1,typeName:O.ZodDate,...J(s)});var xr=class extends Q{_parse(e){if(this._getType(e)!==j.symbol){let a=this._getOrReturnCtx(e);return N(a,{code:k.invalid_type,expected:j.symbol,received:a.parsedType}),W}return Le(e.data)}};xr.create=s=>new xr({typeName:O.ZodSymbol,...J(s)});var Zt=class extends Q{_parse(e){if(this._getType(e)!==j.undefined){let a=this._getOrReturnCtx(e);return N(a,{code:k.invalid_type,expected:j.undefined,received:a.parsedType}),W}return Le(e.data)}};Zt.create=s=>new Zt({typeName:O.ZodUndefined,...J(s)});var Wt=class extends Q{_parse(e){if(this._getType(e)!==j.null){let a=this._getOrReturnCtx(e);return N(a,{code:k.invalid_type,expected:j.null,received:a.parsedType}),W}return Le(e.data)}};Wt.create=s=>new Wt({typeName:O.ZodNull,...J(s)});var Dt=class extends Q{constructor(){super(...arguments),this._any=!0}_parse(e){return Le(e.data)}};Dt.create=s=>new Dt({typeName:O.ZodAny,...J(s)});var _t=class extends Q{constructor(){super(...arguments),this._unknown=!0}_parse(e){return Le(e.data)}};_t.create=s=>new _t({typeName:O.ZodUnknown,...J(s)});var rt=class extends Q{_parse(e){let r=this._getOrReturnCtx(e);return N(r,{code:k.invalid_type,expected:j.never,received:r.parsedType}),W}};rt.create=s=>new rt({typeName:O.ZodNever,...J(s)});var Er=class extends Q{_parse(e){if(this._getType(e)!==j.undefined){let a=this._getOrReturnCtx(e);return N(a,{code:k.invalid_type,expected:j.void,received:a.parsedType}),W}return Le(e.data)}};Er.create=s=>new Er({typeName:O.ZodVoid,...J(s)});var bt=class s extends Q{_parse(e){let{ctx:r,status:a}=this._processInputParams(e),t=this._def;if(r.parsedType!==j.array)return N(r,{code:k.invalid_type,expected:j.array,received:r.parsedType}),W;if(t.exactLength!==null){let o=r.data.length>t.exactLength.value,i=r.data.length<t.exactLength.value;(o||i)&&(N(r,{code:o?k.too_big:k.too_small,minimum:i?t.exactLength.value:void 0,maximum:o?t.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:t.exactLength.message}),a.dirty())}if(t.minLength!==null&&r.data.length<t.minLength.value&&(N(r,{code:k.too_small,minimum:t.minLength.value,type:"array",inclusive:!0,exact:!1,message:t.minLength.message}),a.dirty()),t.maxLength!==null&&r.data.length>t.maxLength.value&&(N(r,{code:k.too_big,maximum:t.maxLength.value,type:"array",inclusive:!0,exact:!1,message:t.maxLength.message}),a.dirty()),r.common.async)return Promise.all([...r.data].map((o,i)=>t.type._parseAsync(new tt(r,o,r.path,i)))).then(o=>Ie.mergeArray(a,o));let n=[...r.data].map((o,i)=>t.type._parseSync(new tt(r,o,r.path,i)));return Ie.mergeArray(a,n)}get element(){return this._def.type}min(e,r){return new s({...this._def,minLength:{value:e,message:B.toString(r)}})}max(e,r){return new s({...this._def,maxLength:{value:e,message:B.toString(r)}})}length(e,r){return new s({...this._def,exactLength:{value:e,message:B.toString(r)}})}nonempty(e){return this.min(1,e)}};bt.create=(s,e)=>new bt({type:s,minLength:null,maxLength:null,exactLength:null,typeName:O.ZodArray,...J(e)});function Vr(s){if(s instanceof Ue){let e={};for(let r in s.shape){let a=s.shape[r];e[r]=Ve.create(Vr(a))}return new Ue({...s._def,shape:()=>e})}else return s instanceof bt?new bt({...s._def,type:Vr(s.element)}):s instanceof Ve?Ve.create(Vr(s.unwrap())):s instanceof ut?ut.create(Vr(s.unwrap())):s instanceof ct?ct.create(s.items.map(e=>Vr(e))):s}var Ue=class s extends Q{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;let e=this._def.shape(),r=te.objectKeys(e);return this._cached={shape:e,keys:r}}_parse(e){if(this._getType(e)!==j.object){let c=this._getOrReturnCtx(e);return N(c,{code:k.invalid_type,expected:j.object,received:c.parsedType}),W}let{status:a,ctx:t}=this._processInputParams(e),{shape:n,keys:o}=this._getCached(),i=[];if(!(this._def.catchall instanceof rt&&this._def.unknownKeys==="strip"))for(let c in t.data)o.includes(c)||i.push(c);let l=[];for(let c of o){let d=n[c],h=t.data[c];l.push({key:{status:"valid",value:c},value:d._parse(new tt(t,h,t.path,c)),alwaysSet:c in t.data})}if(this._def.catchall instanceof rt){let c=this._def.unknownKeys;if(c==="passthrough")for(let d of i)l.push({key:{status:"valid",value:d},value:{status:"valid",value:t.data[d]}});else if(c==="strict")i.length>0&&(N(t,{code:k.unrecognized_keys,keys:i}),a.dirty());else if(c!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{let c=this._def.catchall;for(let d of i){let h=t.data[d];l.push({key:{status:"valid",value:d},value:c._parse(new tt(t,h,t.path,d)),alwaysSet:d in t.data})}}return t.common.async?Promise.resolve().then(async()=>{let c=[];for(let d of l){let h=await d.key,v=await d.value;c.push({key:h,value:v,alwaysSet:d.alwaysSet})}return c}).then(c=>Ie.mergeObjectSync(a,c)):Ie.mergeObjectSync(a,l)}get shape(){return this._def.shape()}strict(e){return B.errToObj,new s({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(r,a)=>{var t,n,o,i;let l=(o=(n=(t=this._def).errorMap)===null||n===void 0?void 0:n.call(t,r,a).message)!==null&&o!==void 0?o:a.defaultError;return r.code==="unrecognized_keys"?{message:(i=B.errToObj(e).message)!==null&&i!==void 0?i:l}:{message:l}}}:{}})}strip(){return new s({...this._def,unknownKeys:"strip"})}passthrough(){return new s({...this._def,unknownKeys:"passthrough"})}extend(e){return new s({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new s({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:O.ZodObject})}setKey(e,r){return this.augment({[e]:r})}catchall(e){return new s({...this._def,catchall:e})}pick(e){let r={};return te.objectKeys(e).forEach(a=>{e[a]&&this.shape[a]&&(r[a]=this.shape[a])}),new s({...this._def,shape:()=>r})}omit(e){let r={};return te.objectKeys(this.shape).forEach(a=>{e[a]||(r[a]=this.shape[a])}),new s({...this._def,shape:()=>r})}deepPartial(){return Vr(this)}partial(e){let r={};return te.objectKeys(this.shape).forEach(a=>{let t=this.shape[a];e&&!e[a]?r[a]=t:r[a]=t.optional()}),new s({...this._def,shape:()=>r})}required(e){let r={};return te.objectKeys(this.shape).forEach(a=>{if(e&&!e[a])r[a]=this.shape[a];else{let n=this.shape[a];for(;n instanceof Ve;)n=n._def.innerType;r[a]=n}}),new s({...this._def,shape:()=>r})}keyof(){return ho(te.objectKeys(this.shape))}};Ue.create=(s,e)=>new Ue({shape:()=>s,unknownKeys:"strip",catchall:rt.create(),typeName:O.ZodObject,...J(e)}),Ue.strictCreate=(s,e)=>new Ue({shape:()=>s,unknownKeys:"strict",catchall:rt.create(),typeName:O.ZodObject,...J(e)}),Ue.lazycreate=(s,e)=>new Ue({shape:s,unknownKeys:"strip",catchall:rt.create(),typeName:O.ZodObject,...J(e)});var Gt=class extends Q{_parse(e){let{ctx:r}=this._processInputParams(e),a=this._def.options;function t(n){for(let i of n)if(i.result.status==="valid")return i.result;for(let i of n)if(i.result.status==="dirty")return r.common.issues.push(...i.ctx.common.issues),i.result;let o=n.map(i=>new He(i.ctx.common.issues));return N(r,{code:k.invalid_union,unionErrors:o}),W}if(r.common.async)return Promise.all(a.map(async n=>{let o={...r,common:{...r.common,issues:[]},parent:null};return{result:await n._parseAsync({data:r.data,path:r.path,parent:o}),ctx:o}})).then(t);{let n,o=[];for(let l of a){let c={...r,common:{...r.common,issues:[]},parent:null},d=l._parseSync({data:r.data,path:r.path,parent:c});if(d.status==="valid")return d;d.status==="dirty"&&!n&&(n={result:d,ctx:c}),c.common.issues.length&&o.push(c.common.issues)}if(n)return r.common.issues.push(...n.ctx.common.issues),n.result;let i=o.map(l=>new He(l));return N(r,{code:k.invalid_union,unionErrors:i}),W}}get options(){return this._def.options}};Gt.create=(s,e)=>new Gt({options:s,typeName:O.ZodUnion,...J(e)});var $t=s=>s instanceof Jt?$t(s.schema):s instanceof qe?$t(s.innerType()):s instanceof Kt?[s.value]:s instanceof Yt?s.options:s instanceof Xt?te.objectValues(s.enum):s instanceof er?$t(s._def.innerType):s instanceof Zt?[void 0]:s instanceof Wt?[null]:s instanceof Ve?[void 0,...$t(s.unwrap())]:s instanceof ut?[null,...$t(s.unwrap())]:s instanceof zr||s instanceof rr?$t(s.unwrap()):s instanceof tr?$t(s._def.innerType):[],us=class s extends Q{_parse(e){let{ctx:r}=this._processInputParams(e);if(r.parsedType!==j.object)return N(r,{code:k.invalid_type,expected:j.object,received:r.parsedType}),W;let a=this.discriminator,t=r.data[a],n=this.optionsMap.get(t);return n?r.common.async?n._parseAsync({data:r.data,path:r.path,parent:r}):n._parseSync({data:r.data,path:r.path,parent:r}):(N(r,{code:k.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[a]}),W)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,r,a){let t=new Map;for(let n of r){let o=$t(n.shape[e]);if(!o.length)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(let i of o){if(t.has(i))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(i)}`);t.set(i,n)}}return new s({typeName:O.ZodDiscriminatedUnion,discriminator:e,options:r,optionsMap:t,...J(a)})}};function nn(s,e){let r=yt(s),a=yt(e);if(s===e)return{valid:!0,data:s};if(r===j.object&&a===j.object){let t=te.objectKeys(e),n=te.objectKeys(s).filter(i=>t.indexOf(i)!==-1),o={...s,...e};for(let i of n){let l=nn(s[i],e[i]);if(!l.valid)return{valid:!1};o[i]=l.data}return{valid:!0,data:o}}else if(r===j.array&&a===j.array){if(s.length!==e.length)return{valid:!1};let t=[];for(let n=0;n<s.length;n++){let o=s[n],i=e[n],l=nn(o,i);if(!l.valid)return{valid:!1};t.push(l.data)}return{valid:!0,data:t}}else return r===j.date&&a===j.date&&+s==+e?{valid:!0,data:s}:{valid:!1}}var Qt=class extends Q{_parse(e){let{status:r,ctx:a}=this._processInputParams(e),t=(n,o)=>{if(Ns(n)||Ns(o))return W;let i=nn(n.value,o.value);return i.valid?((Ls(n)||Ls(o))&&r.dirty(),{status:r.value,value:i.data}):(N(a,{code:k.invalid_intersection_types}),W)};return a.common.async?Promise.all([this._def.left._parseAsync({data:a.data,path:a.path,parent:a}),this._def.right._parseAsync({data:a.data,path:a.path,parent:a})]).then(([n,o])=>t(n,o)):t(this._def.left._parseSync({data:a.data,path:a.path,parent:a}),this._def.right._parseSync({data:a.data,path:a.path,parent:a}))}};Qt.create=(s,e,r)=>new Qt({left:s,right:e,typeName:O.ZodIntersection,...J(r)});var ct=class s extends Q{_parse(e){let{status:r,ctx:a}=this._processInputParams(e);if(a.parsedType!==j.array)return N(a,{code:k.invalid_type,expected:j.array,received:a.parsedType}),W;if(a.data.length<this._def.items.length)return N(a,{code:k.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),W;!this._def.rest&&a.data.length>this._def.items.length&&(N(a,{code:k.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),r.dirty());let n=[...a.data].map((o,i)=>{let l=this._def.items[i]||this._def.rest;return l?l._parse(new tt(a,o,a.path,i)):null}).filter(o=>!!o);return a.common.async?Promise.all(n).then(o=>Ie.mergeArray(r,o)):Ie.mergeArray(r,n)}get items(){return this._def.items}rest(e){return new s({...this._def,rest:e})}};ct.create=(s,e)=>{if(!Array.isArray(s))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new ct({items:s,typeName:O.ZodTuple,rest:null,...J(e)})};var ds=class s extends Q{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){let{status:r,ctx:a}=this._processInputParams(e);if(a.parsedType!==j.object)return N(a,{code:k.invalid_type,expected:j.object,received:a.parsedType}),W;let t=[],n=this._def.keyType,o=this._def.valueType;for(let i in a.data)t.push({key:n._parse(new tt(a,i,a.path,i)),value:o._parse(new tt(a,a.data[i],a.path,i)),alwaysSet:i in a.data});return a.common.async?Ie.mergeObjectAsync(r,t):Ie.mergeObjectSync(r,t)}get element(){return this._def.valueType}static create(e,r,a){return r instanceof Q?new s({keyType:e,valueType:r,typeName:O.ZodRecord,...J(a)}):new s({keyType:Ot.create(),valueType:e,typeName:O.ZodRecord,...J(r)})}},Sr=class extends Q{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){let{status:r,ctx:a}=this._processInputParams(e);if(a.parsedType!==j.map)return N(a,{code:k.invalid_type,expected:j.map,received:a.parsedType}),W;let t=this._def.keyType,n=this._def.valueType,o=[...a.data.entries()].map(([i,l],c)=>({key:t._parse(new tt(a,i,a.path,[c,"key"])),value:n._parse(new tt(a,l,a.path,[c,"value"]))}));if(a.common.async){let i=new Map;return Promise.resolve().then(async()=>{for(let l of o){let c=await l.key,d=await l.value;if(c.status==="aborted"||d.status==="aborted")return W;(c.status==="dirty"||d.status==="dirty")&&r.dirty(),i.set(c.value,d.value)}return{status:r.value,value:i}})}else{let i=new Map;for(let l of o){let c=l.key,d=l.value;if(c.status==="aborted"||d.status==="aborted")return W;(c.status==="dirty"||d.status==="dirty")&&r.dirty(),i.set(c.value,d.value)}return{status:r.value,value:i}}}};Sr.create=(s,e,r)=>new Sr({valueType:e,keyType:s,typeName:O.ZodMap,...J(r)});var Pr=class s extends Q{_parse(e){let{status:r,ctx:a}=this._processInputParams(e);if(a.parsedType!==j.set)return N(a,{code:k.invalid_type,expected:j.set,received:a.parsedType}),W;let t=this._def;t.minSize!==null&&a.data.size<t.minSize.value&&(N(a,{code:k.too_small,minimum:t.minSize.value,type:"set",inclusive:!0,exact:!1,message:t.minSize.message}),r.dirty()),t.maxSize!==null&&a.data.size>t.maxSize.value&&(N(a,{code:k.too_big,maximum:t.maxSize.value,type:"set",inclusive:!0,exact:!1,message:t.maxSize.message}),r.dirty());let n=this._def.valueType;function o(l){let c=new Set;for(let d of l){if(d.status==="aborted")return W;d.status==="dirty"&&r.dirty(),c.add(d.value)}return{status:r.value,value:c}}let i=[...a.data.values()].map((l,c)=>n._parse(new tt(a,l,a.path,c)));return a.common.async?Promise.all(i).then(l=>o(l)):o(i)}min(e,r){return new s({...this._def,minSize:{value:e,message:B.toString(r)}})}max(e,r){return new s({...this._def,maxSize:{value:e,message:B.toString(r)}})}size(e,r){return this.min(e,r).max(e,r)}nonempty(e){return this.min(1,e)}};Pr.create=(s,e)=>new Pr({valueType:s,minSize:null,maxSize:null,typeName:O.ZodSet,...J(e)});var fs=class s extends Q{constructor(){super(...arguments),this.validate=this.implement}_parse(e){let{ctx:r}=this._processInputParams(e);if(r.parsedType!==j.function)return N(r,{code:k.invalid_type,expected:j.function,received:r.parsedType}),W;function a(i,l){return os({data:i,path:r.path,errorMaps:[r.common.contextualErrorMap,r.schemaErrorMap,is(),_r].filter(c=>!!c),issueData:{code:k.invalid_arguments,argumentsError:l}})}function t(i,l){return os({data:i,path:r.path,errorMaps:[r.common.contextualErrorMap,r.schemaErrorMap,is(),_r].filter(c=>!!c),issueData:{code:k.invalid_return_type,returnTypeError:l}})}let n={errorMap:r.common.contextualErrorMap},o=r.data;if(this._def.returns instanceof It){let i=this;return Le(async function(...l){let c=new He([]),d=await i._def.args.parseAsync(l,n).catch(f=>{throw c.addIssue(a(l,f)),c}),h=await Reflect.apply(o,this,d);return await i._def.returns._def.type.parseAsync(h,n).catch(f=>{throw c.addIssue(t(h,f)),c})})}else{let i=this;return Le(function(...l){let c=i._def.args.safeParse(l,n);if(!c.success)throw new He([a(l,c.error)]);let d=Reflect.apply(o,this,c.data),h=i._def.returns.safeParse(d,n);if(!h.success)throw new He([t(d,h.error)]);return h.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new s({...this._def,args:ct.create(e).rest(_t.create())})}returns(e){return new s({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,r,a){return new s({args:e||ct.create([]).rest(_t.create()),returns:r||_t.create(),typeName:O.ZodFunction,...J(a)})}},Jt=class extends Q{get schema(){return this._def.getter()}_parse(e){let{ctx:r}=this._processInputParams(e);return this._def.getter()._parse({data:r.data,path:r.path,parent:r})}};Jt.create=(s,e)=>new Jt({getter:s,typeName:O.ZodLazy,...J(e)});var Kt=class extends Q{_parse(e){if(e.data!==this._def.value){let r=this._getOrReturnCtx(e);return N(r,{received:r.data,code:k.invalid_literal,expected:this._def.value}),W}return{status:"valid",value:e.data}}get value(){return this._def.value}};Kt.create=(s,e)=>new Kt({value:s,typeName:O.ZodLiteral,...J(e)});function ho(s,e){return new Yt({values:s,typeName:O.ZodEnum,...J(e)})}var Yt=class s extends Q{constructor(){super(...arguments),ls.set(this,void 0)}_parse(e){if(typeof e.data!="string"){let r=this._getOrReturnCtx(e),a=this._def.values;return N(r,{expected:te.joinValues(a),received:r.parsedType,code:k.invalid_type}),W}if(Fs(this,ls,"f")||lo(this,ls,new Set(this._def.values),"f"),!Fs(this,ls,"f").has(e.data)){let r=this._getOrReturnCtx(e),a=this._def.values;return N(r,{received:r.data,code:k.invalid_enum_value,options:a}),W}return Le(e.data)}get options(){return this._def.values}get enum(){let e={};for(let r of this._def.values)e[r]=r;return e}get Values(){let e={};for(let r of this._def.values)e[r]=r;return e}get Enum(){let e={};for(let r of this._def.values)e[r]=r;return e}extract(e,r=this._def){return s.create(e,{...this._def,...r})}exclude(e,r=this._def){return s.create(this.options.filter(a=>!e.includes(a)),{...this._def,...r})}};ls=new WeakMap,Yt.create=ho;var Xt=class extends Q{constructor(){super(...arguments),cs.set(this,void 0)}_parse(e){let r=te.getValidEnumValues(this._def.values),a=this._getOrReturnCtx(e);if(a.parsedType!==j.string&&a.parsedType!==j.number){let t=te.objectValues(r);return N(a,{expected:te.joinValues(t),received:a.parsedType,code:k.invalid_type}),W}if(Fs(this,cs,"f")||lo(this,cs,new Set(te.getValidEnumValues(this._def.values)),"f"),!Fs(this,cs,"f").has(e.data)){let t=te.objectValues(r);return N(a,{received:a.data,code:k.invalid_enum_value,options:t}),W}return Le(e.data)}get enum(){return this._def.values}};cs=new WeakMap,Xt.create=(s,e)=>new Xt({values:s,typeName:O.ZodNativeEnum,...J(e)});var It=class extends Q{unwrap(){return this._def.type}_parse(e){let{ctx:r}=this._processInputParams(e);if(r.parsedType!==j.promise&&r.common.async===!1)return N(r,{code:k.invalid_type,expected:j.promise,received:r.parsedType}),W;let a=r.parsedType===j.promise?r.data:Promise.resolve(r.data);return Le(a.then(t=>this._def.type.parseAsync(t,{path:r.path,errorMap:r.common.contextualErrorMap})))}};It.create=(s,e)=>new It({type:s,typeName:O.ZodPromise,...J(e)});var qe=class extends Q{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===O.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){let{status:r,ctx:a}=this._processInputParams(e),t=this._def.effect||null,n={addIssue:o=>{N(a,o),o.fatal?r.abort():r.dirty()},get path(){return a.path}};if(n.addIssue=n.addIssue.bind(n),t.type==="preprocess"){let o=t.transform(a.data,n);if(a.common.async)return Promise.resolve(o).then(async i=>{if(r.value==="aborted")return W;let l=await this._def.schema._parseAsync({data:i,path:a.path,parent:a});return l.status==="aborted"?W:l.status==="dirty"||r.value==="dirty"?br(l.value):l});{if(r.value==="aborted")return W;let i=this._def.schema._parseSync({data:o,path:a.path,parent:a});return i.status==="aborted"?W:i.status==="dirty"||r.value==="dirty"?br(i.value):i}}if(t.type==="refinement"){let o=i=>{let l=t.refinement(i,n);if(a.common.async)return Promise.resolve(l);if(l instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return i};if(a.common.async===!1){let i=this._def.schema._parseSync({data:a.data,path:a.path,parent:a});return i.status==="aborted"?W:(i.status==="dirty"&&r.dirty(),o(i.value),{status:r.value,value:i.value})}else return this._def.schema._parseAsync({data:a.data,path:a.path,parent:a}).then(i=>i.status==="aborted"?W:(i.status==="dirty"&&r.dirty(),o(i.value).then(()=>({status:r.value,value:i.value}))))}if(t.type==="transform")if(a.common.async===!1){let o=this._def.schema._parseSync({data:a.data,path:a.path,parent:a});if(!qt(o))return o;let i=t.transform(o.value,n);if(i instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:r.value,value:i}}else return this._def.schema._parseAsync({data:a.data,path:a.path,parent:a}).then(o=>qt(o)?Promise.resolve(t.transform(o.value,n)).then(i=>({status:r.value,value:i})):o);te.assertNever(t)}};qe.create=(s,e,r)=>new qe({schema:s,typeName:O.ZodEffects,effect:e,...J(r)}),qe.createWithPreprocess=(s,e,r)=>new qe({schema:e,effect:{type:"preprocess",transform:s},typeName:O.ZodEffects,...J(r)});var Ve=class extends Q{_parse(e){return this._getType(e)===j.undefined?Le(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}};Ve.create=(s,e)=>new Ve({innerType:s,typeName:O.ZodOptional,...J(e)});var ut=class extends Q{_parse(e){return this._getType(e)===j.null?Le(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}};ut.create=(s,e)=>new ut({innerType:s,typeName:O.ZodNullable,...J(e)});var er=class extends Q{_parse(e){let{ctx:r}=this._processInputParams(e),a=r.data;return r.parsedType===j.undefined&&(a=this._def.defaultValue()),this._def.innerType._parse({data:a,path:r.path,parent:r})}removeDefault(){return this._def.innerType}};er.create=(s,e)=>new er({innerType:s,typeName:O.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...J(e)});var tr=class extends Q{_parse(e){let{ctx:r}=this._processInputParams(e),a={...r,common:{...r.common,issues:[]}},t=this._def.innerType._parse({data:a.data,path:a.path,parent:{...a}});return qr(t)?t.then(n=>({status:"valid",value:n.status==="valid"?n.value:this._def.catchValue({get error(){return new He(a.common.issues)},input:a.data})})):{status:"valid",value:t.status==="valid"?t.value:this._def.catchValue({get error(){return new He(a.common.issues)},input:a.data})}}removeCatch(){return this._def.innerType}};tr.create=(s,e)=>new tr({innerType:s,typeName:O.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...J(e)});var wr=class extends Q{_parse(e){if(this._getType(e)!==j.nan){let a=this._getOrReturnCtx(e);return N(a,{code:k.invalid_type,expected:j.nan,received:a.parsedType}),W}return{status:"valid",value:e.data}}};wr.create=s=>new wr({typeName:O.ZodNaN,...J(s)});var po=Symbol("zod_brand"),zr=class extends Q{_parse(e){let{ctx:r}=this._processInputParams(e),a=r.data;return this._def.type._parse({data:a,path:r.path,parent:r})}unwrap(){return this._def.type}},Br=class s extends Q{_parse(e){let{status:r,ctx:a}=this._processInputParams(e);if(a.common.async)return(async()=>{let n=await this._def.in._parseAsync({data:a.data,path:a.path,parent:a});return n.status==="aborted"?W:n.status==="dirty"?(r.dirty(),br(n.value)):this._def.out._parseAsync({data:n.value,path:a.path,parent:a})})();{let t=this._def.in._parseSync({data:a.data,path:a.path,parent:a});return t.status==="aborted"?W:t.status==="dirty"?(r.dirty(),{status:"dirty",value:t.value}):this._def.out._parseSync({data:t.value,path:a.path,parent:a})}}static create(e,r){return new s({in:e,out:r,typeName:O.ZodPipeline})}},rr=class extends Q{_parse(e){let r=this._def.innerType._parse(e),a=t=>(qt(t)&&(t.value=Object.freeze(t.value)),t);return qr(r)?r.then(t=>a(t)):a(r)}unwrap(){return this._def.innerType}};rr.create=(s,e)=>new rr({innerType:s,typeName:O.ZodReadonly,...J(e)});function mo(s,e){let r=typeof s=="function"?s(e):typeof s=="string"?{message:s}:s;return typeof r=="string"?{message:r}:r}function on(s,e={},r){return s?Dt.create().superRefine((a,t)=>{var n,o;let i=s(a);if(i instanceof Promise)return i.then(l=>{var c,d;if(!l){let h=mo(e,a),v=(d=(c=h.fatal)!==null&&c!==void 0?c:r)!==null&&d!==void 0?d:!0;t.addIssue({code:"custom",...h,fatal:v})}});if(!i){let l=mo(e,a),c=(o=(n=l.fatal)!==null&&n!==void 0?n:r)!==null&&o!==void 0?o:!0;t.addIssue({code:"custom",...l,fatal:c})}}):Dt.create()}var vo={object:Ue.lazycreate},O;(function(s){s.ZodString="ZodString",s.ZodNumber="ZodNumber",s.ZodNaN="ZodNaN",s.ZodBigInt="ZodBigInt",s.ZodBoolean="ZodBoolean",s.ZodDate="ZodDate",s.ZodSymbol="ZodSymbol",s.ZodUndefined="ZodUndefined",s.ZodNull="ZodNull",s.ZodAny="ZodAny",s.ZodUnknown="ZodUnknown",s.ZodNever="ZodNever",s.ZodVoid="ZodVoid",s.ZodArray="ZodArray",s.ZodObject="ZodObject",s.ZodUnion="ZodUnion",s.ZodDiscriminatedUnion="ZodDiscriminatedUnion",s.ZodIntersection="ZodIntersection",s.ZodTuple="ZodTuple",s.ZodRecord="ZodRecord",s.ZodMap="ZodMap",s.ZodSet="ZodSet",s.ZodFunction="ZodFunction",s.ZodLazy="ZodLazy",s.ZodLiteral="ZodLiteral",s.ZodEnum="ZodEnum",s.ZodEffects="ZodEffects",s.ZodNativeEnum="ZodNativeEnum",s.ZodOptional="ZodOptional",s.ZodNullable="ZodNullable",s.ZodDefault="ZodDefault",s.ZodCatch="ZodCatch",s.ZodPromise="ZodPromise",s.ZodBranded="ZodBranded",s.ZodPipeline="ZodPipeline",s.ZodReadonly="ZodReadonly"})(O||(O={}));var go=(s,e={message:`Input not instance of ${s.name}`})=>on(r=>r instanceof s,e),ln=Ot.create,cn=Vt.create,yo=wr.create,_o=zt.create,un=Bt.create,bo=Ht.create,xo=xr.create,Eo=Zt.create,So=Wt.create,Po=Dt.create,wo=_t.create,To=rt.create,Co=Er.create,Ro=bt.create,ko=Ue.create,Oo=Ue.strictCreate,Do=Gt.create,$o=us.create,Io=Qt.create,Ao=ct.create,No=ds.create,Lo=Sr.create,Fo=Pr.create,jo=fs.create,Mo=Jt.create,Uo=Kt.create,qo=Yt.create,Vo=Xt.create,zo=It.create,js=qe.create,Bo=Ve.create,Ho=ut.create,Zo=qe.createWithPreprocess,Wo=Br.create,Go=()=>ln().optional(),Qo=()=>cn().optional(),Jo=()=>un().optional(),Ko={string:s=>Ot.create({...s,coerce:!0}),number:s=>Vt.create({...s,coerce:!0}),boolean:s=>Bt.create({...s,coerce:!0}),bigint:s=>zt.create({...s,coerce:!0}),date:s=>Ht.create({...s,coerce:!0})},Yo=W,u=Object.freeze({__proto__:null,defaultErrorMap:_r,setErrorMap:io,getErrorMap:is,makeIssue:os,EMPTY_PATH:oo,addIssueToContext:N,ParseStatus:Ie,INVALID:W,DIRTY:br,OK:Le,isAborted:Ns,isDirty:Ls,isValid:qt,isAsync:qr,get util(){return te},get objectUtil(){return As},ZodParsedType:j,getParsedType:yt,ZodType:Q,datetimeRegex:an,ZodString:Ot,ZodNumber:Vt,ZodBigInt:zt,ZodBoolean:Bt,ZodDate:Ht,ZodSymbol:xr,ZodUndefined:Zt,ZodNull:Wt,ZodAny:Dt,ZodUnknown:_t,ZodNever:rt,ZodVoid:Er,ZodArray:bt,ZodObject:Ue,ZodUnion:Gt,ZodDiscriminatedUnion:us,ZodIntersection:Qt,ZodTuple:ct,ZodRecord:ds,ZodMap:Sr,ZodSet:Pr,ZodFunction:fs,ZodLazy:Jt,ZodLiteral:Kt,ZodEnum:Yt,ZodNativeEnum:Xt,ZodPromise:It,ZodEffects:qe,ZodTransformer:qe,ZodOptional:Ve,ZodNullable:ut,ZodDefault:er,ZodCatch:tr,ZodNaN:wr,BRAND:po,ZodBranded:zr,ZodPipeline:Br,ZodReadonly:rr,custom:on,Schema:Q,ZodSchema:Q,late:vo,get ZodFirstPartyTypeKind(){return O},coerce:Ko,any:Po,array:Ro,bigint:_o,boolean:un,date:bo,discriminatedUnion:$o,effect:js,enum:qo,function:jo,instanceof:go,intersection:Io,lazy:Mo,literal:Uo,map:Lo,nan:yo,nativeEnum:Vo,never:To,null:So,nullable:Ho,number:cn,object:ko,oboolean:Jo,onumber:Qo,optional:Bo,ostring:Go,pipeline:Wo,preprocess:Zo,promise:zo,record:No,set:Fo,strictObject:Oo,string:ln,symbol:xo,transformer:js,tuple:Ao,undefined:Eo,union:Do,unknown:wo,void:Co,NEVER:Yo,ZodIssueCode:k,quotelessJson:ao,ZodError:He});var pn="2025-06-18",Ty="2025-03-26",pl=[pn,"2025-03-26","2024-11-05","2024-10-07"],Ms="2.0",Xo=u.union([u.string(),u.number().int()]),el=u.string(),Zh=u.object({progressToken:u.optional(Xo)}).passthrough(),st=u.object({_meta:u.optional(Zh)}).passthrough(),Ze=u.object({method:u.string(),params:u.optional(st)}),hs=u.object({_meta:u.optional(u.object({}).passthrough())}).passthrough(),xt=u.object({method:u.string(),params:u.optional(hs)}),at=u.object({_meta:u.optional(u.object({}).passthrough())}).passthrough(),Us=u.union([u.string(),u.number().int()]),tl=u.object({jsonrpc:u.literal(Ms),id:Us}).merge(Ze).strict(),ml=s=>tl.safeParse(s).success,rl=u.object({jsonrpc:u.literal(Ms)}).merge(xt).strict(),vl=s=>rl.safeParse(s).success,sl=u.object({jsonrpc:u.literal(Ms),id:Us,result:at}).strict(),mn=s=>sl.safeParse(s).success,pe;(function(s){s[s.ConnectionClosed=-32e3]="ConnectionClosed",s[s.RequestTimeout=-32001]="RequestTimeout",s[s.ParseError=-32700]="ParseError",s[s.InvalidRequest=-32600]="InvalidRequest",s[s.MethodNotFound=-32601]="MethodNotFound",s[s.InvalidParams=-32602]="InvalidParams",s[s.InternalError=-32603]="InternalError"})(pe||(pe={}));var al=u.object({jsonrpc:u.literal(Ms),id:Us,error:u.object({code:u.number().int(),message:u.string(),data:u.optional(u.unknown())})}).strict(),gl=s=>al.safeParse(s).success,yl=u.union([tl,rl,sl,al]),zs=at.strict(),Bs=xt.extend({method:u.literal("notifications/cancelled"),params:hs.extend({requestId:Us,reason:u.string().optional()})}),ps=u.object({name:u.string(),title:u.optional(u.string())}).passthrough(),nl=ps.extend({version:u.string()}),Wh=u.object({experimental:u.optional(u.object({}).passthrough()),sampling:u.optional(u.object({}).passthrough()),elicitation:u.optional(u.object({}).passthrough()),roots:u.optional(u.object({listChanged:u.optional(u.boolean())}).passthrough())}).passthrough(),Hs=Ze.extend({method:u.literal("initialize"),params:st.extend({protocolVersion:u.string(),capabilities:Wh,clientInfo:nl})}),Cy=s=>Hs.safeParse(s).success,Gh=u.object({experimental:u.optional(u.object({}).passthrough()),logging:u.optional(u.object({}).passthrough()),completions:u.optional(u.object({}).passthrough()),prompts:u.optional(u.object({listChanged:u.optional(u.boolean())}).passthrough()),resources:u.optional(u.object({subscribe:u.optional(u.boolean()),listChanged:u.optional(u.boolean())}).passthrough()),tools:u.optional(u.object({listChanged:u.optional(u.boolean())}).passthrough())}).passthrough(),Qh=at.extend({protocolVersion:u.string(),capabilities:Gh,serverInfo:nl,instructions:u.optional(u.string())}),Zs=xt.extend({method:u.literal("notifications/initialized")}),Ry=s=>Zs.safeParse(s).success,Ws=Ze.extend({method:u.literal("ping")}),Jh=u.object({progress:u.number(),total:u.optional(u.number()),message:u.optional(u.string())}).passthrough(),Gs=xt.extend({method:u.literal("notifications/progress"),params:hs.merge(Jh).extend({progressToken:Xo})}),qs=Ze.extend({params:st.extend({cursor:u.optional(el)}).optional()}),Vs=at.extend({nextCursor:u.optional(el)}),il=u.object({uri:u.string(),mimeType:u.optional(u.string()),_meta:u.optional(u.object({}).passthrough())}).passthrough(),ol=il.extend({text:u.string()}),ll=il.extend({blob:u.string().base64()}),cl=ps.extend({uri:u.string(),description:u.optional(u.string()),mimeType:u.optional(u.string()),_meta:u.optional(u.object({}).passthrough())}),Kh=ps.extend({uriTemplate:u.string(),description:u.optional(u.string()),mimeType:u.optional(u.string()),_meta:u.optional(u.object({}).passthrough())}),Qs=qs.extend({method:u.literal("resources/list")}),Yh=Vs.extend({resources:u.array(cl)}),Js=qs.extend({method:u.literal("resources/templates/list")}),Xh=Vs.extend({resourceTemplates:u.array(Kh)}),Ks=Ze.extend({method:u.literal("resources/read"),params:st.extend({uri:u.string()})}),ep=at.extend({contents:u.array(u.union([ol,ll]))}),tp=xt.extend({method:u.literal("notifications/resources/list_changed")}),rp=Ze.extend({method:u.literal("resources/subscribe"),params:st.extend({uri:u.string()})}),sp=Ze.extend({method:u.literal("resources/unsubscribe"),params:st.extend({uri:u.string()})}),ap=xt.extend({method:u.literal("notifications/resources/updated"),params:hs.extend({uri:u.string()})}),np=u.object({name:u.string(),description:u.optional(u.string()),required:u.optional(u.boolean())}).passthrough(),ip=ps.extend({description:u.optional(u.string()),arguments:u.optional(u.array(np)),_meta:u.optional(u.object({}).passthrough())}),Ys=qs.extend({method:u.literal("prompts/list")}),op=Vs.extend({prompts:u.array(ip)}),Xs=Ze.extend({method:u.literal("prompts/get"),params:st.extend({name:u.string(),arguments:u.optional(u.record(u.string()))})}),dn=u.object({type:u.literal("text"),text:u.string(),_meta:u.optional(u.object({}).passthrough())}).passthrough(),fn=u.object({type:u.literal("image"),data:u.string().base64(),mimeType:u.string(),_meta:u.optional(u.object({}).passthrough())}).passthrough(),hn=u.object({type:u.literal("audio"),data:u.string().base64(),mimeType:u.string(),_meta:u.optional(u.object({}).passthrough())}).passthrough(),lp=u.object({type:u.literal("resource"),resource:u.union([ol,ll]),_meta:u.optional(u.object({}).passthrough())}).passthrough(),cp=cl.extend({type:u.literal("resource_link")}),ul=u.union([dn,fn,hn,cp,lp]),up=u.object({role:u.enum(["user","assistant"]),content:ul}).passthrough(),dp=at.extend({description:u.optional(u.string()),messages:u.array(up)}),fp=xt.extend({method:u.literal("notifications/prompts/list_changed")}),hp=u.object({title:u.optional(u.string()),readOnlyHint:u.optional(u.boolean()),destructiveHint:u.optional(u.boolean()),idempotentHint:u.optional(u.boolean()),openWorldHint:u.optional(u.boolean())}).passthrough(),pp=ps.extend({description:u.optional(u.string()),inputSchema:u.object({type:u.literal("object"),properties:u.optional(u.object({}).passthrough()),required:u.optional(u.array(u.string()))}).passthrough(),outputSchema:u.optional(u.object({type:u.literal("object"),properties:u.optional(u.object({}).passthrough()),required:u.optional(u.array(u.string()))}).passthrough()),annotations:u.optional(hp),_meta:u.optional(u.object({}).passthrough())}),ea=qs.extend({method:u.literal("tools/list")}),mp=Vs.extend({tools:u.array(pp)}),dl=at.extend({content:u.array(ul).default([]),structuredContent:u.object({}).passthrough().optional(),isError:u.optional(u.boolean())}),ky=dl.or(at.extend({toolResult:u.unknown()})),ta=Ze.extend({method:u.literal("tools/call"),params:st.extend({name:u.string(),arguments:u.optional(u.record(u.unknown()))})}),vp=xt.extend({method:u.literal("notifications/tools/list_changed")}),fl=u.enum(["debug","info","notice","warning","error","critical","alert","emergency"]),gp=Ze.extend({method:u.literal("logging/setLevel"),params:st.extend({level:fl})}),yp=xt.extend({method:u.literal("notifications/message"),params:hs.extend({level:fl,logger:u.optional(u.string()),data:u.unknown()})}),_p=u.object({name:u.string().optional()}).passthrough(),bp=u.object({hints:u.optional(u.array(_p)),costPriority:u.optional(u.number().min(0).max(1)),speedPriority:u.optional(u.number().min(0).max(1)),intelligencePriority:u.optional(u.number().min(0).max(1))}).passthrough(),xp=u.object({role:u.enum(["user","assistant"]),content:u.union([dn,fn,hn])}).passthrough(),Ep=Ze.extend({method:u.literal("sampling/createMessage"),params:st.extend({messages:u.array(xp),systemPrompt:u.optional(u.string()),includeContext:u.optional(u.enum(["none","thisServer","allServers"])),temperature:u.optional(u.number()),maxTokens:u.number().int(),stopSequences:u.optional(u.array(u.string())),metadata:u.optional(u.object({}).passthrough()),modelPreferences:u.optional(bp)})}),vn=at.extend({model:u.string(),stopReason:u.optional(u.enum(["endTurn","stopSequence","maxTokens"]).or(u.string())),role:u.enum(["user","assistant"]),content:u.discriminatedUnion("type",[dn,fn,hn])}),Sp=u.object({type:u.literal("boolean"),title:u.optional(u.string()),description:u.optional(u.string()),default:u.optional(u.boolean())}).passthrough(),Pp=u.object({type:u.literal("string"),title:u.optional(u.string()),description:u.optional(u.string()),minLength:u.optional(u.number()),maxLength:u.optional(u.number()),format:u.optional(u.enum(["email","uri","date","date-time"]))}).passthrough(),wp=u.object({type:u.enum(["number","integer"]),title:u.optional(u.string()),description:u.optional(u.string()),minimum:u.optional(u.number()),maximum:u.optional(u.number())}).passthrough(),Tp=u.object({type:u.literal("string"),title:u.optional(u.string()),description:u.optional(u.string()),enum:u.array(u.string()),enumNames:u.optional(u.array(u.string()))}).passthrough(),Cp=u.union([Sp,Pp,wp,Tp]),Rp=Ze.extend({method:u.literal("elicitation/create"),params:st.extend({message:u.string(),requestedSchema:u.object({type:u.literal("object"),properties:u.record(u.string(),Cp),required:u.optional(u.array(u.string()))}).passthrough()})}),gn=at.extend({action:u.enum(["accept","reject","cancel"]),content:u.optional(u.record(u.string(),u.unknown()))}),hl=u.object({type:u.literal("ref/resource"),uri:u.string()}).passthrough(),Oy=hl,kp=u.object({type:u.literal("ref/prompt"),name:u.string()}).passthrough(),ra=Ze.extend({method:u.literal("completion/complete"),params:st.extend({ref:u.union([kp,hl]),argument:u.object({name:u.string(),value:u.string()}).passthrough(),context:u.optional(u.object({arguments:u.optional(u.record(u.string(),u.string()))}))})}),Op=at.extend({completion:u.object({values:u.array(u.string()).max(100),total:u.optional(u.number().int()),hasMore:u.optional(u.boolean())}).passthrough()}),Dp=u.object({uri:u.string().startsWith("file://"),name:u.optional(u.string()),_meta:u.optional(u.object({}).passthrough())}).passthrough(),$p=Ze.extend({method:u.literal("roots/list")}),yn=at.extend({roots:u.array(Dp)}),Ip=xt.extend({method:u.literal("notifications/roots/list_changed")}),Dy=u.union([Ws,Hs,ra,gp,Xs,Ys,Qs,Js,Ks,rp,sp,ta,ea]),$y=u.union([Bs,Gs,Zs,Ip]),Iy=u.union([zs,vn,gn,yn]),Ay=u.union([Ws,Ep,Rp,$p]),Ny=u.union([Bs,Gs,yp,ap,tp,vp,fp]),Ly=u.union([zs,Qh,Op,dp,op,Yh,Xh,ep,dl,mp]),me=class extends Error{constructor(e,r,a){super(`MCP error ${e}: ${r}`),this.code=e,this.data=a,this.name="McpError"}};var Ap=6e4,sa=class{constructor(e){this._options=e,this._requestMessageId=0,this._requestHandlers=new Map,this._requestHandlerAbortControllers=new Map,this._notificationHandlers=new Map,this._responseHandlers=new Map,this._progressHandlers=new Map,this._timeoutInfo=new Map,this.setNotificationHandler(Bs,r=>{let a=this._requestHandlerAbortControllers.get(r.params.requestId);a?.abort(r.params.reason)}),this.setNotificationHandler(Gs,r=>{this._onprogress(r)}),this.setRequestHandler(Ws,r=>({}))}_setupTimeout(e,r,a,t,n=!1){this._timeoutInfo.set(e,{timeoutId:setTimeout(t,r),startTime:Date.now(),timeout:r,maxTotalTimeout:a,resetTimeoutOnProgress:n,onTimeout:t})}_resetTimeout(e){let r=this._timeoutInfo.get(e);if(!r)return!1;let a=Date.now()-r.startTime;if(r.maxTotalTimeout&&a>=r.maxTotalTimeout)throw this._timeoutInfo.delete(e),new me(pe.RequestTimeout,"Maximum total timeout exceeded",{maxTotalTimeout:r.maxTotalTimeout,totalElapsed:a});return clearTimeout(r.timeoutId),r.timeoutId=setTimeout(r.onTimeout,r.timeout),!0}_cleanupTimeout(e){let r=this._timeoutInfo.get(e);r&&(clearTimeout(r.timeoutId),this._timeoutInfo.delete(e))}async connect(e){this._transport=e,this._transport.onclose=()=>{this._onclose()},this._transport.onerror=r=>{this._onerror(r)},this._transport.onmessage=(r,a)=>{mn(r)||gl(r)?this._onresponse(r):ml(r)?this._onrequest(r,a):vl(r)?this._onnotification(r):this._onerror(new Error(`Unknown message type: ${JSON.stringify(r)}`))},await this._transport.start()}_onclose(){var e;let r=this._responseHandlers;this._responseHandlers=new Map,this._progressHandlers.clear(),this._transport=void 0,(e=this.onclose)===null||e===void 0||e.call(this);let a=new me(pe.ConnectionClosed,"Connection closed");for(let t of r.values())t(a)}_onerror(e){var r;(r=this.onerror)===null||r===void 0||r.call(this,e)}_onnotification(e){var r;let a=(r=this._notificationHandlers.get(e.method))!==null&&r!==void 0?r:this.fallbackNotificationHandler;a!==void 0&&Promise.resolve().then(()=>a(e)).catch(t=>this._onerror(new Error(`Uncaught error in notification handler: ${t}`)))}_onrequest(e,r){var a,t,n,o;let i=(a=this._requestHandlers.get(e.method))!==null&&a!==void 0?a:this.fallbackRequestHandler;if(i===void 0){(t=this._transport)===null||t===void 0||t.send({jsonrpc:"2.0",id:e.id,error:{code:pe.MethodNotFound,message:"Method not found"}}).catch(d=>this._onerror(new Error(`Failed to send an error response: ${d}`)));return}let l=new AbortController;this._requestHandlerAbortControllers.set(e.id,l);let c={signal:l.signal,sessionId:(n=this._transport)===null||n===void 0?void 0:n.sessionId,_meta:(o=e.params)===null||o===void 0?void 0:o._meta,sendNotification:d=>this.notification(d,{relatedRequestId:e.id}),sendRequest:(d,h,v)=>this.request(d,h,{...v,relatedRequestId:e.id}),authInfo:r?.authInfo,requestId:e.id};Promise.resolve().then(()=>i(e,c)).then(d=>{var h;if(!l.signal.aborted)return(h=this._transport)===null||h===void 0?void 0:h.send({result:d,jsonrpc:"2.0",id:e.id})},d=>{var h,v;if(!l.signal.aborted)return(h=this._transport)===null||h===void 0?void 0:h.send({jsonrpc:"2.0",id:e.id,error:{code:Number.isSafeInteger(d.code)?d.code:pe.InternalError,message:(v=d.message)!==null&&v!==void 0?v:"Internal error"}})}).catch(d=>this._onerror(new Error(`Failed to send response: ${d}`))).finally(()=>{this._requestHandlerAbortControllers.delete(e.id)})}_onprogress(e){let{progressToken:r,...a}=e.params,t=Number(r),n=this._progressHandlers.get(t);if(!n){this._onerror(new Error(`Received a progress notification for an unknown token: ${JSON.stringify(e)}`));return}let o=this._responseHandlers.get(t),i=this._timeoutInfo.get(t);if(i&&o&&i.resetTimeoutOnProgress)try{this._resetTimeout(t)}catch(l){o(l);return}n(a)}_onresponse(e){let r=Number(e.id),a=this._responseHandlers.get(r);if(a===void 0){this._onerror(new Error(`Received a response for an unknown message ID: ${JSON.stringify(e)}`));return}if(this._responseHandlers.delete(r),this._progressHandlers.delete(r),this._cleanupTimeout(r),mn(e))a(e);else{let t=new me(e.error.code,e.error.message,e.error.data);a(t)}}get transport(){return this._transport}async close(){var e;await((e=this._transport)===null||e===void 0?void 0:e.close())}request(e,r,a){let{relatedRequestId:t,resumptionToken:n,onresumptiontoken:o}=a??{};return new Promise((i,l)=>{var c,d,h,v,f,p;if(!this._transport){l(new Error("Not connected"));return}((c=this._options)===null||c===void 0?void 0:c.enforceStrictCapabilities)===!0&&this.assertCapabilityForMethod(e.method),(d=a?.signal)===null||d===void 0||d.throwIfAborted();let y=this._requestMessageId++,g={...e,jsonrpc:"2.0",id:y};a?.onprogress&&(this._progressHandlers.set(y,a.onprogress),g.params={...e.params,_meta:{...((h=e.params)===null||h===void 0?void 0:h._meta)||{},progressToken:y}});let x=T=>{var C;this._responseHandlers.delete(y),this._progressHandlers.delete(y),this._cleanupTimeout(y),(C=this._transport)===null||C===void 0||C.send({jsonrpc:"2.0",method:"notifications/cancelled",params:{requestId:y,reason:String(T)}},{relatedRequestId:t,resumptionToken:n,onresumptiontoken:o}).catch(R=>this._onerror(new Error(`Failed to send cancellation: ${R}`))),l(T)};this._responseHandlers.set(y,T=>{var C;if(!(!((C=a?.signal)===null||C===void 0)&&C.aborted)){if(T instanceof Error)return l(T);try{let R=r.parse(T.result);i(R)}catch(R){l(R)}}}),(v=a?.signal)===null||v===void 0||v.addEventListener("abort",()=>{var T;x((T=a?.signal)===null||T===void 0?void 0:T.reason)});let S=(f=a?.timeout)!==null&&f!==void 0?f:Ap,w=()=>x(new me(pe.RequestTimeout,"Request timed out",{timeout:S}));this._setupTimeout(y,S,a?.maxTotalTimeout,w,(p=a?.resetTimeoutOnProgress)!==null&&p!==void 0?p:!1),this._transport.send(g,{relatedRequestId:t,resumptionToken:n,onresumptiontoken:o}).catch(T=>{this._cleanupTimeout(y),l(T)})})}async notification(e,r){if(!this._transport)throw new Error("Not connected");this.assertNotificationCapability(e.method);let a={...e,jsonrpc:"2.0"};await this._transport.send(a,r)}setRequestHandler(e,r){let a=e.shape.method.value;this.assertRequestHandlerCapability(a),this._requestHandlers.set(a,(t,n)=>Promise.resolve(r(e.parse(t),n)))}removeRequestHandler(e){this._requestHandlers.delete(e)}assertCanSetRequestHandler(e){if(this._requestHandlers.has(e))throw new Error(`A request handler for ${e} already exists, which would be overridden`)}setNotificationHandler(e,r){this._notificationHandlers.set(e.shape.method.value,a=>Promise.resolve(r(e.parse(a))))}removeNotificationHandler(e){this._notificationHandlers.delete(e)}};function _l(s,e){return Object.entries(e).reduce((r,[a,t])=>(t&&typeof t=="object"?r[a]=r[a]?{...r[a],...t}:t:r[a]=t,r),{...s})}var xu=de(bu(),1),Ea=class extends sa{constructor(e,r){var a;super(r),this._serverInfo=e,this._capabilities=(a=r?.capabilities)!==null&&a!==void 0?a:{},this._instructions=r?.instructions,this.setRequestHandler(Hs,t=>this._oninitialize(t)),this.setNotificationHandler(Zs,()=>{var t;return(t=this.oninitialized)===null||t===void 0?void 0:t.call(this)})}registerCapabilities(e){if(this.transport)throw new Error("Cannot register capabilities after connecting to transport");this._capabilities=_l(this._capabilities,e)}assertCapabilityForMethod(e){var r,a,t;switch(e){case"sampling/createMessage":if(!(!((r=this._clientCapabilities)===null||r===void 0)&&r.sampling))throw new Error(`Client does not support sampling (required for ${e})`);break;case"elicitation/create":if(!(!((a=this._clientCapabilities)===null||a===void 0)&&a.elicitation))throw new Error(`Client does not support elicitation (required for ${e})`);break;case"roots/list":if(!(!((t=this._clientCapabilities)===null||t===void 0)&&t.roots))throw new Error(`Client does not support listing roots (required for ${e})`);break;case"ping":break}}assertNotificationCapability(e){switch(e){case"notifications/message":if(!this._capabilities.logging)throw new Error(`Server does not support logging (required for ${e})`);break;case"notifications/resources/updated":case"notifications/resources/list_changed":if(!this._capabilities.resources)throw new Error(`Server does not support notifying about resources (required for ${e})`);break;case"notifications/tools/list_changed":if(!this._capabilities.tools)throw new Error(`Server does not support notifying of tool list changes (required for ${e})`);break;case"notifications/prompts/list_changed":if(!this._capabilities.prompts)throw new Error(`Server does not support notifying of prompt list changes (required for ${e})`);break;case"notifications/cancelled":break;case"notifications/progress":break}}assertRequestHandlerCapability(e){switch(e){case"sampling/createMessage":if(!this._capabilities.sampling)throw new Error(`Server does not support sampling (required for ${e})`);break;case"logging/setLevel":if(!this._capabilities.logging)throw new Error(`Server does not support logging (required for ${e})`);break;case"prompts/get":case"prompts/list":if(!this._capabilities.prompts)throw new Error(`Server does not support prompts (required for ${e})`);break;case"resources/list":case"resources/templates/list":case"resources/read":if(!this._capabilities.resources)throw new Error(`Server does not support resources (required for ${e})`);break;case"tools/call":case"tools/list":if(!this._capabilities.tools)throw new Error(`Server does not support tools (required for ${e})`);break;case"ping":case"initialize":break}}async _oninitialize(e){let r=e.params.protocolVersion;return this._clientCapabilities=e.params.capabilities,this._clientVersion=e.params.clientInfo,{protocolVersion:pl.includes(r)?r:pn,capabilities:this.getCapabilities(),serverInfo:this._serverInfo,...this._instructions&&{instructions:this._instructions}}}getClientCapabilities(){return this._clientCapabilities}getClientVersion(){return this._clientVersion}getCapabilities(){return this._capabilities}async ping(){return this.request({method:"ping"},zs)}async createMessage(e,r){return this.request({method:"sampling/createMessage",params:e},vn,r)}async elicitInput(e,r){let a=await this.request({method:"elicitation/create",params:e},gn,r);if(a.action==="accept"&&a.content)try{let t=new xu.default,n=t.compile(e.requestedSchema);if(!n(a.content))throw new me(pe.InvalidParams,`Elicitation response content does not match requested schema: ${t.errorsText(n.errors)}`)}catch(t){throw t instanceof me?t:new me(pe.InternalError,`Error validating elicitation response: ${t}`)}return a}async listRoots(e,r){return this.request({method:"roots/list",params:e},yn,r)}async sendLoggingMessage(e){return this.notification({method:"notifications/message",params:e})}async sendResourceUpdated(e){return this.notification({method:"notifications/resources/updated",params:e})}async sendResourceListChanged(){return this.notification({method:"notifications/resources/list_changed"})}async sendToolListChanged(){return this.notification({method:"notifications/tools/list_changed"})}async sendPromptListChanged(){return this.notification({method:"notifications/prompts/list_changed"})}};var Su=Symbol("Let zodToJsonSchema decide on which parser to use"),A_=(s,e)=>{if(e.description)try{return{...s,...JSON.parse(e.description)}}catch{}return s},Eu={name:void 0,$refStrategy:"root",basePath:["#"],effectStrategy:"input",pipeStrategy:"all",dateStrategy:"format:date-time",mapStrategy:"entries",removeAdditionalStrategy:"passthrough",allowedAdditionalProperties:!0,rejectedAdditionalProperties:!1,definitionPath:"definitions",target:"jsonSchema7",strictUnions:!1,definitions:{},errorMessages:!1,markdownDescription:!1,patternStrategy:"escape",applyRegexFlags:!1,emailStrategy:"format:email",base64Strategy:"contentEncoding:base64",nameStrategy:"ref"},Pu=s=>typeof s=="string"?{...Eu,name:s}:{...Eu,...s};var wu=s=>{let e=Pu(s),r=e.name!==void 0?[...e.basePath,e.definitionPath,e.name]:e.basePath;return{...e,currentPath:r,propertyPath:void 0,seen:new Map(Object.entries(e.definitions).map(([a,t])=>[t._def,{def:t._def,path:[...e.basePath,e.definitionPath,a],jsonSchema:void 0}]))}};function zn(s,e,r,a){a?.errorMessages&&r&&(s.errorMessage={...s.errorMessage,[e]:r})}function re(s,e,r,a,t){s[e]=r,zn(s,e,a,t)}function Tu(){return{}}function Cu(s,e){let r={type:"array"};return s.type?._def&&s.type?._def?.typeName!==O.ZodAny&&(r.items=G(s.type._def,{...e,currentPath:[...e.currentPath,"items"]})),s.minLength&&re(r,"minItems",s.minLength.value,s.minLength.message,e),s.maxLength&&re(r,"maxItems",s.maxLength.value,s.maxLength.message,e),s.exactLength&&(re(r,"minItems",s.exactLength.value,s.exactLength.message,e),re(r,"maxItems",s.exactLength.value,s.exactLength.message,e)),r}function Ru(s,e){let r={type:"integer",format:"int64"};if(!s.checks)return r;for(let a of s.checks)switch(a.kind){case"min":e.target==="jsonSchema7"?a.inclusive?re(r,"minimum",a.value,a.message,e):re(r,"exclusiveMinimum",a.value,a.message,e):(a.inclusive||(r.exclusiveMinimum=!0),re(r,"minimum",a.value,a.message,e));break;case"max":e.target==="jsonSchema7"?a.inclusive?re(r,"maximum",a.value,a.message,e):re(r,"exclusiveMaximum",a.value,a.message,e):(a.inclusive||(r.exclusiveMaximum=!0),re(r,"maximum",a.value,a.message,e));break;case"multipleOf":re(r,"multipleOf",a.value,a.message,e);break}return r}function ku(){return{type:"boolean"}}function Sa(s,e){return G(s.type._def,e)}var Ou=(s,e)=>G(s.innerType._def,e);function Bn(s,e,r){let a=r??e.dateStrategy;if(Array.isArray(a))return{anyOf:a.map((t,n)=>Bn(s,e,t))};switch(a){case"string":case"format:date-time":return{type:"string",format:"date-time"};case"format:date":return{type:"string",format:"date"};case"integer":return hv(s,e)}}var hv=(s,e)=>{let r={type:"integer",format:"unix-time"};if(e.target==="openApi3")return r;for(let a of s.checks)switch(a.kind){case"min":re(r,"minimum",a.value,a.message,e);break;case"max":re(r,"maximum",a.value,a.message,e);break}return r};function Du(s,e){return{...G(s.innerType._def,e),default:s.defaultValue()}}function $u(s,e){return e.effectStrategy==="input"?G(s.schema._def,e):{}}function Iu(s){return{type:"string",enum:Array.from(s.values)}}var pv=s=>"type"in s&&s.type==="string"?!1:"allOf"in s;function Au(s,e){let r=[G(s.left._def,{...e,currentPath:[...e.currentPath,"allOf","0"]}),G(s.right._def,{...e,currentPath:[...e.currentPath,"allOf","1"]})].filter(n=>!!n),a=e.target==="jsonSchema2019-09"?{unevaluatedProperties:!1}:void 0,t=[];return r.forEach(n=>{if(pv(n))t.push(...n.allOf),n.unevaluatedProperties===void 0&&(a=void 0);else{let o=n;if("additionalProperties"in n&&n.additionalProperties===!1){let{additionalProperties:i,...l}=n;o=l}else a=void 0;t.push(o)}}),t.length?{allOf:t,...a}:void 0}function Nu(s,e){let r=typeof s.value;return r!=="bigint"&&r!=="number"&&r!=="boolean"&&r!=="string"?{type:Array.isArray(s.value)?"array":"object"}:e.target==="openApi3"?{type:r==="bigint"?"integer":r,enum:[s.value]}:{type:r==="bigint"?"integer":r,const:s.value}}var Hn,dt={cuid:/^[cC][^\s-]{8,}$/,cuid2:/^[0-9a-z]+$/,ulid:/^[0-9A-HJKMNP-TV-Z]{26}$/,email:/^(?!\.)(?!.*\.\.)([a-zA-Z0-9_'+\-\.]*)[a-zA-Z0-9_+-]@([a-zA-Z0-9][a-zA-Z0-9\-]*\.)+[a-zA-Z]{2,}$/,emoji:()=>(Hn===void 0&&(Hn=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),Hn),uuid:/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/,ipv4:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,ipv4Cidr:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,ipv6:/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,ipv6Cidr:/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,base64:/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,base64url:/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,nanoid:/^[a-zA-Z0-9_-]{21}$/,jwt:/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/};function Pa(s,e){let r={type:"string"};if(s.checks)for(let a of s.checks)switch(a.kind){case"min":re(r,"minLength",typeof r.minLength=="number"?Math.max(r.minLength,a.value):a.value,a.message,e);break;case"max":re(r,"maxLength",typeof r.maxLength=="number"?Math.min(r.maxLength,a.value):a.value,a.message,e);break;case"email":switch(e.emailStrategy){case"format:email":ft(r,"email",a.message,e);break;case"format:idn-email":ft(r,"idn-email",a.message,e);break;case"pattern:zod":ze(r,dt.email,a.message,e);break}break;case"url":ft(r,"uri",a.message,e);break;case"uuid":ft(r,"uuid",a.message,e);break;case"regex":ze(r,a.regex,a.message,e);break;case"cuid":ze(r,dt.cuid,a.message,e);break;case"cuid2":ze(r,dt.cuid2,a.message,e);break;case"startsWith":ze(r,RegExp(`^${Zn(a.value,e)}`),a.message,e);break;case"endsWith":ze(r,RegExp(`${Zn(a.value,e)}$`),a.message,e);break;case"datetime":ft(r,"date-time",a.message,e);break;case"date":ft(r,"date",a.message,e);break;case"time":ft(r,"time",a.message,e);break;case"duration":ft(r,"duration",a.message,e);break;case"length":re(r,"minLength",typeof r.minLength=="number"?Math.max(r.minLength,a.value):a.value,a.message,e),re(r,"maxLength",typeof r.maxLength=="number"?Math.min(r.maxLength,a.value):a.value,a.message,e);break;case"includes":{ze(r,RegExp(Zn(a.value,e)),a.message,e);break}case"ip":{a.version!=="v6"&&ft(r,"ipv4",a.message,e),a.version!=="v4"&&ft(r,"ipv6",a.message,e);break}case"base64url":ze(r,dt.base64url,a.message,e);break;case"jwt":ze(r,dt.jwt,a.message,e);break;case"cidr":{a.version!=="v6"&&ze(r,dt.ipv4Cidr,a.message,e),a.version!=="v4"&&ze(r,dt.ipv6Cidr,a.message,e);break}case"emoji":ze(r,dt.emoji(),a.message,e);break;case"ulid":{ze(r,dt.ulid,a.message,e);break}case"base64":{switch(e.base64Strategy){case"format:binary":{ft(r,"binary",a.message,e);break}case"contentEncoding:base64":{re(r,"contentEncoding","base64",a.message,e);break}case"pattern:zod":{ze(r,dt.base64,a.message,e);break}}break}case"nanoid":ze(r,dt.nanoid,a.message,e);case"toLowerCase":case"toUpperCase":case"trim":break;default:}return r}function Zn(s,e){return e.patternStrategy==="escape"?vv(s):s}var mv=new Set("ABCDEFGHIJKLMNOPQRSTUVXYZabcdefghijklmnopqrstuvxyz0123456789");function vv(s){let e="";for(let r=0;r<s.length;r++)mv.has(s[r])||(e+="\\"),e+=s[r];return e}function ft(s,e,r,a){s.format||s.anyOf?.some(t=>t.format)?(s.anyOf||(s.anyOf=[]),s.format&&(s.anyOf.push({format:s.format,...s.errorMessage&&a.errorMessages&&{errorMessage:{format:s.errorMessage.format}}}),delete s.format,s.errorMessage&&(delete s.errorMessage.format,Object.keys(s.errorMessage).length===0&&delete s.errorMessage)),s.anyOf.push({format:e,...r&&a.errorMessages&&{errorMessage:{format:r}}})):re(s,"format",e,r,a)}function ze(s,e,r,a){s.pattern||s.allOf?.some(t=>t.pattern)?(s.allOf||(s.allOf=[]),s.pattern&&(s.allOf.push({pattern:s.pattern,...s.errorMessage&&a.errorMessages&&{errorMessage:{pattern:s.errorMessage.pattern}}}),delete s.pattern,s.errorMessage&&(delete s.errorMessage.pattern,Object.keys(s.errorMessage).length===0&&delete s.errorMessage)),s.allOf.push({pattern:Lu(e,a),...r&&a.errorMessages&&{errorMessage:{pattern:r}}})):re(s,"pattern",Lu(e,a),r,a)}function Lu(s,e){if(!e.applyRegexFlags||!s.flags)return s.source;let r={i:s.flags.includes("i"),m:s.flags.includes("m"),s:s.flags.includes("s")},a=r.i?s.source.toLowerCase():s.source,t="",n=!1,o=!1,i=!1;for(let l=0;l<a.length;l++){if(n){t+=a[l],n=!1;continue}if(r.i){if(o){if(a[l].match(/[a-z]/)){i?(t+=a[l],t+=`${a[l-2]}-${a[l]}`.toUpperCase(),i=!1):a[l+1]==="-"&&a[l+2]?.match(/[a-z]/)?(t+=a[l],i=!0):t+=`${a[l]}${a[l].toUpperCase()}`;continue}}else if(a[l].match(/[a-z]/)){t+=`[${a[l]}${a[l].toUpperCase()}]`;continue}}if(r.m){if(a[l]==="^"){t+=`(^|(?<=[\r
]))`;continue}else if(a[l]==="$"){t+=`($|(?=[\r
]))`;continue}}if(r.s&&a[l]==="."){t+=o?`${a[l]}\r
`:`[${a[l]}\r
]`;continue}t+=a[l],a[l]==="\\"?n=!0:o&&a[l]==="]"?o=!1:!o&&a[l]==="["&&(o=!0)}try{new RegExp(t)}catch{return console.warn(`Could not convert regex pattern at ${e.currentPath.join("/")} to a flag-independent form! Falling back to the flag-ignorant source`),s.source}return t}function wa(s,e){if(e.target==="openAi"&&console.warn("Warning: OpenAI may not support records in schemas! Try an array of key-value pairs instead."),e.target==="openApi3"&&s.keyType?._def.typeName===O.ZodEnum)return{type:"object",required:s.keyType._def.values,properties:s.keyType._def.values.reduce((a,t)=>({...a,[t]:G(s.valueType._def,{...e,currentPath:[...e.currentPath,"properties",t]})??{}}),{}),additionalProperties:e.rejectedAdditionalProperties};let r={type:"object",additionalProperties:G(s.valueType._def,{...e,currentPath:[...e.currentPath,"additionalProperties"]})??e.allowedAdditionalProperties};if(e.target==="openApi3")return r;if(s.keyType?._def.typeName===O.ZodString&&s.keyType._def.checks?.length){let{type:a,...t}=Pa(s.keyType._def,e);return{...r,propertyNames:t}}else{if(s.keyType?._def.typeName===O.ZodEnum)return{...r,propertyNames:{enum:s.keyType._def.values}};if(s.keyType?._def.typeName===O.ZodBranded&&s.keyType._def.type._def.typeName===O.ZodString&&s.keyType._def.type._def.checks?.length){let{type:a,...t}=Sa(s.keyType._def,e);return{...r,propertyNames:t}}}return r}function Fu(s,e){if(e.mapStrategy==="record")return wa(s,e);let r=G(s.keyType._def,{...e,currentPath:[...e.currentPath,"items","items","0"]})||{},a=G(s.valueType._def,{...e,currentPath:[...e.currentPath,"items","items","1"]})||{};return{type:"array",maxItems:125,items:{type:"array",items:[r,a],minItems:2,maxItems:2}}}function ju(s){let e=s.values,a=Object.keys(s.values).filter(n=>typeof e[e[n]]!="number").map(n=>e[n]),t=Array.from(new Set(a.map(n=>typeof n)));return{type:t.length===1?t[0]==="string"?"string":"number":["string","number"],enum:a}}function Mu(){return{not:{}}}function Uu(s){return s.target==="openApi3"?{enum:["null"],nullable:!0}:{type:"null"}}var vs={ZodString:"string",ZodNumber:"number",ZodBigInt:"integer",ZodBoolean:"boolean",ZodNull:"null"};function Vu(s,e){if(e.target==="openApi3")return qu(s,e);let r=s.options instanceof Map?Array.from(s.options.values()):s.options;if(r.every(a=>a._def.typeName in vs&&(!a._def.checks||!a._def.checks.length))){let a=r.reduce((t,n)=>{let o=vs[n._def.typeName];return o&&!t.includes(o)?[...t,o]:t},[]);return{type:a.length>1?a:a[0]}}else if(r.every(a=>a._def.typeName==="ZodLiteral"&&!a.description)){let a=r.reduce((t,n)=>{let o=typeof n._def.value;switch(o){case"string":case"number":case"boolean":return[...t,o];case"bigint":return[...t,"integer"];case"object":if(n._def.value===null)return[...t,"null"];case"symbol":case"undefined":case"function":default:return t}},[]);if(a.length===r.length){let t=a.filter((n,o,i)=>i.indexOf(n)===o);return{type:t.length>1?t:t[0],enum:r.reduce((n,o)=>n.includes(o._def.value)?n:[...n,o._def.value],[])}}}else if(r.every(a=>a._def.typeName==="ZodEnum"))return{type:"string",enum:r.reduce((a,t)=>[...a,...t._def.values.filter(n=>!a.includes(n))],[])};return qu(s,e)}var qu=(s,e)=>{let r=(s.options instanceof Map?Array.from(s.options.values()):s.options).map((a,t)=>G(a._def,{...e,currentPath:[...e.currentPath,"anyOf",`${t}`]})).filter(a=>!!a&&(!e.strictUnions||typeof a=="object"&&Object.keys(a).length>0));return r.length?{anyOf:r}:void 0};function zu(s,e){if(["ZodString","ZodNumber","ZodBigInt","ZodBoolean","ZodNull"].includes(s.innerType._def.typeName)&&(!s.innerType._def.checks||!s.innerType._def.checks.length))return e.target==="openApi3"?{type:vs[s.innerType._def.typeName],nullable:!0}:{type:[vs[s.innerType._def.typeName],"null"]};if(e.target==="openApi3"){let a=G(s.innerType._def,{...e,currentPath:[...e.currentPath]});return a&&"$ref"in a?{allOf:[a],nullable:!0}:a&&{...a,nullable:!0}}let r=G(s.innerType._def,{...e,currentPath:[...e.currentPath,"anyOf","0"]});return r&&{anyOf:[r,{type:"null"}]}}function Bu(s,e){let r={type:"number"};if(!s.checks)return r;for(let a of s.checks)switch(a.kind){case"int":r.type="integer",zn(r,"type",a.message,e);break;case"min":e.target==="jsonSchema7"?a.inclusive?re(r,"minimum",a.value,a.message,e):re(r,"exclusiveMinimum",a.value,a.message,e):(a.inclusive||(r.exclusiveMinimum=!0),re(r,"minimum",a.value,a.message,e));break;case"max":e.target==="jsonSchema7"?a.inclusive?re(r,"maximum",a.value,a.message,e):re(r,"exclusiveMaximum",a.value,a.message,e):(a.inclusive||(r.exclusiveMaximum=!0),re(r,"maximum",a.value,a.message,e));break;case"multipleOf":re(r,"multipleOf",a.value,a.message,e);break}return r}function Hu(s,e){let r=e.target==="openAi",a={type:"object",properties:{}},t=[],n=s.shape();for(let i in n){let l=n[i];if(l===void 0||l._def===void 0)continue;let c=yv(l);c&&r&&(l instanceof Ve&&(l=l._def.innerType),l.isNullable()||(l=l.nullable()),c=!1);let d=G(l._def,{...e,currentPath:[...e.currentPath,"properties",i],propertyPath:[...e.currentPath,"properties",i]});d!==void 0&&(a.properties[i]=d,c||t.push(i))}t.length&&(a.required=t);let o=gv(s,e);return o!==void 0&&(a.additionalProperties=o),a}function gv(s,e){if(s.catchall._def.typeName!=="ZodNever")return G(s.catchall._def,{...e,currentPath:[...e.currentPath,"additionalProperties"]});switch(s.unknownKeys){case"passthrough":return e.allowedAdditionalProperties;case"strict":return e.rejectedAdditionalProperties;case"strip":return e.removeAdditionalStrategy==="strict"?e.allowedAdditionalProperties:e.rejectedAdditionalProperties}}function yv(s){try{return s.isOptional()}catch{return!0}}var Zu=(s,e)=>{if(e.currentPath.toString()===e.propertyPath?.toString())return G(s.innerType._def,e);let r=G(s.innerType._def,{...e,currentPath:[...e.currentPath,"anyOf","1"]});return r?{anyOf:[{not:{}},r]}:{}};var Wu=(s,e)=>{if(e.pipeStrategy==="input")return G(s.in._def,e);if(e.pipeStrategy==="output")return G(s.out._def,e);let r=G(s.in._def,{...e,currentPath:[...e.currentPath,"allOf","0"]}),a=G(s.out._def,{...e,currentPath:[...e.currentPath,"allOf",r?"1":"0"]});return{allOf:[r,a].filter(t=>t!==void 0)}};function Gu(s,e){return G(s.type._def,e)}function Qu(s,e){let a={type:"array",uniqueItems:!0,items:G(s.valueType._def,{...e,currentPath:[...e.currentPath,"items"]})};return s.minSize&&re(a,"minItems",s.minSize.value,s.minSize.message,e),s.maxSize&&re(a,"maxItems",s.maxSize.value,s.maxSize.message,e),a}function Ju(s,e){return s.rest?{type:"array",minItems:s.items.length,items:s.items.map((r,a)=>G(r._def,{...e,currentPath:[...e.currentPath,"items",`${a}`]})).reduce((r,a)=>a===void 0?r:[...r,a],[]),additionalItems:G(s.rest._def,{...e,currentPath:[...e.currentPath,"additionalItems"]})}:{type:"array",minItems:s.items.length,maxItems:s.items.length,items:s.items.map((r,a)=>G(r._def,{...e,currentPath:[...e.currentPath,"items",`${a}`]})).reduce((r,a)=>a===void 0?r:[...r,a],[])}}function Ku(){return{not:{}}}function Yu(){return{}}var Xu=(s,e)=>G(s.innerType._def,e);var ed=(s,e,r)=>{switch(e){case O.ZodString:return Pa(s,r);case O.ZodNumber:return Bu(s,r);case O.ZodObject:return Hu(s,r);case O.ZodBigInt:return Ru(s,r);case O.ZodBoolean:return ku();case O.ZodDate:return Bn(s,r);case O.ZodUndefined:return Ku();case O.ZodNull:return Uu(r);case O.ZodArray:return Cu(s,r);case O.ZodUnion:case O.ZodDiscriminatedUnion:return Vu(s,r);case O.ZodIntersection:return Au(s,r);case O.ZodTuple:return Ju(s,r);case O.ZodRecord:return wa(s,r);case O.ZodLiteral:return Nu(s,r);case O.ZodEnum:return Iu(s);case O.ZodNativeEnum:return ju(s);case O.ZodNullable:return zu(s,r);case O.ZodOptional:return Zu(s,r);case O.ZodMap:return Fu(s,r);case O.ZodSet:return Qu(s,r);case O.ZodLazy:return()=>s.getter()._def;case O.ZodPromise:return Gu(s,r);case O.ZodNaN:case O.ZodNever:return Mu();case O.ZodEffects:return $u(s,r);case O.ZodAny:return Tu();case O.ZodUnknown:return Yu();case O.ZodDefault:return Du(s,r);case O.ZodBranded:return Sa(s,r);case O.ZodReadonly:return Xu(s,r);case O.ZodCatch:return Ou(s,r);case O.ZodPipeline:return Wu(s,r);case O.ZodFunction:case O.ZodVoid:case O.ZodSymbol:return;default:return(a=>{})(e)}};function G(s,e,r=!1){let a=e.seen.get(s);if(e.override){let i=e.override?.(s,e,a,r);if(i!==Su)return i}if(a&&!r){let i=_v(a,e);if(i!==void 0)return i}let t={def:s,path:e.currentPath,jsonSchema:void 0};e.seen.set(s,t);let n=ed(s,s.typeName,e),o=typeof n=="function"?G(n(),e):n;if(o&&xv(s,e,o),e.postProcess){let i=e.postProcess(o,s,e);return t.jsonSchema=o,i}return t.jsonSchema=o,o}var _v=(s,e)=>{switch(e.$refStrategy){case"root":return{$ref:s.path.join("/")};case"relative":return{$ref:bv(e.currentPath,s.path)};case"none":case"seen":return s.path.length<e.currentPath.length&&s.path.every((r,a)=>e.currentPath[a]===r)?(console.warn(`Recursive reference detected at ${e.currentPath.join("/")}! Defaulting to any`),{}):e.$refStrategy==="seen"?{}:void 0}},bv=(s,e)=>{let r=0;for(;r<s.length&&r<e.length&&s[r]===e[r];r++);return[(s.length-r).toString(),...e.slice(r)].join("/")},xv=(s,e,r)=>(s.description&&(r.description=s.description,e.markdownDescription&&(r.markdownDescription=s.description)),r);var Hr=(s,e)=>{let r=wu(e),a=typeof e=="object"&&e.definitions?Object.entries(e.definitions).reduce((l,[c,d])=>({...l,[c]:G(d._def,{...r,currentPath:[...r.basePath,r.definitionPath,c]},!0)??{}}),{}):void 0,t=typeof e=="string"?e:e?.nameStrategy==="title"?void 0:e?.name,n=G(s._def,t===void 0?r:{...r,currentPath:[...r.basePath,r.definitionPath,t]},!1)??{},o=typeof e=="object"&&e.name!==void 0&&e.nameStrategy==="title"?e.name:void 0;o!==void 0&&(n.title=o);let i=t===void 0?a?{...n,[r.definitionPath]:a}:n:{$ref:[...r.$refStrategy==="relative"?[]:r.basePath,r.definitionPath,t].join("/"),[r.definitionPath]:{...a,[t]:n}};return r.target==="jsonSchema7"?i.$schema="http://json-schema.org/draft-07/schema#":(r.target==="jsonSchema2019-09"||r.target==="openAi")&&(i.$schema="https://json-schema.org/draft/2019-09/schema#"),r.target==="openAi"&&("anyOf"in i||"oneOf"in i||"allOf"in i||"type"in i&&Array.isArray(i.type))&&console.warn("Warning: OpenAI may not support schemas with unions as roots! Try wrapping it in an object property."),i};var Ob=Hr;var Wn;(function(s){s.Completable="McpCompletable"})(Wn||(Wn={}));var Rr=class extends Q{_parse(e){let{ctx:r}=this._processInputParams(e),a=r.data;return this._def.type._parse({data:a,path:r.path,parent:r})}unwrap(){return this._def.type}};Rr.create=(s,e)=>new Rr({type:s,typeName:Wn.Completable,complete:e.complete,...Ev(e)});function vx(s,e){return Rr.create(s,{...s._def,complete:e})}function Ev(s){if(!s)return{};let{errorMap:e,invalid_type_error:r,required_error:a,description:t}=s;if(e&&(r||a))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:t}:{errorMap:(o,i)=>{var l,c;let{message:d}=s;return o.code==="invalid_enum_value"?{message:d??i.defaultError}:typeof i.data>"u"?{message:(l=d??a)!==null&&l!==void 0?l:i.defaultError}:o.code!=="invalid_type"?{message:i.defaultError}:{message:(c=d??r)!==null&&c!==void 0?c:i.defaultError}},description:t}}var yx=1e6,_x=1e6,bx=1e4,xx=1e6,Ta=class s{static isTemplate(e){return/\{[^}\s]+\}/.test(e)}static validateLength(e,r,a){if(e.length>r)throw new Error(`${a} exceeds maximum length of ${r} characters (got ${e.length})`)}get variableNames(){return this.parts.flatMap(e=>typeof e=="string"?[]:e.names)}constructor(e){s.validateLength(e,1e6,"Template"),this.template=e,this.parts=this.parse(e)}toString(){return this.template}parse(e){let r=[],a="",t=0,n=0;for(;t<e.length;)if(e[t]==="{"){a&&(r.push(a),a="");let o=e.indexOf("}",t);if(o===-1)throw new Error("Unclosed template expression");if(n++,n>1e4)throw new Error("Template contains too many expressions (max 10000)");let i=e.slice(t+1,o),l=this.getOperator(i),c=i.includes("*"),d=this.getNames(i),h=d[0];for(let v of d)s.validateLength(v,1e6,"Variable name");r.push({name:h,operator:l,names:d,exploded:c}),t=o+1}else a+=e[t],t++;return a&&r.push(a),r}getOperator(e){return["+","#",".","/","?","&"].find(a=>e.startsWith(a))||""}getNames(e){let r=this.getOperator(e);return e.slice(r.length).split(",").map(a=>a.replace("*","").trim()).filter(a=>a.length>0)}encodeValue(e,r){return s.validateLength(e,1e6,"Variable value"),r==="+"||r==="#"?encodeURI(e):encodeURIComponent(e)}expandPart(e,r){if(e.operator==="?"||e.operator==="&"){let o=e.names.map(l=>{let c=r[l];if(c===void 0)return"";let d=Array.isArray(c)?c.map(h=>this.encodeValue(h,e.operator)).join(","):this.encodeValue(c.toString(),e.operator);return`${l}=${d}`}).filter(l=>l.length>0);return o.length===0?"":(e.operator==="?"?"?":"&")+o.join("&")}if(e.names.length>1){let o=e.names.map(i=>r[i]).filter(i=>i!==void 0);return o.length===0?"":o.map(i=>Array.isArray(i)?i[0]:i).join(",")}let a=r[e.name];if(a===void 0)return"";let n=(Array.isArray(a)?a:[a]).map(o=>this.encodeValue(o,e.operator));switch(e.operator){case"":return n.join(",");case"+":return n.join(",");case"#":return"#"+n.join(",");case".":return"."+n.join(".");case"/":return"/"+n.join("/");default:return n.join(",")}}expand(e){let r="",a=!1;for(let t of this.parts){if(typeof t=="string"){r+=t;continue}let n=this.expandPart(t,e);n&&((t.operator==="?"||t.operator==="&")&&a?r+=n.replace("?","&"):r+=n,(t.operator==="?"||t.operator==="&")&&(a=!0))}return r}escapeRegExp(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}partToRegExp(e){let r=[];for(let n of e.names)s.validateLength(n,1e6,"Variable name");if(e.operator==="?"||e.operator==="&"){for(let n=0;n<e.names.length;n++){let o=e.names[n],i=n===0?"\\"+e.operator:"&";r.push({pattern:i+this.escapeRegExp(o)+"=([^&]+)",name:o})}return r}let a,t=e.name;switch(e.operator){case"":a=e.exploded?"([^/]+(?:,[^/]+)*)":"([^/,]+)";break;case"+":case"#":a="(.+)";break;case".":a="\\.([^/,]+)";break;case"/":a="/"+(e.exploded?"([^/]+(?:,[^/]+)*)":"([^/,]+)");break;default:a="([^/]+)"}return r.push({pattern:a,name:t}),r}match(e){s.validateLength(e,1e6,"URI");let r="^",a=[];for(let i of this.parts)if(typeof i=="string")r+=this.escapeRegExp(i);else{let l=this.partToRegExp(i);for(let{pattern:c,name:d}of l)r+=c,a.push({name:d,exploded:i.exploded})}r+="$",s.validateLength(r,1e6,"Generated regex pattern");let t=new RegExp(r),n=e.match(t);if(!n)return null;let o={};for(let i=0;i<a.length;i++){let{name:l,exploded:c}=a[i],d=n[i+1],h=l.replace("*","");c&&d.includes(",")?o[h]=d.split(","):o[h]=d}return o}};var Ra=class{constructor(e,r){this._registeredResources={},this._registeredResourceTemplates={},this._registeredTools={},this._registeredPrompts={},this._toolHandlersInitialized=!1,this._completionHandlerInitialized=!1,this._resourceHandlersInitialized=!1,this._promptHandlersInitialized=!1,this.server=new Ea(e,r)}async connect(e){return await this.server.connect(e)}async close(){await this.server.close()}setToolRequestHandlers(){this._toolHandlersInitialized||(this.server.assertCanSetRequestHandler(ea.shape.method.value),this.server.assertCanSetRequestHandler(ta.shape.method.value),this.server.registerCapabilities({tools:{listChanged:!0}}),this.server.setRequestHandler(ea,()=>({tools:Object.entries(this._registeredTools).filter(([,e])=>e.enabled).map(([e,r])=>{let a={name:e,title:r.title,description:r.description,inputSchema:r.inputSchema?Hr(r.inputSchema,{strictUnions:!0}):Sv,annotations:r.annotations};return r.outputSchema&&(a.outputSchema=Hr(r.outputSchema,{strictUnions:!0})),a})})),this.server.setRequestHandler(ta,async(e,r)=>{let a=this._registeredTools[e.params.name];if(!a)throw new me(pe.InvalidParams,`Tool ${e.params.name} not found`);if(!a.enabled)throw new me(pe.InvalidParams,`Tool ${e.params.name} disabled`);let t;if(a.inputSchema){let n=await a.inputSchema.safeParseAsync(e.params.arguments);if(!n.success)throw new me(pe.InvalidParams,`Invalid arguments for tool ${e.params.name}: ${n.error.message}`);let o=n.data,i=a.callback;try{t=await Promise.resolve(i(o,r))}catch(l){t={content:[{type:"text",text:l instanceof Error?l.message:String(l)}],isError:!0}}}else{let n=a.callback;try{t=await Promise.resolve(n(r))}catch(o){t={content:[{type:"text",text:o instanceof Error?o.message:String(o)}],isError:!0}}}if(a.outputSchema){if(!t.structuredContent)throw new me(pe.InvalidParams,`Tool ${e.params.name} has an output schema but no structured content was provided`);let n=await a.outputSchema.safeParseAsync(t.structuredContent);if(!n.success)throw new me(pe.InvalidParams,`Invalid structured content for tool ${e.params.name}: ${n.error.message}`)}return t}),this._toolHandlersInitialized=!0)}setCompletionRequestHandler(){this._completionHandlerInitialized||(this.server.assertCanSetRequestHandler(ra.shape.method.value),this.server.registerCapabilities({completions:{}}),this.server.setRequestHandler(ra,async e=>{switch(e.params.ref.type){case"ref/prompt":return this.handlePromptCompletion(e,e.params.ref);case"ref/resource":return this.handleResourceCompletion(e,e.params.ref);default:throw new me(pe.InvalidParams,`Invalid completion reference: ${e.params.ref}`)}}),this._completionHandlerInitialized=!0)}async handlePromptCompletion(e,r){let a=this._registeredPrompts[r.name];if(!a)throw new me(pe.InvalidParams,`Prompt ${r.name} not found`);if(!a.enabled)throw new me(pe.InvalidParams,`Prompt ${r.name} disabled`);if(!a.argsSchema)return Ca;let t=a.argsSchema.shape[e.params.argument.name];if(!(t instanceof Rr))return Ca;let o=await t._def.complete(e.params.argument.value,e.params.context);return sd(o)}async handleResourceCompletion(e,r){let a=Object.values(this._registeredResourceTemplates).find(o=>o.resourceTemplate.uriTemplate.toString()===r.uri);if(!a){if(this._registeredResources[r.uri])return Ca;throw new me(pe.InvalidParams,`Resource template ${e.params.ref.uri} not found`)}let t=a.resourceTemplate.completeCallback(e.params.argument.name);if(!t)return Ca;let n=await t(e.params.argument.value,e.params.context);return sd(n)}setResourceRequestHandlers(){this._resourceHandlersInitialized||(this.server.assertCanSetRequestHandler(Qs.shape.method.value),this.server.assertCanSetRequestHandler(Js.shape.method.value),this.server.assertCanSetRequestHandler(Ks.shape.method.value),this.server.registerCapabilities({resources:{listChanged:!0}}),this.server.setRequestHandler(Qs,async(e,r)=>{let a=Object.entries(this._registeredResources).filter(([n,o])=>o.enabled).map(([n,o])=>({uri:n,name:o.name,...o.metadata})),t=[];for(let n of Object.values(this._registeredResourceTemplates)){if(!n.resourceTemplate.listCallback)continue;let o=await n.resourceTemplate.listCallback(r);for(let i of o.resources)t.push({...n.metadata,...i})}return{resources:[...a,...t]}}),this.server.setRequestHandler(Js,async()=>({resourceTemplates:Object.entries(this._registeredResourceTemplates).map(([r,a])=>({name:r,uriTemplate:a.resourceTemplate.uriTemplate.toString(),...a.metadata}))})),this.server.setRequestHandler(Ks,async(e,r)=>{let a=new URL(e.params.uri),t=this._registeredResources[a.toString()];if(t){if(!t.enabled)throw new me(pe.InvalidParams,`Resource ${a} disabled`);return t.readCallback(a,r)}for(let n of Object.values(this._registeredResourceTemplates)){let o=n.resourceTemplate.uriTemplate.match(a.toString());if(o)return n.readCallback(a,o,r)}throw new me(pe.InvalidParams,`Resource ${a} not found`)}),this.setCompletionRequestHandler(),this._resourceHandlersInitialized=!0)}setPromptRequestHandlers(){this._promptHandlersInitialized||(this.server.assertCanSetRequestHandler(Ys.shape.method.value),this.server.assertCanSetRequestHandler(Xs.shape.method.value),this.server.registerCapabilities({prompts:{listChanged:!0}}),this.server.setRequestHandler(Ys,()=>({prompts:Object.entries(this._registeredPrompts).filter(([,e])=>e.enabled).map(([e,r])=>({name:e,title:r.title,description:r.description,arguments:r.argsSchema?wv(r.argsSchema):void 0}))})),this.server.setRequestHandler(Xs,async(e,r)=>{let a=this._registeredPrompts[e.params.name];if(!a)throw new me(pe.InvalidParams,`Prompt ${e.params.name} not found`);if(!a.enabled)throw new me(pe.InvalidParams,`Prompt ${e.params.name} disabled`);if(a.argsSchema){let t=await a.argsSchema.safeParseAsync(e.params.arguments);if(!t.success)throw new me(pe.InvalidParams,`Invalid arguments for prompt ${e.params.name}: ${t.error.message}`);let n=t.data,o=a.callback;return await Promise.resolve(o(n,r))}else{let t=a.callback;return await Promise.resolve(t(r))}}),this.setCompletionRequestHandler(),this._promptHandlersInitialized=!0)}resource(e,r,...a){let t;typeof a[0]=="object"&&(t=a.shift());let n=a[0];if(typeof r=="string"){if(this._registeredResources[r])throw new Error(`Resource ${r} is already registered`);let o=this._createRegisteredResource(e,void 0,r,t,n);return this.setResourceRequestHandlers(),this.sendResourceListChanged(),o}else{if(this._registeredResourceTemplates[e])throw new Error(`Resource template ${e} is already registered`);let o=this._createRegisteredResourceTemplate(e,void 0,r,t,n);return this.setResourceRequestHandlers(),this.sendResourceListChanged(),o}}registerResource(e,r,a,t){if(typeof r=="string"){if(this._registeredResources[r])throw new Error(`Resource ${r} is already registered`);let n=this._createRegisteredResource(e,a.title,r,a,t);return this.setResourceRequestHandlers(),this.sendResourceListChanged(),n}else{if(this._registeredResourceTemplates[e])throw new Error(`Resource template ${e} is already registered`);let n=this._createRegisteredResourceTemplate(e,a.title,r,a,t);return this.setResourceRequestHandlers(),this.sendResourceListChanged(),n}}_createRegisteredResource(e,r,a,t,n){let o={name:e,title:r,metadata:t,readCallback:n,enabled:!0,disable:()=>o.update({enabled:!1}),enable:()=>o.update({enabled:!0}),remove:()=>o.update({uri:null}),update:i=>{typeof i.uri<"u"&&i.uri!==a&&(delete this._registeredResources[a],i.uri&&(this._registeredResources[i.uri]=o)),typeof i.name<"u"&&(o.name=i.name),typeof i.title<"u"&&(o.title=i.title),typeof i.metadata<"u"&&(o.metadata=i.metadata),typeof i.callback<"u"&&(o.readCallback=i.callback),typeof i.enabled<"u"&&(o.enabled=i.enabled),this.sendResourceListChanged()}};return this._registeredResources[a]=o,o}_createRegisteredResourceTemplate(e,r,a,t,n){let o={resourceTemplate:a,title:r,metadata:t,readCallback:n,enabled:!0,disable:()=>o.update({enabled:!1}),enable:()=>o.update({enabled:!0}),remove:()=>o.update({name:null}),update:i=>{typeof i.name<"u"&&i.name!==e&&(delete this._registeredResourceTemplates[e],i.name&&(this._registeredResourceTemplates[i.name]=o)),typeof i.title<"u"&&(o.title=i.title),typeof i.template<"u"&&(o.resourceTemplate=i.template),typeof i.metadata<"u"&&(o.metadata=i.metadata),typeof i.callback<"u"&&(o.readCallback=i.callback),typeof i.enabled<"u"&&(o.enabled=i.enabled),this.sendResourceListChanged()}};return this._registeredResourceTemplates[e]=o,o}_createRegisteredPrompt(e,r,a,t,n){let o={title:r,description:a,argsSchema:t===void 0?void 0:u.object(t),callback:n,enabled:!0,disable:()=>o.update({enabled:!1}),enable:()=>o.update({enabled:!0}),remove:()=>o.update({name:null}),update:i=>{typeof i.name<"u"&&i.name!==e&&(delete this._registeredPrompts[e],i.name&&(this._registeredPrompts[i.name]=o)),typeof i.title<"u"&&(o.title=i.title),typeof i.description<"u"&&(o.description=i.description),typeof i.argsSchema<"u"&&(o.argsSchema=u.object(i.argsSchema)),typeof i.callback<"u"&&(o.callback=i.callback),typeof i.enabled<"u"&&(o.enabled=i.enabled),this.sendPromptListChanged()}};return this._registeredPrompts[e]=o,o}_createRegisteredTool(e,r,a,t,n,o,i){let l={title:r,description:a,inputSchema:t===void 0?void 0:u.object(t),outputSchema:n===void 0?void 0:u.object(n),annotations:o,callback:i,enabled:!0,disable:()=>l.update({enabled:!1}),enable:()=>l.update({enabled:!0}),remove:()=>l.update({name:null}),update:c=>{typeof c.name<"u"&&c.name!==e&&(delete this._registeredTools[e],c.name&&(this._registeredTools[c.name]=l)),typeof c.title<"u"&&(l.title=c.title),typeof c.description<"u"&&(l.description=c.description),typeof c.paramsSchema<"u"&&(l.inputSchema=u.object(c.paramsSchema)),typeof c.callback<"u"&&(l.callback=c.callback),typeof c.annotations<"u"&&(l.annotations=c.annotations),typeof c.enabled<"u"&&(l.enabled=c.enabled),this.sendToolListChanged()}};return this._registeredTools[e]=l,this.setToolRequestHandlers(),this.sendToolListChanged(),l}tool(e,...r){if(this._registeredTools[e])throw new Error(`Tool ${e} is already registered`);let a,t,n,o;if(typeof r[0]=="string"&&(a=r.shift()),r.length>1){let l=r[0];rd(l)?(t=r.shift(),r.length>1&&typeof r[0]=="object"&&r[0]!==null&&!rd(r[0])&&(o=r.shift())):typeof l=="object"&&l!==null&&(o=r.shift())}let i=r[0];return this._createRegisteredTool(e,void 0,a,t,n,o,i)}registerTool(e,r,a){if(this._registeredTools[e])throw new Error(`Tool ${e} is already registered`);let{title:t,description:n,inputSchema:o,outputSchema:i,annotations:l}=r;return this._createRegisteredTool(e,t,n,o,i,l,a)}prompt(e,...r){if(this._registeredPrompts[e])throw new Error(`Prompt ${e} is already registered`);let a;typeof r[0]=="string"&&(a=r.shift());let t;r.length>1&&(t=r.shift());let n=r[0],o=this._createRegisteredPrompt(e,void 0,a,t,n);return this.setPromptRequestHandlers(),this.sendPromptListChanged(),o}registerPrompt(e,r,a){if(this._registeredPrompts[e])throw new Error(`Prompt ${e} is already registered`);let{title:t,description:n,argsSchema:o}=r,i=this._createRegisteredPrompt(e,t,n,o,a);return this.setPromptRequestHandlers(),this.sendPromptListChanged(),i}isConnected(){return this.server.transport!==void 0}sendResourceListChanged(){this.isConnected()&&this.server.sendResourceListChanged()}sendToolListChanged(){this.isConnected()&&this.server.sendToolListChanged()}sendPromptListChanged(){this.isConnected()&&this.server.sendPromptListChanged()}},td=class{constructor(e,r){this._callbacks=r,this._uriTemplate=typeof e=="string"?new Ta(e):e}get uriTemplate(){return this._uriTemplate}get listCallback(){return this._callbacks.list}completeCallback(e){var r;return(r=this._callbacks.complete)===null||r===void 0?void 0:r[e]}},Sv={type:"object"};function rd(s){return typeof s!="object"||s===null?!1:Object.keys(s).length===0||Object.values(s).some(Pv)}function Pv(s){return s!==null&&typeof s=="object"&&"parse"in s&&typeof s.parse=="function"&&"safeParse"in s&&typeof s.safeParse=="function"}function wv(s){return Object.entries(s.shape).map(([e,r])=>({name:e,description:r.description,required:!r.isOptional()}))}function sd(s){return{completion:{values:s.slice(0,100),total:s.length,hasMore:s.length>100}}}var Ca={completion:{values:[],hasMore:!1}};var ir=de(require("vscode"));function Tv(s){return s.map(e=>({message:e.message,severity:ir.DiagnosticSeverity[e.severity],range:{start:{line:e.range.start.line,character:e.range.start.character},end:{line:e.range.end.line,character:e.range.end.character}},source:e.source,code:e.code?.toString()}))}function ad(s){return(s?(()=>{let a=ir.Uri.parse(s);return[[a,ir.languages.getDiagnostics(a)]]})():ir.languages.getDiagnostics()).map(([a,t])=>({uri:a.toString(),diagnostics:Tv(t)}))}var gs=class s{static instance;listener;clients;clientCounter;output;constructor(e){this.clients=new Map,this.clientCounter=0,this.output=e}static getInstance(e){return s.instance||(s.instance=new s(e)),s.instance}registerClient(e){let r=`client_${this.clientCounter++}`;return this.clients.set(r,e),this.startStreaming(),this.output.info(`[DiagnosticStreamManager] Registered client ${r}. Total clients: ${this.clients.size}`),r}unregisterClient(e){this.clients.delete(e)&&(this.output.info(`[DiagnosticStreamManager] Unregistered client ${e}. Total clients: ${this.clients.size}`),this.clients.size===0&&this.stopStreaming())}startStreaming(){this.listener||(this.listener=ir.languages.onDidChangeDiagnostics(e=>{this.notifyDiagnosticsChanged(e.uris)}),this.output.info("[DiagnosticStreamManager] Started streaming diagnostics"))}stopStreaming(){this.listener&&(this.listener.dispose(),this.listener=void 0,this.output.info("[DiagnosticStreamManager] Stopped streaming diagnostics"))}notifyDiagnosticsChanged(e){if(this.clients.size===0)return;let r=e.map(a=>a.toString());this.output.info(`[DiagnosticStreamManager] Notifying ${this.clients.size} clients about diagnostics change for ${e.length} files`),this.clients.forEach((a,t)=>{try{a(r)}catch(n){this.output.error(`[DiagnosticStreamManager] Error notifying client ${t}: ${n}`)}})}dispose(){this.clients.clear(),this.stopStreaming()}},Ox=gs;var Z=de(require("vscode")),or=de(require("path"));async function nd(s={}){try{let e=ad(s.uri);return{content:[{type:"text",text:JSON.stringify(e,null,2)}]}}catch(e){throw console.error("Error getting diagnostics through MCP:",e),e}}async function id({filePath:s,preview:e,startText:r,endText:a,selectToEndOfLine:t,makeFrontmost:n=!0}){try{if(!s)throw new Error("File path is required");let o;if(!or.isAbsolute(s)&&Z.workspace.workspaceFolders&&Z.workspace.workspaceFolders.length>0){let i=Z.workspace.workspaceFolders[0].uri.fsPath,l=or.join(i,s);o=Z.Uri.file(l),console.log(`Converted relative path '${s}' to absolute: '${l}'`)}else o=Z.Uri.file(s);try{await Z.workspace.fs.stat(o);let i=await Z.workspace.openTextDocument(o),l=Z.window.visibleTextEditors.some(h=>h.document.uri.toString()===o.toString()),c;if(n||!l?c=await Z.window.showTextDocument(i,{preview:e,preserveFocus:!n}):c=Z.window.visibleTextEditors.find(h=>h.document.uri.toString()===o.toString()),r&&c){let h=i.getText(),v={success:!0,filePath:o.fsPath,message:`Opened file: ${o.fsPath}`},f=h.indexOf(r);if(f!==-1){let p=i.positionAt(f),y;if(a){let x=h.substring(f+r.length).indexOf(a);if(x!==-1){let S=f+r.length+x+a.length;y=i.positionAt(S),t&&(y=new Z.Position(y.line,Number.MAX_SAFE_INTEGER)),c.selection=new Z.Selection(p,y),c.revealRange(new Z.Range(p,y),Z.TextEditorRevealType.InCenter),v.message=`Opened file and selected text from "${r}" to "${a}"`}else c.selection=new Z.Selection(p,p),c.revealRange(new Z.Range(p,p),Z.TextEditorRevealType.InCenter),v.message=`Opened file and positioned at "${r}" (end text "${a}" not found)`}else y=i.positionAt(f+r.length),c.selection=new Z.Selection(p,y),c.revealRange(new Z.Range(p,y),Z.TextEditorRevealType.InCenter),v.message=`Opened file and selected text "${r}"`}else v.message=`Opened file, but text "${r}" not found`;return{content:[{type:"text",text:v.message}]}}let d={success:!0,filePath:o.fsPath,fileUrl:i.uri.toString(),message:`Opened file: ${o.fsPath}`};return n||(d.languageId=i.languageId,d.lineCount=i.lineCount,d.isDirty=i.isDirty,d.isUntitled=i.isUntitled,d.isClosed=i.isClosed),{content:[{type:"text",text:n?d.message:JSON.stringify(d,null,2)}]}}catch{throw new Error(`File not found: ${o.fsPath}`)}}catch(o){throw console.error("Error opening file through MCP:",o),o}}async function od(){try{let s=Z.window.activeTextEditor,e=[];for(let a of Z.window.tabGroups.all)for(let t of a.tabs)if(t.input instanceof Z.TabInputText){let n=t.input.uri,o=Z.workspace.textDocuments.find(l=>l.uri.toString()===n.toString()),i={uri:n.toString(),isActive:t.isActive,isPinned:t.isPinned,isPreview:t.isPreview,isDirty:t.isDirty,label:t.label,groupIndex:a.viewColumn?a.viewColumn-1:0,viewColumn:a.viewColumn,isGroupActive:a.isActive};o&&(i.fileName=o.fileName,i.languageId=o.languageId,i.lineCount=o.lineCount,i.isUntitled=o.isUntitled,s&&s.document.uri.toString()===n.toString()&&(i.selection={start:{line:s.selection.start.line,character:s.selection.start.character},end:{line:s.selection.end.line,character:s.selection.end.character},isReversed:s.selection.isReversed})),e.push(i)}return{content:[{type:"text",text:JSON.stringify({tabs:e},null,2)}]}}catch(s){throw console.error("Error getting open editors through MCP:",s),s}}async function Ax(s){try{let e=s?.prompt||"",r=s?.codeActionKind||"quickfix",a=await Z.commands.executeCommand(rn,e,r);return{content:[{type:"text",text:typeof a=="string"?a:JSON.stringify(a,null,2)}]}}catch(e){throw console.error("Error running quick fix through MCP:",e),e}}async function ld(){try{let s=Z.window.activeTextEditor;if(!s)return{content:[{type:"text",text:JSON.stringify({success:!1,message:"No active editor found"},null,2)}]};let e=s.selection,r=s.document,a=r.getText(e),t=r.uri.fsPath;return{content:[{type:"text",text:JSON.stringify({success:!0,text:a,filePath:t,fileUrl:r.uri.toString(),selection:{start:{line:e.start.line,character:e.start.character},end:{line:e.end.line,character:e.end.character},isEmpty:e.isEmpty}},null,2)}]}}catch(s){throw console.error("Error getting current selection through MCP:",s),s}}async function cd(){try{let e=(Z.workspace.workspaceFolders||[]).map(r=>({name:r.name,uri:r.uri.toString(),path:r.uri.fsPath,index:r.index}));return{content:[{type:"text",text:JSON.stringify({success:!0,folders:e,rootPath:Z.workspace.rootPath||null,workspaceFile:Z.workspace.workspaceFile?.toString()||null},null,2)}]}}catch(s){throw console.error("Error getting workspace folders through MCP:",s),s}}async function ud({filePath:s}){try{if(!s)throw new Error("File path is required");let e;if(!or.isAbsolute(s)&&Z.workspace.workspaceFolders&&Z.workspace.workspaceFolders.length>0){let a=Z.workspace.workspaceFolders[0].uri.fsPath,t=or.join(a,s);e=Z.Uri.file(t),console.log(`Converted relative path '${s}' to absolute: '${t}'`)}else e=Z.Uri.file(s);let r=Z.workspace.textDocuments.find(a=>a.uri.toString()===e.toString());return r?{content:[{type:"text",text:JSON.stringify({success:!0,filePath:e.fsPath,isDirty:r.isDirty,isUntitled:r.isUntitled},null,2)}]}:{content:[{type:"text",text:JSON.stringify({success:!1,message:`Document not open: ${e.fsPath}`},null,2)}]}}catch(e){throw console.error("Error checking document dirty state through MCP:",e),e}}async function dd({filePath:s}){try{if(!s)throw new Error("File path is required");let e;if(!or.isAbsolute(s)&&Z.workspace.workspaceFolders&&Z.workspace.workspaceFolders.length>0){let t=Z.workspace.workspaceFolders[0].uri.fsPath,n=or.join(t,s);e=Z.Uri.file(n),console.log(`Converted relative path '${s}' to absolute: '${n}'`)}else e=Z.Uri.file(s);let r=Z.workspace.textDocuments.find(t=>t.uri.toString()===e.toString());if(!r)return{content:[{type:"text",text:JSON.stringify({success:!1,message:`Document not open: ${e.fsPath}`},null,2)}]};let a=await r.save();return{content:[{type:"text",text:JSON.stringify({success:!0,filePath:e.fsPath,saved:a,message:a?"Document saved successfully":"Document was not dirty or save failed"},null,2)}]}}catch(e){throw console.error("Error saving document through MCP:",e),e}}var be=de(require("vscode")),Gn;async function Cv(){if(!Gn){let s=be.extensions.getExtension("ms-toolsai.jupyter");if(!s)throw new Error("Jupyter extension not installed");Gn=Promise.resolve(s.activate())}return Gn}function Zr(s,e){return s.error(e),{content:[{type:"text",text:e}]}}async function fd(s,e){let r=be.window.activeNotebookEditor;if(!r)return Zr(s,"No active notebook editor found.");let a;try{a=await Cv()}catch{return Zr(s,"Unable to request Jupyter extension API. It is either not installed or not activated.")}let t=await a.kernels.getKernel(r.notebook.uri);if(!t)return Zr(s,"No kernel found for the active notebook. Please connect to a kernel.");if(t.language!=="python")return Zr(s,`Kernel language is ${t?.language}, not python.`);let n={content:[]};try{s.info(`Executing ${e}`);let o=new TextDecoder,i=await kv(e,r.notebook),l=r.notebook.getCells().find(h=>h.metadata.id===i);if(!l)return Zr(s,"No cell found in the notebook.");let c=r.notebook.getCells().indexOf(l);if(r.revealRange(new be.NotebookRange(c,c+1),be.NotebookEditorRevealType.InCenter),!await Rv(s))return Zr(s,"Code execution cancelled by user. Ask the user how they would like to proceed.");await be.commands.executeCommand("notebook.cell.execute",{ranges:[{start:c,end:c+1}],document:r.notebook.uri});for(let h of l.outputs)for(let v of h.items)if(v.mime===Ov){let f=JSON.parse(o.decode(v.data));s.appendLine(`Error executing code ${f.name}: ${f.message},/n ${f.stack}`),n.content.push({type:"text",text:`Error: ${f.name}: ${f.message},/n ${f.stack}`})}else if(v.mime===Dv){let f=Buffer.from(v.data).toString("base64");n.content.push({type:"image",data:f,mimeType:v.mime})}else n.content.push({type:"text",text:o.decode(v.data)});s.info("Code execution completed")}catch(o){s.error(`Code execution failed with an error '${o}'`)}return n}async function Rv(s){return(await be.window.showQuickPick([{label:"Execute",description:"Run the code in the notebook"},{label:"Cancel",description:"Do not execute the code"}],{title:"Claude Code Execution",placeHolder:"Choose whether to execute the code"}))?.label==="Execute"}async function kv(s,e){let r=new be.NotebookCellData(be.NotebookCellKind.Code,s,"python"),a=Math.random().toString(36).substring(2,15);r.metadata={id:a};let t=e.getCells().length,n=be.NotebookEdit.insertCells(t,[r]),o=new be.WorkspaceEdit;return o.set(e.uri,[n]),await be.workspace.applyEdit(o),a}var Ov=be.NotebookCellOutputItem.error(new Error("")).mime,Dv="image/png";var Oa=de(require("vscode")),Et=de(require("fs")),ka=de(require("path")),pd=de(require("os")),md=de(require("http"));function $v(){return Math.floor(Math.random()*55536)+1e4}function hd(){let s=ka.join(pd.homedir(),".claude","ide");return Et.existsSync(s)||Et.mkdirSync(s,{recursive:!0}),s}function Qn(s,e){let r=hd(),a=ka.join(r,`${s}.lock`),t=Et.existsSync(a),n=Oa.workspace.workspaceFolders?.map(i=>i.uri.fsPath)||[],o={pid:process.ppid,workspaceFolders:n,ideName:Oa.env.appName,transport:"ws",authToken:e};return Et.writeFileSync(a,JSON.stringify(o)),t&&console.log(`Updated lock file with new workspace folders: ${a}`),a}function vd(s){let e=hd(),r=ka.join(e,`${s}.lock`);if(Et.existsSync(r))try{Et.unlinkSync(r)}catch(a){console.error(`Failed to delete lock file ${r}:`,a)}}function Iv(s){return new Promise(e=>{let r=md.createServer();r.once("error",()=>{e(!1)}),r.once("listening",()=>{r.close(),e(!0)}),r.listen(s)})}async function gd(){for(let s=0;s<50;s++){let e=$v();if(await Iv(e))return e}throw new Error("Failed to find an available port after multiple attempts")}var Pe=de(require("vscode")),bd=de(require("fs")),lr;async function xd(s,e,r,a,t,n,o,i,l){s.info("diff from",a,"to",t,"as",o);let c=Pe.Uri.file(a);try{if((await Pe.workspace.openTextDocument(c)).isDirty){let F=bd.readFileSync(a,"utf8");c=e.createFile(a,F).uri}}catch{s.info("leftTempFileProvider.createFile",a),c=e.createFile(a,"").uri}let h=r.createFile(t,n).uri,v=await Pe.workspace.openTextDocument(h),f=D=>D.input instanceof Pe.TabInputTextDiff&&D.input.modified.toString()===h.toString();await Jn(s)>0&&await new Promise(D=>setTimeout(D,200));let y={preview:!1},g=n,x=n,S;Pe.workspace.onDidChangeTextDocument(D=>{D.document.uri.toString()===h.toString()&&(g=x,x=D.document.getText(),D.contentChanges.length>3&&D.reason!==Pe.TextDocumentChangeReason.Undo&&D.reason!==Pe.TextDocumentChangeReason.Redo&&(S={time:Date.now(),contents:g}))});let w=new Promise(D=>{l.push(Pe.workspace.onWillSaveTextDocument(F=>{if(F.document.uri.toString()===h.toString()){let q=F.document.getText();S&&Date.now()-S.time<500&&(q=S.contents),D(q)}}))}),T=!0;lr&&(lr.dispose(),lr=void 0);try{lr=Pe.commands.registerCommand("type",D=>{if(!(T&&Pe.window.activeTextEditor?.document.uri.toString()===h.toString()))return Pe.commands.executeCommand("default:type",D)}),setTimeout(()=>{T=!1,lr&&(lr.dispose(),lr=void 0)},1e3),l.push(lr)}catch(D){s.warn("Could not register type command interceptor:",D)}let C=await Pe.commands.executeCommand("vscode.diff",c,h,o,y);s.info("diff result",C,o,c,h,y),await _d(()=>yd().some(D=>D.isDiff&&D.label===o),1e3),kt();let R=new Promise(D=>{l.push(i(F=>{F.activeTab&&f(F.activeTab)&&D(F)}))}).then(D=>D.accepted?(s.info("diff_accepted",o),{content:[{type:"text",text:"FILE_SAVED"},{type:"text",text:v.getText()}]}):{content:[{type:"text",text:"DIFF_REJECTED"},{type:"text",text:o}]}),L=_d(()=>!yd().some(D=>D.isDiff&&D.label===o)).then(()=>(s.info("tab_closed",o),{content:[{type:"text",text:"DIFF_REJECTED"},{type:"text",text:o}]})),U=w.then(async D=>(s.info("file_saved",o),{content:[{type:"text",text:"FILE_SAVED"},{type:"text",text:D}]})),$=[L,R];return Pe.workspace.getConfiguration("files").get("autoSave")==="off"&&$.push(U),await Promise.race($)}function yd(){return Pe.window.tabGroups.all.flatMap(s=>s.tabs.map(e=>({tab:e,label:e.label,isDiff:e.input instanceof Pe.TabInputTextDiff,viewColumn:s.viewColumn,isActive:e.isActive})))}function _d(s,e){return new Promise((r,a)=>{let t,n=setInterval(()=>{s()&&(clearInterval(n),t&&clearTimeout(t),r())},100);e&&(t=setTimeout(()=>{clearInterval(n),a(new Error(`Timeout waiting after ${e}ms`))},e))})}async function Kn(s,e,r){s.environmentVariableCollection.replace(e,r),console.log(`Set ${e}=${r} in terminal environment (in-memory)`)}async function Yn(s,e){s.environmentVariableCollection.get(e)&&(s.environmentVariableCollection.delete(e),console.log(`Cleared ${e} from terminal environment (in-memory)`))}function Hx(s,e){return s.environmentVariableCollection.get(e)?.value}var Cf=de(gf(),1),Rf=de(ci(),1),kf=de(fi(),1),bi=de(za(),1),Ha=de(Tf(),1),Yr=bi.default;var Za=class{constructor(e){this.ws=e;this.opened=new Promise((r,a)=>{this.ws.readyState===Yr.OPEN?r():(this.ws.on("open",()=>{r()}),this.ws.on("error",t=>{a(t)}))}),this.ws.on("message",this.onMessageHandler),this.ws.on("error",this.onErrorHandler),this.ws.on("close",this.onCloseHandler)}started=!1;opened;onclose;onerror;onmessage;onMessageHandler=e=>{try{let r=JSON.parse(e.toString("utf-8")),a=yl.parse(r);this.onmessage?.(a)}catch(r){this.onErrorHandler(r)}};onErrorHandler=e=>{this.onerror?.(e instanceof Error?e:new Error("Failed to process message"))};onCloseHandler=()=>{this.onclose?.(),this.ws.off("message",this.onMessageHandler),this.ws.off("error",this.onErrorHandler),this.ws.off("close",this.onCloseHandler)};async start(){if(this.started)throw new Error("Start can only be called once per transport.");if(await this.opened,this.ws.readyState!==Yr.OPEN)throw new Error("WebSocket is not open. Cannot start transport.");this.started=!0}async close(){(this.ws.readyState===Yr.OPEN||this.ws.readyState===Yr.CONNECTING)&&this.ws.close(),this.onCloseHandler()}async send(e){if(this.ws.readyState!==Yr.OPEN)throw new Error("WebSocket is not open. Cannot send message.");let r=JSON.stringify(e);try{await new Promise((a,t)=>{this.ws.send(r,n=>{n?t(n):a()})})}catch(a){throw this.onErrorHandler(a),a}}};var xi=de(require("vscode")),jt=null;function Ei(){return jt}function Of(s,e){let r=null,a=xi.window.onDidChangeTextEditorSelection(t=>{let n=t.textEditor,o=n.selection,i=n.document,c={text:i.getText(o),filePath:i.uri.fsPath,fileUrl:i.uri.toString(),selection:{start:{line:o.start.line,character:o.start.character},end:{line:o.end.line,character:o.end.character},isEmpty:o.isEmpty}},d=!jt||jt.text!==c.text||jt.filePath!==c.filePath||jt.selection.start.line!==c.selection.start.line||jt.selection.start.character!==c.selection.start.character||jt.selection.end.line!==c.selection.end.line||jt.selection.end.character!==c.selection.end.character;jt=c;let h=e();d&&h&&s.server&&(r&&clearTimeout(r),r=setTimeout(()=>{let v=e();v&&Si(c,v)},300))});return{dispose:()=>{a.dispose(),r&&clearTimeout(r)}}}function Df(s,e,r){s(()=>{let a=xi.window.activeTextEditor;if(!a)return;let t=a.selection,n={filePath:a.document.uri.fsPath};t.isEmpty||(n.lineStart=t.start.line,n.lineEnd=t.end.line);let o=r();o&&e.server&&$f(n,o)})}var We=de(require("vscode")),Nf=require("crypto"),Lf=de(require("http"));function Yg(){let s=We.env.appName,e;switch(s.toLowerCase()){case"visual studio code":e="Claude Code VSCode MCP";break;case"cursor":e="Claude Code Cursor MCP";break;case"windsurf":e="Claude Code Windsurf MCP";break;default:e=`Claude Code ${s} MCP`}return e}function Xg(s,e,r,a){s.logged.event(t=>{let n=a();n&&e.server?Af(r,t,n):Pi.push(t)})}function Ff(s,e,r,a,t,n,o){let i=new Ra({name:Yg(),version:s.extension.packageJSON.version||"0.0.1"});i.tool("openDiff","Open a git diff for the file",{old_file_path:u.string().describe("Path to the file to show diff for. If not provided, uses active editor."),new_file_path:u.string().describe("Path to the file to show diff for. If not provided, uses active editor."),new_file_contents:u.string().describe("Contents of the new file. If not provided then the current file contents of new_file_path will be used."),tab_name:u.string().describe("Path to the file to show diff for. If not provided, uses active editor.")},async({old_file_path:S,new_file_path:w,new_file_contents:T,tab_name:C})=>{let R=[];try{return await xd(a,e,r,S,w,T,C,t,R)}catch(L){throw a.error(`Error opening diff: ${L}`),L}finally{for(let L of R)L.dispose()}}),i.tool("getDiagnostics","Get language diagnostics from VS Code",{uri:u.string().optional().describe("Optional file URI to get diagnostics for. If not provided, gets diagnostics for all files.")},nd),i.tool("close_tab",{tab_name:u.string()},async({tab_name:S})=>(await ey(S,a),setTimeout(()=>{kt()},500),{content:[{type:"text",text:"TAB_CLOSED"}]})),i.tool("closeAllDiffTabs","Close all diff tabs in the editor",{},async()=>{let S=await Jn(a);return setTimeout(()=>{kt()},500),{content:[{type:"text",text:`CLOSED_${S}_DIFF_TABS`}]}}),i.tool("openFile","Open a file in the editor and optionally select a range of text",{filePath:u.string().describe("Path to the file to open"),preview:u.boolean().describe("Whether to open the file in preview mode").default(!1),startText:u.string().describe("Text pattern to find the start of the selection range. Selects from the beginning of this match."),endText:u.string().describe("Text pattern to find the end of the selection range. Selects up to the end of this match. If not provided, only the startText match will be selected."),selectToEndOfLine:u.boolean().describe("If true, selection will extend to the end of the line containing the endText match.").default(!1),makeFrontmost:u.boolean().describe("Whether to make the file the active editor tab. If false, the file will be opened in the background without changing focus.").default(!0)},{readOnlyHint:!0},id),i.tool("getOpenEditors","Get information about currently open editors",{},od),i.tool("getWorkspaceFolders","Get all workspace folders currently open in the IDE",{},cd),i.tool("getCurrentSelection","Get the current text selection in the active editor",{},ld),i.tool("checkDocumentDirty","Check if a document has unsaved changes (is dirty)",{filePath:u.string().describe("Path to the file to check")},ud),i.tool("saveDocument","Save a document with unsaved changes",{filePath:u.string().describe("Path to the file to save")},dd),i.tool("getLatestSelection","Get the most recent text selection (even if not in the active editor)",{},async()=>({content:[{type:"text",text:JSON.stringify(Ei()||{success:!1,message:"No selection available"},null,2)}]})),i.tool("executeCode",`Execute python code in the Jupyter kernel for the current notebook file.
    
    All code will be executed in the current Jupyter kernel.
    
    Avoid declaring variables or modifying the state of the kernel unless the user
    explicitly asks for it.
    
    Any code executed will persist across calls to this tool, unless the kernel
    has been restarted.`,{code:u.string().describe("The code to be executed on the kernel.")},({code:S})=>fd(a,S));let l=Lf.createServer(),c=new Ha.default({server:l}),d=null,h=null,v=gs.getInstance(a),f=(0,Nf.randomUUID)();c.on("connection",function(S,w){if(w.headers["x-claude-code-ide-authorization"]!==f){a.error("Unauthorized WebSocket connection attempt"),S.close(1008,"Unauthorized");return}if(a.info("New WS connection from:",w.url||"unknown"),d){a.info("Disconnecting previous WebSocket client"),h&&(v.unregisterClient(h),a.info(`Unregistered previous diagnostic client: ${h}`),h=null);try{d.close()}catch(R){a.error("Error closing previous transport:",R)}}let T=new Za(S);d=T;let C=null;i.connect(T).then(()=>{a.info("MCP server connected to transport"),C=v.registerClient(R=>{T.send({jsonrpc:"2.0",method:"diagnostics_changed",params:{uris:R}}).catch(L=>{a.error("Error sending diagnostics notification:",L.message)})}),h=C,a.info(`Registered diagnostic client: ${C}`),setTimeout(()=>{let R=Ei();R&&Si(R,T);let L=[...Pi];Pi.length=0;for(let U of L)Af(a,U,T)},500)}).catch(R=>{console.error("Error connecting transport:",R),d=null;try{S.close()}catch(L){a.error("Error closing WebSocket:",L)}}),S.on("close",()=>{a.info("WS client disconnected"),d===T&&(d=null,C&&h===C&&(v.unregisterClient(C),a.info(`Unregistered diagnostic client: ${C}`),h=null))})});let p=()=>d;Xg(o,i,a,p),Df(n,i,p);let y=Of(i,p),g=null;l.on("listening",()=>{let S=l.address();S&&typeof S!="string"&&(g=S.port)});let x=We.workspace.onDidChangeWorkspaceFolders(()=>{g!==null&&(Qn(g,f),a.info(`Updated lock file for port ${g} with new workspace folders`))});return{httpServer:l,authToken:f,dispose:async()=>{g!==null&&(vd(g),a.info(`Deleted lock file for port ${g}`),await Yn(s,"CLAUDE_CODE_SSE_PORT"),await Yn(s,"ENABLE_IDE_INTEGRATION")),y.dispose(),x.dispose(),v.dispose(),l.close(),typeof i.close=="function"&&await i.close()}}}async function jf(s,e,r,a){try{let t=await gd(),n=null;return new Promise((o,i)=>{s.listen(t,"127.0.0.1",async()=>{a.info(`MCP Server running on port ${t} (localhost only)`),n=Qn(t,e),console.log(`Created lock file at ${n}`);try{await Kn(r,"CLAUDE_CODE_SSE_PORT",String(t)),await Kn(r,"ENABLE_IDE_INTEGRATION","true"),o(t)}catch(l){console.error("Failed to set environment variables:",l),i(l)}}).on("error",l=>{console.error("Failed to start MCP server:",l),We.window.showErrorMessage(`Failed to start MCP server: ${l}`),i(l)})})}catch(t){throw console.error("Failed to start MCP server:",t),We.window.showErrorMessage(`Failed to start MCP server: ${t}`),t}}async function If(s,e){let r=s.input;if(r instanceof We.TabInputTextDiff)try{await(await We.workspace.openTextDocument(r.modified)).save()}catch(a){e.error("Error saving modified file:",a)}await We.window.tabGroups.close(s)}async function ey(s,e){for(let r of We.window.tabGroups.all)for(let a of r.tabs)if(a.label===s)return await If(a,e),!0;return!1}async function Jn(s){let e=0;s.info("Closing all diff tabs in the editor...");for(let r of We.window.tabGroups.all)for(let a of r.tabs)a.input instanceof We.TabInputTextDiff&&a.label.includes("[Claude Code]")&&(await If(a,s),e++);return s.info(`Closed ${e} diff tabs.`),e}function Af(s,e,r){s.info("Logging event:",e.eventName,e.eventData);let a={eventName:e.eventName,eventData:e.eventData??{}};r.send({jsonrpc:"2.0",method:"log_event",params:a}).catch(t=>{s.error("Error sending log event:",t)})}var Pi=[];async function Si(s,e){try{e.send({jsonrpc:"2.0",method:"selection_changed",params:s}).catch(r=>{console.error("Error sending selection change notification:",r)})}catch(r){console.error("Error sending selection change notification:",r)}}async function $f(s,e){try{e.send({jsonrpc:"2.0",method:"at_mentioned",params:s}).catch(r=>{console.error("Error sending at-mentioned notification:",r)})}catch(r){console.error("Error sending at-mentioned notification:",r)}}var De=de(require("vscode")),wi=class{constructor(e,r){this.uri=e;this.contents=r;this.ctime=this.modifiedTime=Date.now()}type=De.FileType.File;ctime;modifiedTime;get mtime(){return this.modifiedTime}get size(){return this.data.length}get data(){return this.contents}write(e){this.modifiedTime=Date.now(),this.contents=e,this.emitter.fire()}emitter=new De.EventEmitter;onDidSave=this.emitter.event},Cs=class{constructor(e){this.scheme=e}documents=new Map;createFile(e,r){let a=De.Uri.from({scheme:this.scheme,path:e}),t=this.documents.get(a.path);return t?(this.writeFile(a,new TextEncoder().encode(r)),t):(t=new wi(a,new TextEncoder().encode(r)),this.documents.set(e,t),t)}emitter=new De.EventEmitter;onDidChangeFile=this.emitter.event;watch(e){return new De.Disposable(()=>{})}stat(e){return this.find(e)}find(e){let r=this.documents.get(e.path);if(!r)throw De.FileSystemError.FileNotFound(e);return r}readDirectory(e){throw De.FileSystemError.FileNotFound(e)}readFile(e){let r=this.find(e).data;if(r)return r;throw De.FileSystemError.FileNotFound(e)}writeFile(e,r){this.find(e).write(r),this.emitter.fire([{type:De.FileChangeType.Changed,uri:e}])}createDirectory(e){throw De.FileSystemError.Unavailable()}delete(e){throw De.FileSystemError.Unavailable()}rename(e,r,a){throw De.FileSystemError.Unavailable()}};var Mf=de(require("vscode")),Wa=class{logged=new Mf.EventEmitter;logEvent(e,r){this.logged.fire({eventName:e,eventData:r})}};var pt=de(require("vscode"));function ty(s){let e=pt.window.createOutputChannel("Claude Code",{log:!0});s.subscriptions.push(e);let r=new Wa;e.info("Claude code extension is now active!");let a=new Cs("_claude_fs_left");s.subscriptions.push(pt.workspace.registerFileSystemProvider(a.scheme,a));let t=new Cs("_claude_fs_right");s.subscriptions.push(pt.workspace.registerFileSystemProvider(t.scheme,t)),s.subscriptions.push(sy(t.scheme));let n=ro(s.subscriptions);qi().then(i=>{pt.commands.executeCommand("setContext","claude-code.hasClaudeInPath",i)});let o=so(s.subscriptions);eo(e,s,r),to(e,s,r);try{let{httpServer:i,authToken:l,dispose:c}=Ff(s,a,t,e,n,o,r);jf(i,l,s,e).catch(d=>{e.error("Failed to start MCP server:",d),pt.window.showErrorMessage(`Failed to start MCP server: ${d}`)}),s.subscriptions.push({dispose:async()=>{await c()}})}catch(i){e.error("Error during extension activation:",i),pt.window.showErrorMessage(`Failed to activate Claude Code extension: ${i}`)}}function ry(){console.log("Claude code extension is now deactivated")}function sy(s){return pt.window.onDidChangeVisibleTextEditors(e=>{let r=e.some(a=>a?.document.uri.scheme===s);pt.commands.executeCommand("setContext","claude-code.viewingProposedDiff",r)})}0&&(module.exports={activate,deactivate});
/*! Bundled license information:

uri-js/dist/es5/uri.all.js:
  (** @license URI.js v4.4.1 (c) 2011 Gary Court. License: http://github.com/garycourt/uri-js *)
*/
